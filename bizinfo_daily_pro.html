<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸°ì—…ë§ˆë‹¹ ì¼ì¼ ì‹ ê·œê³µê³  | ì½”ë¦¬ì•„ê²½ì˜ìë¬¸</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&family=Noto+Sans+KR:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: #f8f9fc;
            min-height: 100vh;
            padding: 20px;
            color: #1a1a2e;
        }

        .top-gradient {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #1e3a5f 0%, #2874a6 100%);
            z-index: 1000;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 4px 24px rgba(30, 58, 95, 0.08);
            overflow: hidden;
            margin-top: 20px;
        }

        .header {
            background: linear-gradient(135deg, #1e3a5f 0%, #152a45 100%);
            padding: 50px 40px;
            color: white;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 300px;
            height: 100%;
            background: linear-gradient(135deg, transparent 0%, rgba(40, 116, 166, 0.1) 100%);
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .header h1 {
            font-family: 'Montserrat', 'Noto Sans KR', sans-serif;
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 12px;
            letter-spacing: -0.5px;
        }

        .header .subtitle {
            font-size: 16px;
            opacity: 0.9;
            font-weight: 400;
            margin-bottom: 20px;
        }

        .header-info {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
        }

        .control-panel {
            padding: 40px;
            background: white;
            border-bottom: 1px solid #e5e7eb;
        }

        .control-grid {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 30px;
            align-items: center;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #2874a6 0%, #1e3a5f 100%);
            color: white;
            border: none;
            padding: 18px 48px;
            font-size: 16px;
            font-weight: 700;
            border-radius: 16px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(40, 116, 166, 0.25);
            transition: all 0.3s;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 116, 166, 0.35);
        }

        .refresh-btn:active {
            transform: translateY(0);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: #f8f9fc;
            padding: 20px;
            border-radius: 16px;
            border: 1px solid #e5e7eb;
            transition: all 0.3s;
        }

        .stat-card:hover {
            border-color: #2874a6;
            box-shadow: 0 2px 8px rgba(40, 116, 166, 0.1);
            transform: translateY(-2px);
        }
        
        .stat-card.active {
            background: linear-gradient(135deg, #1e3a5f 0%, #2874a6 100%);
            border-color: #2874a6;
            box-shadow: 0 4px 16px rgba(40, 116, 166, 0.3);
        }
        
        .stat-card.active .stat-label,
        .stat-card.active .stat-value {
            color: white !important;
        }

        .stat-label {
            font-size: 13px;
            color: #64748b;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 800;
            color: #1e3a5f;
            font-family: 'Montserrat', 'Noto Sans KR', sans-serif;
        }

        .stat-value.accent {
            color: #2874a6;
        }

        .stat-value.alert {
            color: #dc2626;
        }

        .content {
            padding: 40px;
        }

        .category-section {
            margin-bottom: 30px;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            border: 2px solid #e5e7eb;
            transition: all 0.3s;
        }

        .category-section:hover {
            border-color: #2874a6;
            box-shadow: 0 2px 12px rgba(40, 116, 166, 0.08);
        }

        .category-header {
            background: linear-gradient(135deg, #1e3a5f 0%, #152a45 100%);
            color: white;
            padding: 20px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-header:hover {
            background: linear-gradient(135deg, #2874a6 0%, #1e3a5f 100%);
        }

        .category-title {
            font-size: 18px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .category-icon {
            font-size: 24px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 12px;
        }

        .category-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }

        .category-badge.new {
            background: #dc2626;
        }

        .toggle-icon {
            font-size: 20px;
            transition: transform 0.3s;
        }

        .category-header.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }

        .notice-list {
            padding: 24px;
            display: none;
            background: #fafbfc;
        }

        .notice-list.active {
            display: block;
        }

        .notice-item {
            background: white;
            padding: 24px;
            margin-bottom: 16px;
            border-radius: 16px;
            border-left: 4px solid #2874a6;
            transition: all 0.3s;
            cursor: pointer;
            border: 1px solid #e5e7eb;
        }

        .notice-item:hover {
            border-color: #2874a6;
            transform: translateX(4px);
            box-shadow: 0 4px 16px rgba(40, 116, 166, 0.12);
        }

        .notice-item.new {
            border-left-color: #dc2626;
            background: linear-gradient(135deg, #fff5f5 0%, white 100%);
        }

        .notice-item.new::before {
            content: 'NEW';
            background: #dc2626;
            color: white;
            padding: 4px 10px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 700;
            margin-right: 12px;
            letter-spacing: 0.5px;
        }

        .notice-title {
            font-size: 17px;
            font-weight: 700;
            color: #1a1a2e;
            margin-bottom: 14px;
            line-height: 1.5;
        }

        .notice-meta {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            font-size: 14px;
            color: #64748b;
            margin-bottom: 14px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 500;
        }

        .notice-tags {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 14px;
        }

        .tag {
            background: #f1f5f9;
            color: #1e3a5f;
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 600;
            border: 1px solid #e5e7eb;
        }
        
        .tag.budget {
            background: #fef3c7;
            color: #d97706;
            border-color: #fde68a;
            font-weight: 700;
        }
        
        .tag.target {
            background: #d1fae5;
            color: #059669;
            border-color: #a7f3d0;
            font-weight: 700;
        }

        .deadline-badge {
            background: #fff7ed;
            color: #ea580c;
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 700;
            border: 1px solid #fed7aa;
        }

        .deadline-badge.urgent {
            background: #fef2f2;
            color: #dc2626;
            border-color: #fecaca;
        }

        .empty-state {
            text-align: center;
            padding: 80px 20px;
            color: #64748b;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .empty-state p {
            font-size: 16px;
            line-height: 1.6;
        }

        .loading {
            text-align: center;
            padding: 60px;
            color: #64748b;
        }

        .spinner {
            border: 4px solid #f1f5f9;
            border-top: 4px solid #2874a6;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 24px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .footer {
            background: #f8f9fc;
            padding: 30px 40px;
            border-top: 1px solid #e5e7eb;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .footer-brand {
            font-size: 15px;
            font-weight: 700;
            color: #1e3a5f;
        }

        .footer-contact {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #64748b;
            font-size: 14px;
            font-weight: 600;
        }

        .footer-copyright {
            width: 100%;
            text-align: center;
            padding-top: 20px;
            margin-top: 20px;
            border-top: 1px solid #e5e7eb;
            color: #64748b;
            font-size: 13px;
        }

        @media (max-width: 768px) {
            .container {
                margin-top: 10px;
            }

            .header {
                padding: 30px 24px;
            }

            .header h1 {
                font-size: 24px;
            }

            .control-panel {
                padding: 24px;
            }

            .control-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .refresh-btn {
                width: 100%;
            }

            .content {
                padding: 24px;
            }

            .notice-meta {
                flex-direction: column;
                gap: 10px;
            }

            .footer {
                padding: 24px;
            }

            .footer-content {
                flex-direction: column;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="top-gradient"></div>
    
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>ê¸°ì—…ë§ˆë‹¹ ì¼ì¼ ì‹ ê·œê³µê³ </h1>
                <div class="subtitle">ë§¤ì¼ ì•„ì¹¨ 8ì‹œ ê¸°ì¤€ ìµœì‹  ì§€ì›ì‚¬ì—… ê³µê³ ë¥¼ ë¶„ì•¼ë³„ë¡œ í™•ì¸í•˜ì„¸ìš”</div>
                <div class="header-info">
                    <div class="info-item">
                        <span>ğŸ“…</span>
                        <span id="updateTime">ìµœì¢… ì—…ë°ì´íŠ¸: -</span>
                    </div>
                    <div class="info-item">
                        <span>â˜</span>
                        <span>02-6357-2025</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="control-panel">
            <div class="control-grid">
                <button class="refresh-btn" onclick="loadNewNotices()">
                    ğŸ“‹ ìµœì‹  ê³µê³  í™•ì¸
                </button>
                <div class="stats-grid">
                    <div class="stat-card" onclick="filterNotices('today')" style="cursor: pointer;">
                        <div class="stat-label">ì˜¤ëŠ˜ì˜ ì‹ ê·œê³µê³ </div>
                        <div class="stat-value accent" id="todayCount">0</div>
                    </div>
                    <div class="stat-card" onclick="filterNotices('all')" style="cursor: pointer;">
                        <div class="stat-label">ì§„í–‰ì¤‘ ì „ì²´</div>
                        <div class="stat-value" id="totalCount">0</div>
                    </div>
                    <div class="stat-card" onclick="filterNotices('urgent')" style="cursor: pointer;">
                        <div class="stat-label">ë§ˆê°ì„ë°•</div>
                        <div class="stat-value alert" id="urgentCount">0</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="content" id="content">
            <div class="empty-state">
                <div class="empty-state-icon">ğŸ“¢</div>
                <p>'ìµœì‹  ê³µê³  í™•ì¸' ë²„íŠ¼ì„ ëˆŒëŸ¬<br>ì˜¤ëŠ˜ì˜ ì‹ ê·œ ê³µê³ ë¥¼ í™•ì¸í•˜ì„¸ìš”</p>
            </div>
        </div>

        <div class="footer">
            <div class="footer-content">
                <div class="footer-brand">ì½”ë¦¬ì•„ê²½ì˜ìë¬¸</div>
                <div class="footer-contact">
                    <span>â˜</span>
                    <span>02-6357-2025</span>
                </div>
            </div>
            <div class="footer-copyright">
                Â© ì½”ë¦¬ì•„ê²½ì˜ìë¬¸ Â· ë°ì´í„° ì¶œì²˜: ê¸°ì—…ë§ˆë‹¹(K-Startup) www.bizinfo.go.kr
            </div>
        </div>
    </div>

    <script>
        // ì¹´í…Œê³ ë¦¬ë³„ í‚¤ì›Œë“œ ë§¤ì¹­
        const categoryKeywords = {
            'R&D': ['R&D', 'ì—°êµ¬ê°œë°œ', 'ê¸°ìˆ ê°œë°œ', 'ê°œë°œê³¼ì œ', 'í˜ì‹ ê°œë°œ', 'ì‹ ì œí’ˆ', 'ê¸°ìˆ ì‚¬ì—…í™”'],
            'ìê¸ˆì§€ì›': ['ìê¸ˆ', 'ìœµì', 'ëŒ€ì¶œ', 'íˆ¬ì', 'ì •ì±…ìê¸ˆ', 'ë³´ì¦', 'ë°”ìš°ì²˜', 'ì§€ì›ê¸ˆ'],
            'ìˆ˜ì¶œ/í•´ì™¸ì§„ì¶œ': ['ìˆ˜ì¶œ', 'í•´ì™¸', 'ê¸€ë¡œë²Œ', 'ìˆ˜ì¶œë°”ìš°ì²˜', 'í•´ì™¸ì§„ì¶œ', 'ì™¸êµ­', 'êµ­ì œ'],
            'ì¸ë ¥ì–‘ì„±': ['ì¸ë ¥', 'êµìœ¡', 'í›ˆë ¨', 'ì±„ìš©', 'ì¸ì¬', 'ì§ë¬´', 'ì—­ëŸ‰'],
            'ìŠ¤ë§ˆíŠ¸ê³µì¥': ['ìŠ¤ë§ˆíŠ¸ê³µì¥', 'ìŠ¤ë§ˆíŠ¸ì œì¡°', 'ë””ì§€í„¸', 'ìë™í™”', 'MES', 'IoT'],
            'íŒë¡œ/ë§ˆì¼€íŒ…': ['íŒë¡œ', 'ë§ˆì¼€íŒ…', 'í™ë³´', 'ì˜¨ë¼ì¸', 'ì‡¼í•‘ëª°', 'ìœ í†µ'],
            'ì°½ì—…ì§€ì›': ['ì°½ì—…', 'ì˜ˆë¹„ì°½ì—…', 'ì´ˆê¸°ì°½ì—…', 'ìŠ¤íƒ€íŠ¸ì—…', 'ì•¡ì…€ëŸ¬ë ˆì´íŒ…'],
            'ê²½ì˜í˜ì‹ ': ['ê²½ì˜', 'ì»¨ì„¤íŒ…', 'í˜ì‹ ', 'ì§„ë‹¨', 'ê°œì„ ', 'í’ˆì§ˆ'],
            'ESG/ì¹œí™˜ê²½': ['ESG', 'ì¹œí™˜ê²½', 'íƒ„ì†Œì¤‘ë¦½', 'ë…¹ìƒ‰', 'í™˜ê²½', 'ì—ë„ˆì§€ì ˆê°'],
            'ê¸°íƒ€': []
        };
        
        let allNotices = []; // ì „ì²´ ê³µê³  ì €ì¥
        let currentFilter = 'all'; // í˜„ì¬ í•„í„° ìƒíƒœ
        
        // í•„í„° í•¨ìˆ˜
        function filterNotices(type) {
            currentFilter = type;
            
            // í™œì„±í™” ìƒíƒœ í‘œì‹œ
            document.querySelectorAll('.stat-card').forEach(card => {
                card.classList.remove('active');
            });
            
            let filteredNotices = [];
            
            if (type === 'today') {
                // ì˜¤ëŠ˜ì˜ ì‹ ê·œê³µê³ 
                filteredNotices = allNotices.filter(notice => isNewNotice(notice.registDate));
                document.querySelectorAll('.stat-card')[0].classList.add('active');
            } else if (type === 'urgent') {
                // ë§ˆê°ì„ë°• (D-7 ì´ë‚´)
                filteredNotices = allNotices.filter(notice => {
                    const daysLeft = getDaysUntilDeadline(notice.deadline);
                    return daysLeft <= 7 && daysLeft > 0;
                });
                document.querySelectorAll('.stat-card')[2].classList.add('active');
            } else {
                // ì „ì²´
                filteredNotices = allNotices;
                document.querySelectorAll('.stat-card')[1].classList.add('active');
            }
            
            renderNotices(filteredNotices, type !== 'all');
        }

        async function fetchBizinfoData() {
            try {
                // ê¸°ì—…ë§ˆë‹¹ API í˜¸ì¶œ (JSON ë°©ì‹)
                const API_KEY = 's1wgwK'; // ë°œê¸‰ë°›ì€ ì¸ì¦í‚¤
                const API_URL = `https://www.bizinfo.go.kr/uss/rss/bizinfoApi.do?crtfcKey=${API_KEY}&dataType=json&searchCnt=100`;
                
                const response = await fetch(API_URL);
                
                if (!response.ok) {
                    throw new Error('API í˜¸ì¶œ ì‹¤íŒ¨');
                }
                
                const data = await response.json();
                const items = data.jsonArray || [];
                
                const notices = [];
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                items.forEach((item, index) => {
                    // ë“±ë¡ì¼ íŒŒì‹±
                    const registDate = item.creatPnttm || item.pubDate || '';
                    const itemRegDate = new Date(registDate);
                    itemRegDate.setHours(0, 0, 0, 0);
                    
                    // ë§ˆê°ì¼ íŒŒì‹±
                    const reqstPeriod = item.reqstBeginEndDe || '';
                    const endDateMatch = reqstPeriod.match(/~\s*(\d{8})/);
                    const endDate = endDateMatch ? endDateMatch[1] : '';
                    
                    // ì§„í–‰ì¤‘ì¸ ê³µê³ ë§Œ (ë§ˆê°ì¼ì´ ì§€ë‚˜ì§€ ì•Šì€ ê²ƒ)
                    if (endDate) {
                        const deadline = new Date(
                            endDate.substring(0, 4),
                            parseInt(endDate.substring(4, 6)) - 1,
                            endDate.substring(6, 8)
                        );
                        if (deadline < today) return;
                    }
                    
                    notices.push({
                        id: index + 1,
                        title: item.pblancNm || '',
                        agency: item.jrsdInsttNm || '',
                        category: categorizeByField(item.pldirSportRealmLclasCodeNm || ''),
                        registDate: registDate.split(' ')[0],
                        deadline: endDate ? `${endDate.substring(0, 4)}-${endDate.substring(4, 6)}-${endDate.substring(6, 8)}` : 'ìƒì‹œ',
                        budget: extractBudgetFromContent(item.bsnsSumryCn || item.pblancNm || ''),
                        target: item.trgetNm || 'ì¤‘ì†Œê¸°ì—…', // ì§€ì›ëŒ€ìƒ
                        tags: extractTagsFromHashtags(item.hashtags || ''),
                        url: item.pblancUrl ? `https://www.bizinfo.go.kr${item.pblancUrl}` : 'https://www.bizinfo.go.kr/web/lay1/bbs/S1T122C128/AS/74/list.do',
                        isNew: itemRegDate.getTime() === today.getTime()
                    });
                });
                
                return notices.length > 0 ? notices : getSampleData();
                
            } catch (error) {
                console.error('API í˜¸ì¶œ ì‹¤íŒ¨:', error);
                console.log('CORS ì˜¤ë¥˜ ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ ë¬¸ì œì…ë‹ˆë‹¤. ìƒ˜í”Œ ë°ì´í„°ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.');
                return getSampleData();
            }
        }
        
        // ë¶„ì•¼ëª…ìœ¼ë¡œ ì¹´í…Œê³ ë¦¬ ë§¤ì¹­
        function categorizeByField(fieldName) {
            const fieldMap = {
                'ê¸ˆìœµ': 'ìê¸ˆì§€ì›',
                'ê¸°ìˆ ': 'R&D',
                'ìˆ˜ì¶œ': 'ìˆ˜ì¶œ/í•´ì™¸ì§„ì¶œ',
                'ì¸ë ¥': 'ì¸ë ¥ì–‘ì„±',
                'ë‚´ìˆ˜': 'íŒë¡œ/ë§ˆì¼€íŒ…',
                'ì°½ì—…': 'ì°½ì—…ì§€ì›',
                'ê²½ì˜': 'ê²½ì˜í˜ì‹ '
            };
            
            return fieldMap[fieldName] || categorizeByTitle(fieldName);
        }
        
        // ë‚´ìš©ì—ì„œ ì˜ˆì‚° ì¶”ì¶œ
        function extractBudgetFromContent(content) {
            // HTML íƒœê·¸ ì œê±°
            const text = content.replace(/<[^>]*>/g, '');
            
            if (text.includes('ì–µ')) {
                const match = text.match(/(\d+)ì–µ/);
                if (match) return `ìµœëŒ€ ${match[1]}ì–µì›`;
            }
            if (text.includes('ë°±ë§Œ') || text.includes('ë§Œì›')) {
                const match = text.match(/(\d+(?:,\d+)?)ë°±ë§Œ|(\d+(?:,\d+)?)ë§Œì›/);
                if (match) return `ìµœëŒ€ ${match[1] || match[2]}ë§Œì›`;
            }
            return 'ë¯¸ì •';
        }
        
        // í•´ì‹œíƒœê·¸ì—ì„œ íƒœê·¸ ì¶”ì¶œ
        function extractTagsFromHashtags(hashtags) {
            if (!hashtags) return [];
            
            const tags = hashtags.split(',').map(tag => tag.trim());
            const filteredTags = tags.filter(tag => {
                // ì§€ì—­ëª…ê³¼ ì—°ë„ ì œì™¸
                const regions = ['ì„œìš¸', 'ë¶€ì‚°', 'ëŒ€êµ¬', 'ì¸ì²œ', 'ê´‘ì£¼', 'ëŒ€ì „', 'ìš¸ì‚°', 'ì„¸ì¢…', 'ê²½ê¸°', 'ê°•ì›', 'ì¶©ë¶', 'ì¶©ë‚¨', 'ì „ë¶', 'ì „ë‚¨', 'ê²½ë¶', 'ê²½ë‚¨', 'ì œì£¼'];
                const isRegion = regions.includes(tag);
                const isYear = /^\d{4}$/.test(tag);
                return !isRegion && !isYear && tag.length > 1;
            });
            
            return filteredTags.slice(0, 3);
        }
        
        // ì œëª©ìœ¼ë¡œ ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜
        function categorizeByTitle(title) {
            for (const [category, keywords] of Object.entries(categoryKeywords)) {
                if (category === 'ê¸°íƒ€') continue;
                for (const keyword of keywords) {
                    if (title.includes(keyword)) {
                        return category;
                    }
                }
            }
            return 'ê¸°íƒ€';
        }

        function getSampleData() {
            const today = new Date();
            const yesterday = new Date(today);
            yesterday.setDate(yesterday.getDate() - 1);
            
            return [
                {
                    id: 1,
                    title: '2026ë…„ ì¤‘ì†Œê¸°ì—… R&D ì—­ëŸ‰ê°•í™” ì§€ì›ì‚¬ì—…',
                    agency: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€',
                    category: 'R&D',
                    registDate: today.toISOString().split('T')[0],
                    deadline: '2026-02-28',
                    budget: 'ìµœëŒ€ 3ì–µì›',
                    tags: ['R&D', 'ê¸°ìˆ ê°œë°œ', 'ì œì¡°ì—…'],
                    url: 'https://www.bizinfo.go.kr/web/lay1/bbs/S1T122C128/AS/74/list.do'
                },
                {
                    id: 2,
                    title: 'ìˆ˜ì¶œë°”ìš°ì²˜ ì§€ì›ì‚¬ì—… (1ì°¨)',
                    agency: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€',
                    category: 'ìˆ˜ì¶œ/í•´ì™¸ì§„ì¶œ',
                    registDate: today.toISOString().split('T')[0],
                    deadline: '2026-01-31',
                    budget: 'ìµœëŒ€ 1ì–µì›',
                    tags: ['ìˆ˜ì¶œ', 'í•´ì™¸ì§„ì¶œ', 'ê¸€ë¡œë²Œ'],
                    url: 'https://www.bizinfo.go.kr/web/lay1/bbs/S1T122C128/AS/74/list.do'
                },
                {
                    id: 3,
                    title: 'ìŠ¤ë§ˆíŠ¸ê³µì¥ êµ¬ì¶•Â·ê³ ë„í™” ì§€ì›',
                    agency: 'ì‚°ì—…í†µìƒìì›ë¶€',
                    category: 'ìŠ¤ë§ˆíŠ¸ê³µì¥',
                    registDate: today.toISOString().split('T')[0],
                    deadline: '2026-03-15',
                    budget: 'ìµœëŒ€ 2ì–µì›',
                    tags: ['ìŠ¤ë§ˆíŠ¸ê³µì¥', 'ë””ì§€í„¸ì „í™˜', 'ì œì¡°í˜ì‹ '],
                    url: 'https://www.bizinfo.go.kr/web/lay1/bbs/S1T122C128/AS/74/list.do'
                },
                {
                    id: 4,
                    title: 'AI ë°”ìš°ì²˜ ì§€ì›ì‚¬ì—…',
                    agency: 'ê³¼í•™ê¸°ìˆ ì •ë³´í†µì‹ ë¶€',
                    category: 'R&D',
                    registDate: yesterday.toISOString().split('T')[0],
                    deadline: '2026-02-15',
                    budget: 'ìµœëŒ€ 2ì–µì›',
                    tags: ['AI', 'ì¸ê³µì§€ëŠ¥', 'ë””ì§€í„¸'],
                    url: 'https://www.bizinfo.go.kr/web/lay1/bbs/S1T122C128/AS/74/list.do'
                },
                {
                    id: 5,
                    title: 'ì²­ë…„ì°½ì—…ì‚¬ê´€í•™êµ 10ê¸° ëª¨ì§‘',
                    agency: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€',
                    category: 'ì°½ì—…ì§€ì›',
                    registDate: today.toISOString().split('T')[0],
                    deadline: '2026-01-20',
                    budget: 'ìµœëŒ€ 1ì–µì›',
                    tags: ['ì°½ì—…', 'ì²­ë…„', 'ì˜ˆë¹„ì°½ì—…'],
                    url: 'https://www.bizinfo.go.kr/web/lay1/bbs/S1T122C128/AS/74/list.do'
                },
                {
                    id: 6,
                    title: 'íƒ„ì†Œì¤‘ë¦½ ì‹¤ì²œ ì¤‘ì†Œê¸°ì—… ì§€ì›',
                    agency: 'í™˜ê²½ë¶€',
                    category: 'ESG/ì¹œí™˜ê²½',
                    registDate: today.toISOString().split('T')[0],
                    deadline: '2026-02-28',
                    budget: 'ìµœëŒ€ 5ì²œë§Œì›',
                    tags: ['ESG', 'íƒ„ì†Œì¤‘ë¦½', 'ì¹œí™˜ê²½'],
                    url: 'https://www.bizinfo.go.kr/web/lay1/bbs/S1T122C128/AS/74/list.do'
                },
                {
                    id: 7,
                    title: 'ì¤‘ì†Œê¸°ì—… ì¸ë ¥ì–‘ì„± ì§€ì›ì‚¬ì—…',
                    agency: 'ê³ ìš©ë…¸ë™ë¶€',
                    category: 'ì¸ë ¥ì–‘ì„±',
                    registDate: yesterday.toISOString().split('T')[0],
                    deadline: '2026-03-31',
                    budget: '1ì¸ë‹¹ 200ë§Œì›',
                    tags: ['ì¸ë ¥', 'êµìœ¡', 'ì—­ëŸ‰ê°•í™”'],
                    url: 'https://www.bizinfo.go.kr/web/lay1/bbs/S1T122C128/AS/74/list.do'
                },
                {
                    id: 8,
                    title: 'ì˜¨ë¼ì¸ íŒë¡œê°œì²™ ì§€ì›(ì´ì»¤ë¨¸ìŠ¤)',
                    agency: 'ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ë¶€',
                    category: 'íŒë¡œ/ë§ˆì¼€íŒ…',
                    registDate: today.toISOString().split('T')[0],
                    deadline: '2026-02-10',
                    budget: 'ìµœëŒ€ 7ì²œë§Œì›',
                    tags: ['íŒë¡œ', 'ì˜¨ë¼ì¸', 'eì»¤ë¨¸ìŠ¤'],
                    url: 'https://www.bizinfo.go.kr/web/lay1/bbs/S1T122C128/AS/74/list.do'
                }
            ];
        }

        function categorizeNotice(notice) {
            const title = notice.title || '';
            
            for (const [category, keywords] of Object.entries(categoryKeywords)) {
                if (category === 'ê¸°íƒ€') continue;
                
                for (const keyword of keywords) {
                    if (title.includes(keyword)) {
                        return category;
                    }
                }
            }
            return 'ê¸°íƒ€';
        }

        function getDaysUntilDeadline(deadlineStr) {
            const deadline = new Date(deadlineStr);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            deadline.setHours(0, 0, 0, 0);
            
            const diffTime = deadline - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            return diffDays;
        }

        function isNewNotice(registDate) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const regDate = new Date(registDate);
            regDate.setHours(0, 0, 0, 0);
            
            return regDate.getTime() === today.getTime();
        }

        function renderNotices(notices, isFiltered = false) {
            const content = document.getElementById('content');
            
            const categorized = {};
            let todayNewCount = 0;
            let urgentCount = 0;
            
            // ì „ì²´ ë°ì´í„°ë¡œ í†µê³„ ê³„ì‚° (í•­ìƒ allNotices ê¸°ì¤€)
            allNotices.forEach(notice => {
                if (isNewNotice(notice.registDate)) {
                    todayNewCount++;
                }
                
                const daysLeft = getDaysUntilDeadline(notice.deadline);
                if (daysLeft <= 7 && daysLeft > 0) {
                    urgentCount++;
                }
            });
            
            // í•„í„°ë§ëœ ê³µê³ ë§Œ ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜
            notices.forEach(notice => {
                const category = notice.category || categorizeNotice(notice);
                if (!categorized[category]) {
                    categorized[category] = [];
                }
                categorized[category].push(notice);
            });
            
            document.getElementById('todayCount').textContent = todayNewCount;
            document.getElementById('totalCount').textContent = allNotices.length;
            document.getElementById('urgentCount').textContent = urgentCount;
            document.getElementById('updateTime').textContent = 
                `ìµœì¢… ì—…ë°ì´íŠ¸: ${new Date().toLocaleString('ko-KR')}`;
            
            // í•„í„° ë©”ì‹œì§€ ì¶”ê°€
            let filterMessage = '';
            if (isFiltered) {
                if (currentFilter === 'today') {
                    filterMessage = '<div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); border-radius: 16px; margin-bottom: 20px; color: #1976d2; font-weight: 700; border: 2px solid #90caf9;">ğŸ“¢ ì˜¤ëŠ˜ì˜ ì‹ ê·œê³µê³ ë§Œ í‘œì‹œì¤‘ì…ë‹ˆë‹¤</div>';
                } else if (currentFilter === 'urgent') {
                    filterMessage = '<div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%); border-radius: 16px; margin-bottom: 20px; color: #c62828; font-weight: 700; border: 2px solid #ef9a9a;">âš ï¸ ë§ˆê°ì„ë°• ê³µê³ ë§Œ í‘œì‹œì¤‘ì…ë‹ˆë‹¤ (D-7 ì´ë‚´)</div>';
                }
            }
            
            let html = filterMessage;
            
            const categoryIcons = {
                'R&D': 'ğŸ”¬',
                'ìê¸ˆì§€ì›': 'ğŸ’°',
                'ìˆ˜ì¶œ/í•´ì™¸ì§„ì¶œ': 'ğŸŒ',
                'ì¸ë ¥ì–‘ì„±': 'ğŸ‘¥',
                'ìŠ¤ë§ˆíŠ¸ê³µì¥': 'ğŸ­',
                'íŒë¡œ/ë§ˆì¼€íŒ…': 'ğŸ“ˆ',
                'ì°½ì—…ì§€ì›': 'ğŸš€',
                'ê²½ì˜í˜ì‹ ': 'ğŸ’¡',
                'ESG/ì¹œí™˜ê²½': 'ğŸŒ±',
                'ê¸°íƒ€': 'ğŸ“‹'
            };
            
            for (const [category, items] of Object.entries(categorized)) {
                const icon = categoryIcons[category] || 'ğŸ“‹';
                const newInCategory = items.filter(n => isNewNotice(n.registDate)).length;
                
                html += `
                    <div class="category-section">
                        <div class="category-header" onclick="toggleCategory(this)">
                            <div class="category-title">
                                <div class="category-icon">${icon}</div>
                                <span>${category}</span>
                                <span class="category-badge">${items.length}ê±´</span>
                                ${newInCategory > 0 ? `<span class="category-badge new">NEW ${newInCategory}</span>` : ''}
                            </div>
                            <span class="toggle-icon">â–¼</span>
                        </div>
                        <div class="notice-list active">
                `;
                
                items.forEach(notice => {
                    const daysLeft = getDaysUntilDeadline(notice.deadline);
                    const isNew = isNewNotice(notice.registDate);
                    const isUrgent = daysLeft <= 7 && daysLeft > 0;
                    
                    let deadlineText = '';
                    if (daysLeft < 0) {
                        deadlineText = 'ë§ˆê°';
                    } else if (daysLeft === 0) {
                        deadlineText = 'D-Day';
                    } else {
                        deadlineText = `D-${daysLeft}`;
                    }
                    
                    // ì§€ì›ê¸ˆì•¡ íƒœê·¸ ìƒì„±
                    const budgetTag = notice.budget && notice.budget !== 'ë¯¸ì •' 
                        ? `<span class="tag budget">ğŸ’° ${notice.budget}</span>` 
                        : '';
                    
                    // ì¶”ì²œëŒ€ìƒ íƒœê·¸ ìƒì„± (ì§€ì›ëŒ€ìƒ: ì†Œìƒê³µì¸, ì¤‘ì†Œê¸°ì—… ë“±)
                    const targetTag = notice.target 
                        ? `<span class="tag target">ğŸ‘¥ ${notice.target}</span>` 
                        : '';
                    
                    html += `
                        <div class="notice-item ${isNew ? 'new' : ''}" onclick="window.open('${notice.url}', '_blank')">
                            <div class="notice-title">${notice.title}</div>
                            <div class="notice-meta">
                                <div class="meta-item">ğŸ¢ ${notice.agency}</div>
                                <div class="meta-item">ğŸ“… ${notice.deadline}</div>
                                <div class="deadline-badge ${isUrgent ? 'urgent' : ''}">${deadlineText}</div>
                            </div>
                            <div class="notice-tags">
                                ${budgetTag}
                                ${targetTag}
                                ${notice.tags.map(tag => `<span class="tag">#${tag}</span>`).join('')}
                            </div>
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            }
            
            content.innerHTML = html;
        }

        function toggleCategory(header) {
            header.classList.toggle('collapsed');
            const noticeList = header.nextElementSibling;
            noticeList.classList.toggle('active');
        }

        async function loadNewNotices() {
            const content = document.getElementById('content');
            
            content.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>ìµœì‹  ê³µê³ ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>
                </div>
            `;
            
            setTimeout(async () => {
                const notices = await fetchBizinfoData();
                allNotices = notices; // ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
                
                if (notices.length === 0) {
                    content.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">ğŸ˜Š</div>
                            <p>ì˜¤ëŠ˜ ë“±ë¡ëœ ì‹ ê·œ ê³µê³ ê°€ ì—†ìŠµë‹ˆë‹¤.<br>ë‚´ì¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”!</p>
                        </div>
                    `;
                } else {
                    // ê¸°ë³¸ì€ ì „ì²´ í‘œì‹œ
                    filterNotices('all');
                }
            }, 1000);
        }
    </script>
</body>
</html>