<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì½”ë¦¬ì•„ê²½ì˜ìë¬¸ ì¬ë¬´ë¶„ì„ ì§„ë‹¨</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800&family=Noto+Sans+KR:wght@400;500;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: #f8f9fc;
            color: #1a1a2e;
            line-height: 1.6;
        }

        /* ë¡œê·¸ì¸ í™”ë©´ */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #1e3a5f 0%, #152a45 100%);
        }

        .login-box {
            background: white;
            border-radius: 24px;
            padding: 50px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 100%;
            max-width: 450px;
        }

        .login-title {
            font-family: 'Montserrat', 'Noto Sans KR', sans-serif;
            font-weight: 800;
            font-size: 2rem;
            color: #1e3a5f;
            text-align: center;
            margin-bottom: 40px;
        }

        .login-input {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Noto Sans KR', sans-serif;
            transition: all 0.3s ease;
        }

        .login-input:focus {
            outline: none;
            border-color: #2874a6;
            box-shadow: 0 0 0 3px rgba(40, 116, 166, 0.1);
        }

        .login-button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #2874a6 0%, #1e3a5f 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .login-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(40, 116, 166, 0.3);
        }

        .error-message {
            color: #991b1b;
            background: #fee2e2;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
            display: none;
        }

        /* ê´€ë¦¬ì íŒ¨ë„ */
        .admin-panel {
            display: none;
            padding: 30px;
            background: white;
            max-width: 1200px;
            margin: 30px auto;
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(30, 58, 95, 0.1);
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #2874a6;
        }

        .admin-title {
            font-family: 'Montserrat', 'Noto Sans KR', sans-serif;
            font-weight: 800;
            font-size: 1.8rem;
            color: #1e3a5f;
        }

        .logout-button {
            padding: 10px 20px;
            background: #fee2e2;
            color: #991b1b;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .admin-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-weight: 700;
            font-size: 1.2rem;
            color: #1e3a5f;
            margin-bottom: 15px;
        }

        .account-form {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 15px;
            margin-bottom: 20px;
        }

        .account-input {
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .add-button {
            padding: 12px 24px;
            background: linear-gradient(135deg, #2874a6 0%, #1e3a5f 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .accounts-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
        }

        .accounts-table th {
            background: linear-gradient(135deg, #1e3a5f 0%, #152a45 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 700;
        }

        .accounts-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
        }

        .delete-button {
            padding: 6px 12px;
            background: #fee2e2;
            color: #991b1b;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-family: 'Noto Sans KR', sans-serif;
        }

        /* ê¸°ì—… ì •ë³´ ì…ë ¥ í™”ë©´ */
        .company-info-container {
            display: none;
            max-width: 800px;
            margin: 50px auto;
            padding: 40px;
            background: white;
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(30, 58, 95, 0.1);
        }

        .company-info-title {
            font-family: 'Montserrat', 'Noto Sans KR', sans-serif;
            font-weight: 800;
            font-size: 2rem;
            color: #1e3a5f;
            margin-bottom: 10px;
            text-align: center;
        }

        .company-info-subtitle {
            text-align: center;
            color: #64748b;
            margin-bottom: 40px;
        }

        .company-form-group {
            margin-bottom: 25px;
        }

        .company-label {
            display: block;
            font-weight: 700;
            color: #1e3a5f;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .company-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Noto Sans KR', sans-serif;
            transition: all 0.3s ease;
        }

        .company-input:focus {
            outline: none;
            border-color: #2874a6;
            box-shadow: 0 0 0 3px rgba(40, 116, 166, 0.1);
        }

        .company-select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Noto Sans KR', sans-serif;
            transition: all 0.3s ease;
            background: white;
        }

        .company-select:focus {
            outline: none;
            border-color: #2874a6;
            box-shadow: 0 0 0 3px rgba(40, 116, 166, 0.1);
        }

        .company-submit-button {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #2874a6 0%, #1e3a5f 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans KR', sans-serif;
            margin-top: 10px;
        }

        .company-submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(40, 116, 166, 0.3);
        }

        .selected-company-info {
            background: linear-gradient(135deg, #e8eef5 0%, #d8e4f0 100%);
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .company-badge {
            font-weight: 700;
            color: #1e3a5f;
            font-size: 1.1rem;
        }

        .industry-badge {
            background: #2874a6;
            color: white;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        /* ë©”ì¸ ì•± */
        .app-container {
            display: none;
        }

        .header-accent {
            height: 6px;
            background: linear-gradient(90deg, #1e3a5f 0%, #2874a6 100%);
        }

        .header {
            background: linear-gradient(135deg, #1e3a5f 0%, #152a45 100%);
            padding: 30px 50px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-family: 'Montserrat', 'Noto Sans KR', sans-serif;
            font-weight: 800;
            font-size: 2rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
        }

        .main-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            height: calc(100vh - 150px);
            gap: 0;
        }

        .left-panel {
            background: white;
            padding: 30px;
            border-right: 3px solid #2874a6;
            overflow-y: auto;
        }

        .right-panel {
            background: #f8f9fc;
            padding: 30px;
            overflow-y: auto;
        }

        .panel-title {
            font-family: 'Montserrat', 'Noto Sans KR', sans-serif;
            font-weight: 800;
            font-size: 1.5rem;
            color: #1e3a5f;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #2874a6;
            position: sticky;
            top: 0;
            background: white;
            z-index: 10;
        }

        .right-panel .panel-title {
            background: #f8f9fc;
        }

        .input-mode-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }

        .mode-tab {
            flex: 1;
            padding: 15px 20px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans KR', sans-serif;
            color: #64748b;
            text-align: center;
        }

        .mode-tab.active {
            background: linear-gradient(135deg, #2874a6 0%, #1e3a5f 100%);
            color: white;
            border-color: #2874a6;
        }

        .input-content {
            display: none;
        }

        .input-content.active {
            display: block;
        }

        .upload-section {
            background: linear-gradient(135deg, #f8f9fc 0%, #e8eef5 100%);
            border: 3px dashed #2874a6;
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-section:hover {
            border-color: #1e3a5f;
            background: linear-gradient(135deg, #e8eef5 0%, #d8e4f0 100%);
        }

        .upload-icon {
            font-size: 3rem;
            color: #2874a6;
            margin-bottom: 15px;
        }

        .upload-text {
            font-size: 1.1rem;
            font-weight: 700;
            color: #1e3a5f;
            margin-bottom: 8px;
        }

        .file-input {
            display: none;
        }

        .selected-file {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #2874a6;
            margin-bottom: 20px;
            display: none;
        }

        .selected-file.show {
            display: block;
        }

        .section-header {
            background: linear-gradient(135deg, #2874a6 0%, #1e3a5f 100%);
            color: white;
            padding: 12px 15px;
            font-weight: 700;
            font-size: 1rem;
            border-radius: 8px;
            margin: 20px 0 15px 0;
        }

        .input-table {
            width: 100%;
            margin-bottom: 20px;
        }

        .input-table th {
            background: #e8eef5;
            color: #1e3a5f;
            padding: 10px;
            text-align: center;
            font-weight: 700;
            font-size: 0.9rem;
            border: 1px solid #d0dae8;
        }

        .input-table td {
            padding: 8px;
            border: 1px solid #e2e8f0;
        }

        .item-label {
            background: #f8f9fc;
            color: #1e3a5f;
            font-weight: 600;
            padding-left: 15px;
            font-size: 0.9rem;
        }

        .year-input {
            width: 100%;
            padding: 8px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            text-align: right;
            font-size: 0.9rem;
            font-family: 'Noto Sans KR', sans-serif;
            transition: all 0.2s ease;
        }

        .year-input:focus {
            outline: none;
            border-color: #2874a6;
            box-shadow: 0 0 0 3px rgba(40, 116, 166, 0.1);
        }

        

        

        

        

        

        .results-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(30, 58, 95, 0.08);
        }

        .results-card h3 {
            font-weight: 700;
            color: #1e3a5f;
            margin-bottom: 15px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .metric-card {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            box-shadow: 0 4px 12px rgba(40, 116, 166, 0.15);
            border-color: #2874a6;
        }

        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e8eef5;
        }

        .metric-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #1e3a5f;
        }

        .metric-standard {
            background: #e8eef5;
            color: #2874a6;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .metric-years {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .year-column {
            text-align: center;
        }

        .year-label {
            font-size: 0.85rem;
            font-weight: 600;
            color: #64748b;
            margin-bottom: 8px;
        }

        .year-value-large {
            font-size: 1.5rem;
            font-weight: 800;
            color: #1e3a5f;
            margin-bottom: 8px;
        }

        .year-judgment {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 700;
        }

        .judgment-excellent {
            background: #d1fae5;
            color: #065f46;
        }

        .judgment-good {
            background: #dbeafe;
            color: #1e40af;
        }

        .judgment-poor {
            background: #fee2e2;
            color: #991b1b;
        }

        .consultant-comment {
            background: linear-gradient(135deg, #f8f9fc 0%, #e8eef5 100%);
            border-radius: 12px;
            padding: 30px;
            border: 2px solid #2874a6;
        }

        .consultant-comment h3 {
            font-family: 'Montserrat', 'Noto Sans KR', sans-serif;
            font-weight: 800;
            font-size: 1.3rem;
            color: #1e3a5f;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .comment-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .comment-section h4 {
            font-weight: 700;
            color: #2874a6;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .comment-section ul {
            list-style: none;
            padding-left: 0;
        }

        .comment-section li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            color: #64748b;
            line-height: 1.6;
        }

        .comment-section li:before {
            content: "â–¸";
            position: absolute;
            left: 0;
            color: #2874a6;
            font-weight: 700;
        }

        .footer {
            background: #1e3a5f;
            color: white;
            text-align: center;
            padding: 20px;
            font-size: 0.9rem;
        }

        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
                height: auto;
            }

            .left-panel {
                border-right: none;
                border-bottom: 3px solid #2874a6;
            }

            
        }
    
        /* ê¸°ì—…ì •ë³´ ì…ë ¥ í™”ë©´ */
        .company-info-container {
            display: none;
            min-height: 100vh;
            background: linear-gradient(135deg, #f8f9fc 0%, #e8eef5 100%);
            padding: 50px 20px;
        }

        .company-info-box {
            max-width: 700px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            padding: 50px;
            box-shadow: 0 10px 40px rgba(30, 58, 95, 0.1);
        }

        .company-info-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .company-info-title {
            font-family: 'Montserrat', 'Noto Sans KR', sans-serif;
            font-weight: 800;
            font-size: 2rem;
            color: #1e3a5f;
            margin-bottom: 10px;
        }

        .company-info-subtitle {
            color: #64748b;
            font-size: 1rem;
        }

        .company-form-group {
            margin-bottom: 30px;
        }

        .company-label {
            display: block;
            font-weight: 700;
            color: #1e3a5f;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        .company-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Noto Sans KR', sans-serif;
            transition: all 0.3s ease;
        }

        .company-input:focus {
            outline: none;
            border-color: #2874a6;
            box-shadow: 0 0 0 3px rgba(40, 116, 166, 0.1);
        }

        .company-select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            font-size: 1rem;
            font-family: 'Noto Sans KR', sans-serif;
            transition: all 0.3s ease;
            background: white;
            cursor: pointer;
        }

        .company-select:focus {
            outline: none;
            border-color: #2874a6;
            box-shadow: 0 0 0 3px rgba(40, 116, 166, 0.1);
        }

        .company-submit-button {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #2874a6 0%, #1e3a5f 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans KR', sans-serif;
            margin-top: 10px;
        }

        .company-submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(40, 116, 166, 0.3);
        }

        .selected-company-info {
            background: linear-gradient(135deg, #e8eef5 0%, #d8e4f0 100%);
            padding: 20px 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border: 2px solid #2874a6;
        }

        .company-name-display {
            font-weight: 800;
            font-size: 1.3rem;
            color: #1e3a5f;
            margin-bottom: 8px;
        }

        .industry-info-display {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .industry-code-badge {
            background: #2874a6;
            color: white;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 700;
        }

        .industry-name-display {
            color: #64748b;
            font-size: 0.95rem;
        }

    
        .upload-section-top {
            background: linear-gradient(135deg, #f8f9fc 0%, #e8eef5 100%);
            border: 3px dashed #2874a6;
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-section-top:hover {
            border-color: #1e3a5f;
            background: linear-gradient(135deg, #e8eef5 0%, #d8e4f0 100%);
        }

        .selected-file-top {
            background: white;
            padding: 15px;
            border-radius: 12px;
            border: 2px solid #2874a6;
            margin-top: 15px;
            display: none;
        }

        .selected-file-top.show {
            display: block;
        }
    
        

        

        

        .overall-judgment-large.excellent {
            color: #10b981;
            text-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
        }

        .overall-judgment-large.good {
            color: #3b82f6;
            text-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }

        .overall-judgment-large.poor {
            color: #ef4444;
            text-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
        }

        
        
        /* ì—…ì¢…ë³„ ê¸°ì¤€ê°’ ìŠ¤íƒ€ì¼ */
        .metric-standards {
            display: flex;
            gap: 12px;
            margin-top: 8px;
            flex-wrap: wrap;
        }
        
        .standard-item {
            font-size: 13px;
            padding: 4px 12px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 4px;
            border-left: 3px solid #3498db;
        }
        
        /* ì¸ì‡„ ìŠ¤íƒ€ì¼ */
        @media print {
            .left-panel {
                display: none !important;
            }
            
            .header {
                display: none !important;
            }
            
            .header-accent {
                display: none !important;
            }
            
            .right-panel {
                width: 100% !important;
                max-width: 100% !important;
                margin: 0 !important;
                padding: 20px !important;
            }
            
            .footer {
                display: none !important;
            }
            
            button {
                display: none !important;
            }
            
            /* í‰ê°€ ê¸°ì¤€ ì„ íƒ ë²„íŠ¼ ìˆ¨ê¸°ê³  ì¸ì‡„ìš© í…ìŠ¤íŠ¸ í‘œì‹œ */
            #evaluationModeButtons {
                display: none !important;
            }
            
            #evaluationModePrint {
                display: block !important;
            }
            
            #evaluationModeSection {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                background: rgba(255,255,255,0.15) !important;
            }
            
            .panel-title {
                font-size: 28px !important;
                margin-bottom: 25px !important;
                text-align: center;
                color: #1e3a5f;
                border-bottom: 3px solid #667eea;
                padding-bottom: 15px;
            }
            
            #diagnosisInfoBox {
                page-break-inside: avoid;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
                margin-bottom: 30px !important;
            }
            
            .metric-card {
                page-break-inside: avoid;
                margin-bottom: 20px !important;
            }
            
            .consultant-comment {
                page-break-before: always;
            }
            
            @page {
                margin: 2cm;
            }
        }
    </style>
</head>
<body>
    <!-- ë¡œê·¸ì¸ í™”ë©´ -->
    <div id="loginContainer" class="login-container">
        <div class="login-box">
            <h1 class="login-title">ì½”ë¦¬ì•„ê²½ì˜ìë¬¸<br>ì¬ë¬´ë¶„ì„ ì§„ë‹¨</h1>
            <div id="loginError" class="error-message"></div>
            <input type="text" id="username" class="login-input" placeholder="ì•„ì´ë””" autocomplete="off">
            <input type="password" id="password" class="login-input" placeholder="ë¹„ë°€ë²ˆí˜¸" autocomplete="off">
            <button class="login-button" onclick="login()">ë¡œê·¸ì¸</button>
        </div>
    </div>


    <!-- ê´€ë¦¬ì íŒ¨ë„ -->
    <div id="adminPanel" class="admin-panel">
        <div class="admin-header">
            <h1 class="admin-title">ğŸ‘¤ ê´€ë¦¬ì íŒ¨ë„</h1>
            <button class="logout-button" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
        </div>

        <div class="admin-section">
            <h2 class="section-title">ìƒˆ ê³„ì • ì¶”ê°€</h2>
            <div class="account-form">
                <input type="text" id="newUsername" class="account-input" placeholder="ì•„ì´ë””">
                <input type="password" id="newPassword" class="account-input" placeholder="ë¹„ë°€ë²ˆí˜¸">
                <button class="add-button" onclick="addAccount()">ê³„ì • ì¶”ê°€</button>
            </div>
        </div>

        <div class="admin-section">
            <h2 class="section-title">ê³„ì • ëª©ë¡</h2>
            <table class="accounts-table">
                <thead>
                    <tr>
                        <th>ì•„ì´ë””</th>
                        <th>ì¡°íšŒìˆ˜</th>
                        <th>ë§ˆì§€ë§‰ ì ‘ì†</th>
                        <th>ê´€ë¦¬</th>
                    </tr>
                </thead>
                <tbody id="accountsTableBody"></tbody>
            </table>
        </div>
    </div>

    <!-- ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ -->
    <div id="appContainer" class="app-container">
        <div class="header-accent"></div>
        <div class="header">
            <h1>ì½”ë¦¬ì•„ê²½ì˜ìë¬¸ ì¬ë¬´ë¶„ì„ ì§„ë‹¨</h1>
            <div class="user-info">
                <div class="user-badge" id="currentUser"></div>
                <button class="logout-button" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
            </div>
        </div>

        <div class="main-container">
            <!-- ì™¼ìª½ íŒ¨ë„: ì…ë ¥ ì˜ì—­ -->
            <div class="left-panel">
                <div class="panel-title">ğŸ“ ì¬ë¬´ ë°ì´í„° ì…ë ¥</div>
                <!-- ì„ íƒëœ ê¸°ì—… ì •ë³´ -->
                <div class="upload-section-top" id="uploadArea">
                    <div class="upload-icon">ğŸ“Š</div>
                    <div class="upload-text">ì¬ë¬´ë¶„ì„ ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</div>
                    <div style="color: #64748b; font-size: 0.9rem; margin-bottom: 15px;">ë“œë˜ê·¸ ì•¤ ë“œë¡­ ë˜ëŠ” í´ë¦­í•˜ì—¬ ì„ íƒ</div>
                    <input type="file" id="fileInput" class="file-input" accept=".xlsx,.xls">
                    <div id="selectedFile" class="selected-file-top">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 700; color: #1e3a5f; margin-bottom: 5px;" id="fileName"></div>
                                <div style="color: #64748b; font-size: 0.9rem;" id="fileSize"></div>
                            </div>
                            <button onclick="removeFile()" style="background: #fee2e2; color: #991b1b; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; font-family: 'Noto Sans KR', sans-serif;">ì œê±°</button>
                        </div>
                    </div>
                </div>

                <div style="margin: 30px 0; text-align: center; color: #64748b; font-weight: 600;">
                    ì—…ë¡œë“œëœ ë°ì´í„°ë¥¼ ì•„ë˜ì—ì„œ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
                </div>

                <!-- ì§ì ‘ ì…ë ¥ ì˜ì—­ -->
                <div id="manualMode" class="input-content active">
                    <div class="section-header">ì¬ë¬´ìƒíƒœí‘œ (23ê°œ í•­ëª©)</div>
                    <table class="input-table">
                        <thead>
                            <tr>
                                <th style="width: 50%;">í•­ëª©</th>
                                <th>2022ë…„</th>
                                <th>2023ë…„</th>
                                <th>2024ë…„</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td class="item-label">ìì‚°(*)</td><td><input type="number" class="year-input" id="asset_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="asset_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="asset_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ìœ ë™ìì‚°(*)</td><td><input type="number" class="year-input" id="current_asset_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="current_asset_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="current_asset_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë‹¹ì¢Œìì‚°(*)</td><td><input type="number" class="year-input" id="quick_asset_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="quick_asset_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="quick_asset_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">í˜„ê¸ˆ ë° í˜„ê¸ˆì„±ìì‚°(*)</td><td><input type="number" class="year-input" id="cash_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="cash_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="cash_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ê°€ì§€ê¸‰ê¸ˆ</td><td><input type="number" class="year-input" id="provisional_payment_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="provisional_payment_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="provisional_payment_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë§¤ì¶œì±„ê¶Œ(*)</td><td><input type="number" class="year-input" id="receivable_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="receivable_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="receivable_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë‹¨ê¸°ëŒ€ì—¬ê¸ˆ(*)</td><td><input type="number" class="year-input" id="short_loan_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="short_loan_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="short_loan_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë¯¸ìˆ˜ê¸ˆ(*)</td><td><input type="number" class="year-input" id="accrued_income_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="accrued_income_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="accrued_income_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ì¬ê³ ìì‚°(*)</td><td><input type="number" class="year-input" id="inventory_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="inventory_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="inventory_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ì¥ê¸°ëŒ€ì—¬ê¸ˆ</td><td><input type="number" class="year-input" id="long_loan_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="long_loan_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="long_loan_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ìœ í˜•ìì‚°(*)</td><td><input type="number" class="year-input" id="tangible_asset_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="tangible_asset_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="tangible_asset_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë¬´í˜•ìì‚°(*)</td><td><input type="number" class="year-input" id="intangible_asset_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="intangible_asset_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="intangible_asset_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë¹„ìœ ë™ìì‚°(*)</td><td><input type="number" class="year-input" id="noncurrent_asset_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="noncurrent_asset_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="noncurrent_asset_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë¶€ì±„(*)</td><td><input type="number" class="year-input" id="liability_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="liability_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="liability_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ìœ ë™ë¶€ì±„(*)</td><td><input type="number" class="year-input" id="current_liability_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="current_liability_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="current_liability_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë§¤ì…ì±„ë¬´(*)</td><td><input type="number" class="year-input" id="payable_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="payable_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="payable_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ê°€ìˆ˜ê¸ˆ</td><td><input type="number" class="year-input" id="provisional_receipt_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="provisional_receipt_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="provisional_receipt_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë‹¨ê¸°ì°¨ì…ê¸ˆ(*)</td><td><input type="number" class="year-input" id="short_borrowing_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="short_borrowing_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="short_borrowing_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ì¥ê¸°ì°¨ì…ê¸ˆ(*)</td><td><input type="number" class="year-input" id="long_borrowing_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="long_borrowing_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="long_borrowing_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ìë³¸(*)</td><td><input type="number" class="year-input" id="equity_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="equity_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="equity_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ìë³¸ê¸ˆ(*)</td><td><input type="number" class="year-input" id="capital_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="capital_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="capital_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë¯¸ì²˜ë¶„ì´ìµì‰ì—¬ê¸ˆ(ê²°ì†ê¸ˆ)</td><td><input type="number" class="year-input" id="retained_earnings_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="retained_earnings_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="retained_earnings_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">*ë‹¹ê¸°ìˆœì´ìµ</td><td><input type="number" class="year-input" id="net_income_bs_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="net_income_bs_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="net_income_bs_2024" oninput="calculate()"></td></tr>
                        </tbody>
                    </table>

                    <div class="section-header">ì†ìµê³„ì‚°ì„œ (8ê°œ í•­ëª©)</div>
                    <table class="input-table">
                        <thead>
                            <tr>
                                <th style="width: 50%;">í•­ëª©</th>
                                <th>2022ë…„</th>
                                <th>2023ë…„</th>
                                <th>2024ë…„</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td class="item-label">ë§¤ì¶œì•¡(*)</td><td><input type="number" class="year-input" id="revenue_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="revenue_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="revenue_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë§¤ì¶œì´ì´ìµ(ì†ì‹¤)</td><td><input type="number" class="year-input" id="gross_profit_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="gross_profit_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="gross_profit_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">íŒë§¤ë¹„ì™€ê´€ë¦¬ë¹„(*)</td><td><input type="number" class="year-input" id="operating_expense_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="operating_expense_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="operating_expense_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ì˜ì—…ì´ìµ(ì†ì‹¤)</td><td><input type="number" class="year-input" id="operating_income_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="operating_income_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="operating_income_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ì´ìë¹„ìš©</td><td><input type="number" class="year-input" id="interest_expense_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="interest_expense_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="interest_expense_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë²•ì¸ì„¸ë¹„ìš©ì°¨ê°ì „ìˆœì†ìµ</td><td><input type="number" class="year-input" id="pretax_income_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="pretax_income_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="pretax_income_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë²•ì¸ì„¸ë¹„ìš©</td><td><input type="number" class="year-input" id="tax_expense_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="tax_expense_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="tax_expense_2024" oninput="calculate()"></td></tr>
                            <tr><td class="item-label">ë‹¹ê¸°ìˆœì´ìµ(ì†ì‹¤)</td><td><input type="number" class="year-input" id="net_income_2022" oninput="calculate()"></td><td><input type="number" class="year-input" id="net_income_2023" oninput="calculate()"></td><td><input type="number" class="year-input" id="net_income_2024" oninput="calculate()"></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ì˜¤ë¥¸ìª½ íŒ¨ë„: ê²°ê³¼ ì˜ì—­ -->
            <div class="right-panel">
                <div class="panel-title">
                    ğŸ“Š ì¬ë¬´ë¶„ì„ ì§„ë‹¨ ë¦¬í¬íŠ¸
                    <button onclick="window.print()" style="float: right; padding: 8px 16px; background: #27ae60; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">ğŸ“„ PDF ì¸ì‡„</button>
                </div>

                <!-- ê¸°ì—… ì§„ë‹¨ ì •ë³´ ë°•ìŠ¤ -->
                <div id="diagnosisInfoBox" style="display: none; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 24px 28px; border-radius: 12px; margin-bottom: 28px; box-shadow: 0 6px 20px rgba(102, 126, 234, 0.25);">
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; color: white; margin-bottom: 20px;">
                        <div style="background: rgba(255,255,255,0.12); padding: 16px 20px; border-radius: 10px; border-left: 4px solid rgba(255,255,255,0.5);">
                            <div style="font-size: 13px; opacity: 0.85; margin-bottom: 8px; font-weight: 500;">ê¸°ì—…ëª…</div>
                            <div id="diagCompanyName" style="font-size: 19px; font-weight: 700; letter-spacing: -0.3px;">-</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.12); padding: 16px 20px; border-radius: 10px; border-left: 4px solid rgba(255,255,255,0.5);">
                            <div style="font-size: 13px; opacity: 0.85; margin-bottom: 8px; font-weight: 500;">ì—…ì¢…</div>
                            <div id="diagIndustry" style="font-size: 19px; font-weight: 700; letter-spacing: -0.3px;">-</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.12); padding: 16px 20px; border-radius: 10px; border-left: 4px solid rgba(255,255,255,0.5);">
                            <div style="font-size: 13px; opacity: 0.85; margin-bottom: 8px; font-weight: 500;">ì§„ë‹¨ ì»¨ì„¤í„´íŠ¸</div>
                            <div id="diagConsultant" style="font-size: 19px; font-weight: 700; letter-spacing: -0.3px;">-</div>
                        </div>
                    </div>
                    
                    <!-- í‰ê°€ ê¸°ì¤€ ì„ íƒ ë²„íŠ¼ -->
                    <div id="evaluationModeSection" style="background: rgba(255,255,255,0.15); padding: 18px 22px; border-radius: 10px;">
                        <div style="font-size: 13px; opacity: 0.9; margin-bottom: 12px; font-weight: 600; color: white;">ğŸ“Š í‰ê°€ ê¸°ì¤€ ì„ íƒ</div>
                        <div id="evaluationModeButtons" style="display: flex; gap: 12px;">
                            <button id="btnBankMode" onclick="switchEvaluationMode('bank')" style="flex: 1; padding: 12px 18px; background: white; color: #667eea; border: none; border-radius: 8px; font-weight: 700; font-size: 14px; cursor: pointer; transition: all 0.2s; box-shadow: 0 3px 8px rgba(0,0,0,0.15);">
                                ğŸ¦ ì€í–‰ê¸°ì¤€
                            </button>
                            <button id="btnIndustryMode" onclick="switchEvaluationMode('industry')" style="flex: 1; padding: 12px 18px; background: rgba(255,255,255,0.25); color: white; border: 2px solid rgba(255,255,255,0.4); border-radius: 8px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s;">
                                ğŸ­ ì—…ì¢…ê¸°ì¤€
                            </button>
                            <button id="btnTotalMode" onclick="switchEvaluationMode('total')" style="flex: 1; padding: 12px 18px; background: rgba(255,255,255,0.25); color: white; border: 2px solid rgba(255,255,255,0.4); border-radius: 8px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 0.2s;">
                                ğŸ“Š í†µí•©ê¸°ì¤€
                            </button>
                        </div>
                        <!-- ì¸ì‡„ìš© í…ìŠ¤íŠ¸ (í‰ì†Œì—ëŠ” ìˆ¨ê¹€) -->
                        <div id="evaluationModePrint" style="display: none; font-size: 16px; font-weight: 700; color: white; text-align: center; padding: 12px;">
                            í˜„ì¬ ì ìš©ëœ í‰ê°€ ê¸°ì¤€: <span id="currentModeName">ğŸ¦ ì€í–‰ê¸°ì¤€</span>
                        </div>
                    </div>
                </div>

                <div class="results-card">
                    <h3>ğŸ“ˆ ì¬ë¬´ì§€í‘œ 3ê°œë…„ ë¹„êµ ë¶„ì„</h3>
                    <div id="metricsResults"></div>
                </div>

                <div class="consultant-comment" id="consultantSection" style="display: none;">
                    <h3>ğŸ’¼ ì»¨ì„¤í„´íŠ¸ ì œì•ˆ</h3>
                    <div id="consultantComment"></div>
                </div>
            </div>
        </div>

        <div class="footer">
            <div style="margin-bottom: 10px; font-weight: 500;">â˜ 02-6357-2025</div>
            <div style="opacity: 0.8;">Â© ì½”ë¦¬ì•„ê²½ì˜ìë¬¸</div>
        </div>
    </div>

    <script>
        // ê³„ì • ë°ì´í„° ì €ì¥ì†Œ (localStorage ì‚¬ìš©)
        function initializeAccounts() {
            // ê¸°ì¡´ localStorage ì™„ì „ ì´ˆê¸°í™”
            localStorage.removeItem('accounts');
            
            const accounts = {};
            
            // ê´€ë¦¬ì ê³„ì •
            accounts['admin'] = {
                password: 'admin1234',
                isAdmin: true,
                viewCount: 0,
                lastLogin: null
            };

            // ì‹¤ëª… ê³„ì • ëª©ë¡ (ë¹„ë°€ë²ˆí˜¸ ëª¨ë‘ 1234ë¡œ í†µì¼ - ì´ 48ëª…)
            const userList = [
                'ì¡°ì¹˜ë²”', 'ì •í˜œìœ¤', 'ê°•ì •í™˜', 'ê¹€ë´‰í•„', 'ê¹€ì—°í•œ', 'ê¹€ìš©í¬', 
                'ê¹€ì¢…ë¹ˆ', 'ë°•ë¬¸ìˆ˜', 'ì„œê°‘ê¸°', 'ì–‘ì€ëª¨', 'ì–‘í™˜ê¸°', 'ìœ ë™ê´€', 
                'ì„ì„ì¤‘', 'ì •ìš°ì„±', 'ì°¨ë§Œí¬', 'ì¶”ì •í•œ', 'í˜•ì£¼ì˜', 'ì •ëª…êµ¬', 
                'ê¹€ì² í¬', 'ë‚¨ìƒë§Œ', 'ë¬¸ë²”ëª¨', 'ë¬¸ì„±í¬', 'ë°•ì„±í›ˆ', 'ì•ˆëŒ€ìŠ¹', 
                'ì¡°ì˜ì˜¤', 'ì¡°ì¬ì™„', 'ìµœíšŒìˆ˜', 'ì‹ ìƒêµ­', 'ê¹€ê´€í˜•', 'ê¹€ë‘í•œ', 
                'ë°•ìƒí˜', 'ë°°í•œë‘', 'ì„œë„ê²¸', 'ì‹ ì¸ê· ', 'ìœ ì¸ìˆ˜', 'ì´ë™í˜', 
                'ì´ì€ì •', 'ì´í˜„ì¤€', 'ì´í¬ìš©', 'ìµœì¢…ê¸¸', 'ê¹€ì¬ê·¼', 'ë°•ìƒìš±', 
                'ë°•ìŠ¹ê·œ', 'ì–‘ì€í˜„', 'ì´ì„±ì›', 'ì „ìš©ì¤€', 'í™ê¸°ì—´', 'ìœ ì˜ì¤€'
            ];

            userList.forEach(username => {
                accounts[username] = {
                    password: '1234',  // ëª¨ë“  ê³„ì • ë¹„ë°€ë²ˆí˜¸ 1234
                    isAdmin: false,
                    viewCount: 0,
                    lastLogin: null
                };
            });

            localStorage.setItem('accounts', JSON.stringify(accounts));
            console.log('ê³„ì • ì´ˆê¸°í™” ì™„ë£Œ:', Object.keys(accounts).length, 'ê°œ (ë¹„ë°€ë²ˆí˜¸: 1234)');
            return accounts;
        }

        let currentUser = null;
        // ì—…ì¢… ë°ì´í„°
        const INDUSTRIES = [
  {"code": "A01", "name": "ë†ì—…"},
  {"code": "A03", "name": "ì–´ì—…"},
  {"code": "B", "name": "ê´‘ì—…"},
  {"code": "C", "name": "ì œì¡°ì—…"},
  {"code": "C10", "name": "ì‹ë£Œí’ˆ"},
  {"code": "C11", "name": "ìŒë£Œ"},
  {"code": "C13", "name": "ì„¬ìœ ì œí’ˆ(ì˜ë³µì œì™¸)"},
  {"code": "C14", "name": "ì˜ë³µ, ì˜ë³µì•¡ì„¸ì„œë¦¬ ë° ëª¨í”¼ì œí’ˆ"},
  {"code": "C15", "name": "ê°€ì£½, ê°€ë°© ë° ì‹ ë°œ"},
  {"code": "C16", "name": "ëª©ì¬ ë° ë‚˜ë¬´ì œí’ˆ(ê°€êµ¬ ì œì™¸)"},
  {"code": "C17", "name": "í„í”„, ì¢…ì´ ë° ì¢…ì´ì œí’ˆ"},
  {"code": "C18", "name": "ì¸ì‡„ ë° ê¸°ë¡ë§¤ì²´ ë³µì œì—…"},
  {"code": "C19", "name": "ì½”í¬ìŠ¤, ì—°íƒ„ ë° ì„ìœ ì •ì œí’ˆ"},
  {"code": "C20", "name": "í™”í•™ë¬¼ì§ˆ ë° í™”í•™ì œí’ˆ(ì˜ì•½í’ˆ ì œì™¸)"},
  {"code": "C21", "name": "ì˜ë£Œìš© ë¬¼ì§ˆ ë° ì˜ì•½í’ˆ"},
  {"code": "C22", "name": "ê³ ë¬´ì œí’ˆ ë° í”Œë¼ìŠ¤í‹±ì œí’ˆ"},
  {"code": "C23", "name": "ë¹„ê¸ˆì† ê´‘ë¬¼ì œí’ˆ"},
  {"code": "C24", "name": "1ì°¨ ê¸ˆì†"},
  {"code": "C25", "name": "ê¸ˆì†ê°€ê³µì œí’ˆ(ê¸°ê³„ ë° ê°€êµ¬ ì œì™¸)"},
  {"code": "C26", "name": "ì „ìë¶€í’ˆ, ì»´í“¨í„°, ì˜ìƒ, ìŒí–¥ ë° í†µì‹ ì¥ë¹„"},
  {"code": "C27", "name": "ì˜ë£Œ, ì •ë°€, ê´‘í•™ê¸°ê¸° ë° ì‹œê³„"},
  {"code": "C28", "name": "ì „ê¸°ì¥ë¹„"},
  {"code": "C29", "name": "ê¸°íƒ€ ê¸°ê³„ ë° ì¥ë¹„"},
  {"code": "C30", "name": "ìë™ì°¨ ë° íŠ¸ë ˆì¼ëŸ¬"},
  {"code": "C31", "name": "ê¸°íƒ€ ìš´ì†¡ì¥ë¹„"},
  {"code": "C32", "name": "ê°€êµ¬"},
  {"code": "C33", "name": "ê¸°íƒ€ ì œí’ˆ ì œì¡°ì—…"},
  {"code": "C34", "name": "ì‚°ì—…ìš©ê¸°ê³„ ë° ì¥ë¹„ìˆ˜ë¦¬ì—…"},
  {"code": "D35", "name": "ì „ê¸°, ê°€ìŠ¤, ì¦ê¸° ë° ê³µê¸°ì¡°ì ˆ ê³µê¸‰ì—…"},
  {"code": "E", "name": "í•˜ìˆ˜Â·íê¸°ë¬¼ ì²˜ë¦¬, ì›ë£Œì¬ìƒ ë° í™˜ê²½ë³µì›ì—…"},
  {"code": "F", "name": "ê±´ì„¤ì—…"},
  {"code": "G", "name": "ë„ë§¤ ë° ì†Œë§¤ì—…"},
  {"code": "H", "name": "ìš´ìˆ˜ ë° ì°½ê³ ì—…"},
  {"code": "I", "name": "ìˆ™ë°• ë° ìŒì‹ì ì—…"},
  {"code": "J", "name": "ì •ë³´í†µì‹ ì—…"},
  {"code": "L", "name": "ë¶€ë™ì‚°ì—…"},
  {"code": "M", "name": "ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…"},
  {"code": "N", "name": "ì‚¬ì—…ì‹œì„¤ê´€ë¦¬ ë° ì‚¬ì—…ì§€ì› ë° ì„ëŒ€ì„œë¹„ìŠ¤ì—…"},
  {"code": "P", "name": "êµìœ¡ ì„œë¹„ìŠ¤ì—…"},
  {"code": "R", "name": "ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…"},
  {"code": "ë¹„ì œì¡°ì—…", "name": "ë¹„ì œì¡°ì—…"},
  {"code": "ì „ì‚°ì—…", "name": "ì „ì‚°ì—…"},
  {"code": "ì „ì²´", "name": "ì „ì²´"}
];

        // ì—…ì¢…ëª… â†’ ì½”ë“œ ë§¤í•‘ (ê¸°ì¤€í‘œ.xlsx ì—…ì¢…ì½”ë“œë¶„ë¥˜ ì‹œíŠ¸ ê¸°ë°˜)
        const INDUSTRY_CODE_MAP = {
          "ë†ì—…": "A01",
          "ì–´ì—…": "A03",
          "ê´‘ì—…": "B",
          "ì œì¡°ì—…": "C",
          "ì‹ë£Œí’ˆ": "C10",
          "ìŒë£Œ": "C11",
          "ì„¬ìœ ì œí’ˆ(ì˜ë³µì œì™¸)": "C13",
          "ì˜ë³µ, ì˜ë³µì•¡ì„¸ì„œë¦¬ ë° ëª¨í”¼ì œí’ˆ": "C14",
          "ê°€ì£½, ê°€ë°© ë° ì‹ ë°œ": "C15",
          "ëª©ì¬ ë° ë‚˜ë¬´ì œí’ˆ(ê°€êµ¬ ì œì™¸)": "C16",
          "í„í”„, ì¢…ì´ ë° ì¢…ì´ì œí’ˆ": "C17",
          "ì¸ì‡„ ë° ê¸°ë¡ë§¤ì²´ ë³µì œì—…": "C18",
          "ì½”í¬ìŠ¤, ì—°íƒ„ ë° ì„ìœ ì •ì œí’ˆ": "C19",
          "í™”í•™ë¬¼ì§ˆ ë° í™”í•™ì œí’ˆ(ì˜ì•½í’ˆ ì œì™¸)": "C20",
          "ì˜ë£Œìš© ë¬¼ì§ˆ ë° ì˜ì•½í’ˆ": "C21",
          "ê³ ë¬´ì œí’ˆ ë° í”Œë¼ìŠ¤í‹±ì œí’ˆ": "C22",
          "ë¹„ê¸ˆì† ê´‘ë¬¼ì œí’ˆ": "C23",
          "1ì°¨ ê¸ˆì†": "C24",
          "ê¸ˆì†ê°€ê³µì œí’ˆ(ê¸°ê³„ ë° ê°€êµ¬ ì œì™¸)": "C25",
          "ì „ìë¶€í’ˆ, ì»´í“¨í„°, ì˜ìƒ, ìŒí–¥ ë° í†µì‹ ì¥ë¹„": "C26",
          "ì˜ë£Œ, ì •ë°€, ê´‘í•™ê¸°ê¸° ë° ì‹œê³„": "C27",
          "ì „ê¸°ì¥ë¹„": "C28",
          "ê¸°íƒ€ ê¸°ê³„ ë° ì¥ë¹„": "C29",
          "ìë™ì°¨ ë° íŠ¸ë ˆì¼ëŸ¬": "C30",
          "ê¸°íƒ€ ìš´ì†¡ì¥ë¹„": "C31",
          "ê°€êµ¬": "C32",
          "ê¸°íƒ€ ì œí’ˆ ì œì¡°ì—…": "C33",
          "ì‚°ì—…ìš©ê¸°ê³„ ë° ì¥ë¹„ìˆ˜ë¦¬ì—…": "C34",
          "ì „ê¸°, ê°€ìŠ¤, ì¦ê¸° ë° ê³µê¸°ì¡°ì ˆ ê³µê¸‰ì—…": "D35",
          "í•˜ìˆ˜Â·íê¸°ë¬¼ ì²˜ë¦¬, ì›ë£Œì¬ìƒ ë° í™˜ê²½ë³µì›ì—…": "E",
          "í•˜ìˆ˜ Â· íê¸°ë¬¼ ì²˜ë¦¬, ì›ë£Œì¬ìƒ ë° í™˜ê²½ë³µì›ì—…": "E",
          "ê±´ì„¤ì—…": "F",
          "ë„ë§¤ ë° ì†Œë§¤ì—…": "G",
          "ë„ì†Œë§¤ì—…": "G",
          "ìš´ìˆ˜ ë° ì°½ê³ ì—…": "H",
          "ìˆ™ë°• ë° ìŒì‹ì ì—…": "I",
          "ì •ë³´í†µì‹ ì—…": "J",
          "ë¶€ë™ì‚°ì—…": "L",
          "ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…": "M",
          "ì‚¬ì—…ì‹œì„¤ê´€ë¦¬ ë° ì‚¬ì—…ì§€ì› ë° ì„ëŒ€ì„œë¹„ìŠ¤ì—…": "N",
          "êµìœ¡ ì„œë¹„ìŠ¤ì—…": "P",
          "ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…": "R"
        };

        // ì€í–‰ê¸°ì¤€ (ê¸°ì¤€í‘œ.xlsx ì€í–‰ê¸°ì¤€ ì‹œíŠ¸)
        const BANK_STANDARDS = {
          "ìœ ë™ë¹„ìœ¨": {
            "ì œì¡°ì—…": 2.0,
            "ë„ì†Œë§¤ì—…": 2.0,
            "ì„œë¹„ìŠ¤ì—…": 2.0,
            "ê±´ì„¤ì—…(ì†Œ)": 3.2
          },
          "ë‹¹ì¢Œë¹„ìœ¨": {
            "ì œì¡°ì—…": 1.5,
            "ë„ì†Œë§¤ì—…": 1.5,
            "ì„œë¹„ìŠ¤ì—…": 1.5,
            "ê±´ì„¤ì—…(ì†Œ)": 2.4
          },
          "ë¶€ì±„ë¹„ìœ¨": {
            "ì œì¡°ì—…": 1.5,
            "ë„ì†Œë§¤ì—…": 1.5,
            "ì„œë¹„ìŠ¤ì—…": 1.5,
            "ê±´ì„¤ì—…(ì†Œ)": 0.6
          },
          "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": {
            "ì œì¡°ì—…": 6.0,
            "ë„ì†Œë§¤ì—…": 8.0,
            "ì„œë¹„ìŠ¤ì—…": 8.0,
            "ê±´ì„¤ì—…(ì†Œ)": 7.0
          },
          "ì˜ì—…ì´ìµìœ¨": {
            "ì œì¡°ì—…": 0.05,
            "ë„ì†Œë§¤ì—…": 0.03,
            "ì„œë¹„ìŠ¤ì—…": 0.07,
            "ê±´ì„¤ì—…(ì†Œ)": 0.04
          },
          "ì´ìë³´ìƒë°°ìˆ˜": {
            "ì œì¡°ì—…": 2.0,
            "ë„ì†Œë§¤ì—…": 2.0,
            "ì„œë¹„ìŠ¤ì—…": 2.0,
            "ê±´ì„¤ì—…(ì†Œ)": 2.0
          }
        };

        // ì€í–‰ê¸°ì¤€ ì—…ì¢… ë§¤í•‘ (ì—…ì¢…ì½”ë“œ â†’ ì€í–‰ê¸°ì¤€ ì—…ì¢…)
        const INDUSTRY_TO_BANK_CATEGORY = {
          // ì œì¡°ì—…
          "C": "ì œì¡°ì—…", "C10": "ì œì¡°ì—…", "C11": "ì œì¡°ì—…", "C13": "ì œì¡°ì—…", "C14": "ì œì¡°ì—…",
          "C15": "ì œì¡°ì—…", "C16": "ì œì¡°ì—…", "C17": "ì œì¡°ì—…", "C18": "ì œì¡°ì—…", "C19": "ì œì¡°ì—…",
          "C20": "ì œì¡°ì—…", "C21": "ì œì¡°ì—…", "C22": "ì œì¡°ì—…", "C23": "ì œì¡°ì—…", "C24": "ì œì¡°ì—…",
          "C25": "ì œì¡°ì—…", "C26": "ì œì¡°ì—…", "C27": "ì œì¡°ì—…", "C28": "ì œì¡°ì—…", "C29": "ì œì¡°ì—…",
          "C30": "ì œì¡°ì—…", "C31": "ì œì¡°ì—…", "C32": "ì œì¡°ì—…", "C33": "ì œì¡°ì—…", "C34": "ì œì¡°ì—…",
          // ë„ì†Œë§¤ì—…
          "G": "ë„ì†Œë§¤ì—…",
          // ì„œë¹„ìŠ¤ì—…
          "H": "ì„œë¹„ìŠ¤ì—…", "I": "ì„œë¹„ìŠ¤ì—…", "J": "ì„œë¹„ìŠ¤ì—…", "L": "ì„œë¹„ìŠ¤ì—…",
          "M": "ì„œë¹„ìŠ¤ì—…", "N": "ì„œë¹„ìŠ¤ì—…", "P": "ì„œë¹„ìŠ¤ì—…", "R": "ì„œë¹„ìŠ¤ì—…",
          "E": "ì„œë¹„ìŠ¤ì—…", "D35": "ì„œë¹„ìŠ¤ì—…",
          // ê±´ì„¤ì—…
          "F": "ê±´ì„¤ì—…(ì†Œ)",
          // ê¸°íƒ€
          "A01": "ì„œë¹„ìŠ¤ì—…", "A03": "ì„œë¹„ìŠ¤ì—…", "B": "ì„œë¹„ìŠ¤ì—…"
        };

        const INDUSTRY_STANDARDS = {"A01": {"code": "A01", "name": "ë†ì—…", "ë¶€ì±„ë¹„ìœ¨": 184.4431714561452, "ì˜ì—…ì´ìµìœ¨": 2.2589772325244417, "ìœ ë™ë¹„ìœ¨": 105.5676046491233, "ë‹¹ì¢Œë¹„ìœ¨": 71.89563814798939, "í˜„ê¸ˆë³´ìœ ìœ¨": 9.043167768544352, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 10.06783839249102, "ì´ìë³´ìƒë°°ìˆ˜": 1.047332646391566, "ìë³¸ì ì‹ë¥ ": -84.34179433346077}, "A03": {"code": "A03", "name": "ì–´ì—…", "ë¶€ì±„ë¹„ìœ¨": 225.03118193747378, "ì˜ì—…ì´ìµìœ¨": 3.618618601041183, "ìœ ë™ë¹„ìœ¨": 125.60557197611779, "ë‹¹ì¢Œë¹„ìœ¨": 78.60614924557206, "í˜„ê¸ˆë³´ìœ ìœ¨": 9.255801484627515, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 12.43099960708413, "ì´ìë³´ìƒë°°ìˆ˜": 2.318991710116658, "ìë³¸ì ì‹ë¥ ": -143.8832068624216}, "B": {"code": "B", "name": "ê´‘ì—…", "ë¶€ì±„ë¹„ìœ¨": 188.62607164555249, "ì˜ì—…ì´ìµìœ¨": 5.29320879928891, "ìœ ë™ë¹„ìœ¨": 123.4318389555429, "ë‹¹ì¢Œë¹„ìœ¨": 103.08371058635551, "í˜„ê¸ˆë³´ìœ ìœ¨": 13.571278986974189, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 6.29280378128743, "ì´ìë³´ìƒë°°ìˆ˜": 1.410723587924491, "ìë³¸ì ì‹ë¥ ": -134.7715120108693}, "C": {"code": "C", "name": "ì œì¡°ì—…", "ë¶€ì±„ë¹„ìœ¨": 117.3851862123823, "ì˜ì—…ì´ìµìœ¨": 4.103939017641511, "ìœ ë™ë¹„ìœ¨": 150.3220571856613, "ë‹¹ì¢Œë¹„ìœ¨": 111.8106454627436, "í˜„ê¸ˆë³´ìœ ìœ¨": 9.274682134584458, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 6.317516654220463, "ì´ìë³´ìƒë°°ìˆ˜": 3.116267293770054, "ìë³¸ì ì‹ë¥ ": -484.0863219797149}, "C10": {"code": "C10", "name": "ì‹ë£Œí’ˆ", "ë¶€ì±„ë¹„ìœ¨": 156.9390869777844, "ì˜ì—…ì´ìµìœ¨": 3.000423204802978, "ìœ ë™ë¹„ìœ¨": 143.5895930206542, "ë‹¹ì¢Œë¹„ìœ¨": 99.21753141797389, "í˜„ê¸ˆë³´ìœ ìœ¨": 5.499339224171439, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 8.820987934841469, "ì´ìë³´ìƒë°°ìˆ˜": 2.826306528103276, "ìë³¸ì ì‹ë¥ ": -310.81811170262796}, "C11": {"code": "C11", "name": "ìŒë£Œ", "ë¶€ì±„ë¹„ìœ¨": 143.26707087152352, "ì˜ì—…ì´ìµìœ¨": 4.366079256877908, "ìœ ë™ë¹„ìœ¨": 103.31336957002739, "ë‹¹ì¢Œë¹„ìœ¨": 75.97870615606384, "í˜„ê¸ˆë³´ìœ ìœ¨": 11.019660192257561, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 8.21151289119507, "ì´ìë³´ìƒë°°ìˆ˜": 2.493655895787515, "ìë³¸ì ì‹ë¥ ": -191.3897429700542}, "C13": {"code": "C13", "name": "ì„¬ìœ ì œí’ˆ(ì˜ë³µì œì™¸)", "ë¶€ì±„ë¹„ìœ¨": 125.30054938511822, "ì˜ì—…ì´ìµìœ¨": 2.951005059322997, "ìœ ë™ë¹„ìœ¨": 142.7705604018905, "ë‹¹ì¢Œë¹„ìœ¨": 102.1886038328296, "í˜„ê¸ˆë³´ìœ ìœ¨": 8.145443384561597, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 5.877658113685044, "ì´ìë³´ìƒë°°ìˆ˜": 2.222428581555256, "ìë³¸ì ì‹ë¥ ": -556.3519712961554}, "C14": {"code": "C14", "name": "ì˜ë³µ, ì˜ë³µì•¡ì„¸ì„œë¦¬ ë° ëª¨í”¼ì œí’ˆ", "ë¶€ì±„ë¹„ìœ¨": 126.2035077217317, "ì˜ì—…ì´ìµìœ¨": 4.643709735188006, "ìœ ë™ë¹„ìœ¨": 165.5415664767813, "ë‹¹ì¢Œë¹„ìœ¨": 100.45829773885859, "í˜„ê¸ˆë³´ìœ ìœ¨": 6.663802366352721, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 8.319842334845974, "ì´ìë³´ìƒë°°ìˆ˜": 5.085869894609246, "ìë³¸ì ì‹ë¥ ": -710.3751067369413}, "C15": {"code": "C15", "name": "ê°€ì£½, ê°€ë°© ë° ì‹ ë°œ", "ë¶€ì±„ë¹„ìœ¨": 109.702747055847, "ì˜ì—…ì´ìµìœ¨": 4.224378845123349, "ìœ ë™ë¹„ìœ¨": 149.1638878804181, "ë‹¹ì¢Œë¹„ìœ¨": 96.73594960601744, "í˜„ê¸ˆë³´ìœ ìœ¨": 6.704221976526235, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 7.413056162849531, "ì´ìë³´ìƒë°°ìˆ˜": 3.614990204851622, "ìë³¸ì ì‹ë¥ ": -623.2818653080295}, "C16": {"code": "C16", "name": "ëª©ì¬ ë° ë‚˜ë¬´ì œí’ˆ(ê°€êµ¬ ì œì™¸)", "ë¶€ì±„ë¹„ìœ¨": 165.284446362311, "ì˜ì—…ì´ìµìœ¨": 3.79157164876402, "ìœ ë™ë¹„ìœ¨": 136.4720145756435, "ë‹¹ì¢Œë¹„ìœ¨": 96.69104706470975, "í˜„ê¸ˆë³´ìœ ìœ¨": 7.255623687759158, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 6.256270734219733, "ì´ìë³´ìƒë°°ìˆ˜": 2.278789219481621, "ìë³¸ì ì‹ë¥ ": -400.58997364044603}, "C17": {"code": "C17", "name": "í„í”„, ì¢…ì´ ë° ì¢…ì´ì œí’ˆ", "ë¶€ì±„ë¹„ìœ¨": 114.7393369700704, "ì˜ì—…ì´ìµìœ¨": 3.226331156471359, "ìœ ë™ë¹„ìœ¨": 141.78187971044142, "ë‹¹ì¢Œë¹„ìœ¨": 107.80227210652168, "í˜„ê¸ˆë³´ìœ ìœ¨": 7.229042673143512, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 6.412524313160723, "ì´ìë³´ìƒë°°ìˆ˜": 2.738451991365182, "ìë³¸ì ì‹ë¥ ": -553.8476055383611}, "C18": {"code": "C18", "name": "ì¸ì‡„ ë° ê¸°ë¡ë§¤ì²´ ë³µì œì—…", "ë¶€ì±„ë¹„ìœ¨": 119.3519079064568, "ì˜ì—…ì´ìµìœ¨": 3.8002624046218654, "ìœ ë™ë¹„ìœ¨": 145.4439060423835, "ë‹¹ì¢Œë¹„ìœ¨": 124.86053201226159, "í˜„ê¸ˆë³´ìœ ìœ¨": 9.602297487882778, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 5.757819797587472, "ì´ìë³´ìƒë°°ìˆ˜": 2.740090635922364, "ìë³¸ì ì‹ë¥ ": -571.6065108283004}, "C19": {"code": "C19", "name": "ì½”í¬ìŠ¤, ì—°íƒ„ ë° ì„ìœ ì •ì œí’ˆ", "ë¶€ì±„ë¹„ìœ¨": 111.32927697085711, "ì˜ì—…ì´ìµìœ¨": 6.1942910649553475, "ìœ ë™ë¹„ìœ¨": 161.2087763795901, "ë‹¹ì¢Œë¹„ìœ¨": 120.3818657474, "í˜„ê¸ˆë³´ìœ ìœ¨": 7.7298990756791435, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 6.389873210410667, "ì´ìë³´ìƒë°°ìˆ˜": 5.454839559116729, "ìë³¸ì ì‹ë¥ ": -485.63619799574866}, "C20": {"code": "C20", "name": "í™”í•™ë¬¼ì§ˆ ë° í™”í•™ì œí’ˆ(ì˜ì•½í’ˆ ì œì™¸)", "ë¶€ì±„ë¹„ìœ¨": 98.3286053148754, "ì˜ì—…ì´ìµìœ¨": 4.888609372669231, "ìœ ë™ë¹„ìœ¨": 158.12195736720972, "ë‹¹ì¢Œë¹„ìœ¨": 117.5545473080315, "í˜„ê¸ˆë³´ìœ ìœ¨": 10.60895350089229, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 6.198174053016959, "ì´ìë³´ìƒë°°ìˆ˜": 3.606751688361959, "ìë³¸ì ì‹ë¥ ": -385.1212931685942}, "C21": {"code": "C21", "name": "ì˜ë£Œìš© ë¬¼ì§ˆ ë° ì˜ì•½í’ˆ", "ë¶€ì±„ë¹„ìœ¨": 72.36742401908346, "ì˜ì—…ì´ìµìœ¨": 2.057524287619698, "ìœ ë™ë¹„ìœ¨": 172.2285387973127, "ë‹¹ì¢Œë¹„ìœ¨": 134.1599442729205, "í˜„ê¸ˆë³´ìœ ìœ¨": 20.67423627758962, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 5.091224456095707, "ì´ìë³´ìƒë°°ìˆ˜": 0.8208350685148829, "ìë³¸ì ì‹ë¥ ": -364.95590147412827}, "C22": {"code": "C22", "name": "ê³ ë¬´ì œí’ˆ ë° í”Œë¼ìŠ¤í‹±ì œí’ˆ", "ë¶€ì±„ë¹„ìœ¨": 117.5472275957983, "ì˜ì—…ì´ìµìœ¨": 3.9788993892578226, "ìœ ë™ë¹„ìœ¨": 144.2377785160981, "ë‹¹ì¢Œë¹„ìœ¨": 111.1181814922657, "í˜„ê¸ˆë³´ìœ ìœ¨": 8.02467668419024, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 6.16603233402604, "ì´ìë³´ìƒë°°ìˆ˜": 3.053948754479489, "ìë³¸ì ì‹ë¥ ": -564.2942778997469}, "C23": {"code": "C23", "name": "ë¹„ê¸ˆì† ê´‘ë¬¼ì œí’ˆ", "ë¶€ì±„ë¹„ìœ¨": 96.06538525103501, "ì˜ì—…ì´ìµìœ¨": 4.707931887688268, "ìœ ë™ë¹„ìœ¨": 156.8079237183427, "ë‹¹ì¢Œë¹„ìœ¨": 127.16347606421789, "í˜„ê¸ˆë³´ìœ ìœ¨": 10.65198672417186, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 6.18800526112472, "ì´ìë³´ìƒë°°ìˆ˜": 3.7058101713719, "ìë³¸ì ì‹ë¥ ": -508.88888888888886}, "C24": {"code": "C24", "name": "1ì°¨ ê¸ˆì†", "ë¶€ì±„ë¹„ìœ¨": 127.8990217538923, "ì˜ì—…ì´ìµìœ¨": 3.566822731223191, "ìœ ë™ë¹„ìœ¨": 141.1155797123173, "ë‹¹ì¢Œë¹„ìœ¨": 97.22248037846038, "í˜„ê¸ˆë³´ìœ ìœ¨": 5.575681140156306, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 7.081535146412791, "ì´ìë³´ìƒë°°ìˆ˜": 3.372392635645316, "ìë³¸ì ì‹ë¥ ": -543.3222005062723}, "C25": {"code": "C25", "name": "ê¸ˆì†ê°€ê³µì œí’ˆ(ê¸°ê³„ ë° ê°€êµ¬ ì œì™¸)", "ë¶€ì±„ë¹„ìœ¨": 130.7598083933355, "ì˜ì—…ì´ìµìœ¨": 4.667010262878215, "ìœ ë™ë¹„ìœ¨": 148.9556261814489, "ë‹¹ì¢Œë¹„ìœ¨": 112.99630295418659, "í˜„ê¸ˆë³´ìœ ìœ¨": 8.343404642165659, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 5.763643963631612, "ì´ìë³´ìƒë°°ìˆ˜": 3.471621969534435, "ìë³¸ì ì‹ë¥ ": -556.0888951989856}, "C26": {"code": "C26", "name": "ì „ìë¶€í’ˆ, ì»´í“¨í„°, ì˜ìƒ, ìŒí–¥ ë° í†µì‹ ì¥ë¹„", "ë¶€ì±„ë¹„ìœ¨": 96.39297495369996, "ì˜ì—…ì´ìµìœ¨": 4.361515386923711, "ìœ ë™ë¹„ìœ¨": 163.379597290228, "ë‹¹ì¢Œë¹„ìœ¨": 125.43005466512169, "í˜„ê¸ˆë³´ìœ ìœ¨": 13.23794540037607, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 6.191460557879541, "ì´ìë³´ìƒë°°ìˆ˜": 3.381731993730871, "ìë³¸ì ì‹ë¥ ": -472.7679322723488}, "C27": {"code": "C27", "name": "ì˜ë£Œ, ì •ë°€, ê´‘í•™ê¸°ê¸° ë° ì‹œê³„", "ë¶€ì±„ë¹„ìœ¨": 94.35052824359006, "ì˜ì—…ì´ìµìœ¨": 6.273828933238739, "ìœ ë™ë¹„ìœ¨": 172.1186248763827, "ë‹¹ì¢Œë¹„ìœ¨": 130.2124037031189, "í˜„ê¸ˆë³´ìœ ìœ¨": 16.94433118368265, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 5.133832486026052, "ì´ìë³´ìƒë°°ìˆ˜": 3.423806915054298, "ìë³¸ì ì‹ë¥ ": -513.9583624156454}, "C28": {"code": "C28", "name": "ì „ê¸°ì¥ë¹„", "ë¶€ì±„ë¹„ìœ¨": 106.307946954542, "ì˜ì—…ì´ìµìœ¨": 3.647741129929739, "ìœ ë™ë¹„ìœ¨": 167.4888435383423, "ë‹¹ì¢Œë¹„ìœ¨": 124.79625881917372, "í˜„ê¸ˆë³´ìœ ìœ¨": 10.69974189488994, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 5.645311962658176, "ì´ìë³´ìƒë°°ìˆ˜": 3.011820210861209, "ìë³¸ì ì‹ë¥ ": -498.0876712897717}, "C29": {"code": "C29", "name": "ê¸°íƒ€ ê¸°ê³„ ë° ì¥ë¹„", "ë¶€ì±„ë¹„ìœ¨": 114.4836089992009, "ì˜ì—…ì´ìµìœ¨": 5.6160589216488, "ìœ ë™ë¹„ìœ¨": 161.28344619645048, "ë‹¹ì¢Œë¹„ìœ¨": 122.11315842020281, "í˜„ê¸ˆë³´ìœ ìœ¨": 11.42602405945777, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 5.304359121112621, "ì´ìë³´ìƒë°°ìˆ˜": 3.970887062091799, "ìë³¸ì ì‹ë¥ ": -604.3206523649337}, "C30": {"code": "C30", "name": "ìë™ì°¨ ë° íŠ¸ë ˆì¼ëŸ¬", "ë¶€ì±„ë¹„ìœ¨": 153.5217090988699, "ì˜ì—…ì´ìµìœ¨": 2.754830237234179, "ìœ ë™ë¹„ìœ¨": 112.04185238368889, "ë‹¹ì¢Œë¹„ìœ¨": 85.0396996478261, "í˜„ê¸ˆë³´ìœ ìœ¨": 6.098666947524839, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 7.160742301703337, "ì´ìë³´ìƒë°°ìˆ˜": 1.968883991576187, "ìë³¸ì ì‹ë¥ ": -444.25499609101485}, "C31": {"code": "C31", "name": "ê¸°íƒ€ ìš´ì†¡ì¥ë¹„", "ë¶€ì±„ë¹„ìœ¨": 156.9826691616131, "ì˜ì—…ì´ìµìœ¨": 2.258353729947184, "ìœ ë™ë¹„ìœ¨": 107.6542543352319, "ë‹¹ì¢Œë¹„ìœ¨": 79.18330701968931, "í˜„ê¸ˆë³´ìœ ìœ¨": 9.609718750002306, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 6.567308027889373, "ì´ìë³´ìƒë°°ìˆ˜": 1.041351707332015, "ìë³¸ì ì‹ë¥ ": -336.6393613898577}, "C32": {"code": "C32", "name": "ê°€êµ¬", "ë¶€ì±„ë¹„ìœ¨": 174.37075768841171, "ì˜ì—…ì´ìµìœ¨": 1.7706594385975278, "ìœ ë™ë¹„ìœ¨": 133.1616280799853, "ë‹¹ì¢Œë¹„ìœ¨": 88.67523866534258, "í˜„ê¸ˆë³´ìœ ìœ¨": 6.142275276657271, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 7.81148823986238, "ì´ìë³´ìƒë°°ìˆ˜": 1.33945887355651, "ìë³¸ì ì‹ë¥ ": -539.9768580109028}, "C33": {"code": "C33", "name": "ê¸°íƒ€ ì œí’ˆ ì œì¡°ì—…", "ë¶€ì±„ë¹„ìœ¨": 122.3053897709665, "ì˜ì—…ì´ìµìœ¨": 4.3967801833112174, "ìœ ë™ë¹„ìœ¨": 169.9676038854275, "ë‹¹ì¢Œë¹„ìœ¨": 122.93197342491831, "í˜„ê¸ˆë³´ìœ ìœ¨": 10.209387247262471, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 7.034374625705071, "ì´ìë³´ìƒë°°ìˆ˜": 3.354075390175453, "ìë³¸ì ì‹ë¥ ": -438.37136356586154}, "C34": {"code": "C34", "name": "ì‚°ì—…ìš©ê¸°ê³„ ë° ì¥ë¹„ìˆ˜ë¦¬ì—…", "ë¶€ì±„ë¹„ìœ¨": 200.3279224427668, "ì˜ì—…ì´ìµìœ¨": 5.053669957735446, "ìœ ë™ë¹„ìœ¨": 128.5005999255265, "ë‹¹ì¢Œë¹„ìœ¨": 113.34799817953629, "í˜„ê¸ˆë³´ìœ ìœ¨": 15.970836597143908, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 6.747496689357154, "ì´ìë³´ìƒë°°ìˆ˜": 5.75927015891701, "ìë³¸ì ì‹ë¥ ": -210.6453199625534}, "D35": {"code": "D35", "name": "ì „ê¸°, ê°€ìŠ¤, ì¦ê¸° ë° ê³µê¸°ì¡°ì ˆ ê³µê¸‰ì—…", "ë¶€ì±„ë¹„ìœ¨": 413.83262725469336, "ì˜ì—…ì´ìµìœ¨": 23.22779693481902, "ìœ ë™ë¹„ìœ¨": 99.30581618966987, "ë‹¹ì¢Œë¹„ìœ¨": 95.48267099038338, "í˜„ê¸ˆë³´ìœ ìœ¨": 39.20290936856815, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 9.456647015350244, "ì´ìë³´ìƒë°°ìˆ˜": 2.004429351422433, "ìë³¸ì ì‹ë¥ ": -32.808678811950934}, "E": {"code": "E", "name": "í•˜ìˆ˜ Â· íê¸°ë¬¼ ì²˜ë¦¬, ì›ë£Œì¬ìƒ ë° í™˜ê²½ë³µì›ì—…", "ë¶€ì±„ë¹„ìœ¨": 111.2146893053596, "ì˜ì—…ì´ìµìœ¨": 6.989877342766645, "ìœ ë™ë¹„ìœ¨": 168.1408373917907, "ë‹¹ì¢Œë¹„ìœ¨": 154.526336156398, "í˜„ê¸ˆë³´ìœ ìœ¨": 11.59462178274286, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 11.52401637596716, "ì´ìë³´ìƒë°°ìˆ˜": 3.876647210554616, "ìë³¸ì ì‹ë¥ ": -323.4634994088255}, "F": {"code": "F", "name": "ê±´ì„¤ì—…", "ë¶€ì±„ë¹„ìœ¨": 113.3381120381528, "ì˜ì—…ì´ìµìœ¨": 3.126827817106049, "ìœ ë™ë¹„ìœ¨": 228.65252033707182, "ë‹¹ì¢Œë¹„ìœ¨": 164.4625194517351, "í˜„ê¸ˆë³´ìœ ìœ¨": 12.25454964286993, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 6.346652507687629, "ì´ìë³´ìƒë°°ìˆ˜": 2.971927082114834, "ìë³¸ì ì‹ë¥ ": -184.8931593751087}, "G": {"code": "G", "name": "ë„ë§¤ ë° ì†Œë§¤ì—…", "ë¶€ì±„ë¹„ìœ¨": 137.1457625864936, "ì˜ì—…ì´ìµìœ¨": 2.660585514821079, "ìœ ë™ë¹„ìœ¨": 157.2781473345182, "ë‹¹ì¢Œë¹„ìœ¨": 117.25671694955719, "í˜„ê¸ˆë³´ìœ ìœ¨": 6.184731162328659, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 8.536766030106959, "ì´ìë³´ìƒë°°ìˆ˜": 4.547037568065791, "ìë³¸ì ì‹ë¥ ": -424.0969306116881}, "H": {"code": "H", "name": "ìš´ìˆ˜ ë° ì°½ê³ ì—…", "ë¶€ì±„ë¹„ìœ¨": 167.1509724213903, "ì˜ì—…ì´ìµìœ¨": 2.589566331416683, "ìœ ë™ë¹„ìœ¨": 117.2364856394418, "ë‹¹ì¢Œë¹„ìœ¨": 113.407176223235, "í˜„ê¸ˆë³´ìœ ìœ¨": 7.914642019605049, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 11.65291427136869, "ì´ìë³´ìƒë°°ìˆ˜": 2.218492775463015, "ìë³¸ì ì‹ë¥ ": -263.59259405523517}, "I": {"code": "I", "name": "ìˆ™ë°• ë° ìŒì‹ì ì—…", "ë¶€ì±„ë¹„ìœ¨": 371.0557792000372, "ì˜ì—…ì´ìµìœ¨": 2.230679632689547, "ìœ ë™ë¹„ìœ¨": 52.241634782108406, "ë‹¹ì¢Œë¹„ìœ¨": 43.5563114268611, "í˜„ê¸ˆë³´ìœ ìœ¨": 10.92672708523629, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 25.31397550358674, "ì´ìë³´ìƒë°°ìˆ˜": 0.6324914293710208, "ìë³¸ì ì‹ë¥ ": -93.25799626400013}, "J": {"code": "J", "name": "ì •ë³´í†µì‹ ì—…", "ë¶€ì±„ë¹„ìœ¨": 124.3198962195365, "ì˜ì—…ì´ìµìœ¨": -2.320574805729054, "ìœ ë™ë¹„ìœ¨": 146.12675591636798, "ë‹¹ì¢Œë¹„ìœ¨": 136.85103974752292, "í˜„ê¸ˆë³´ìœ ìœ¨": 23.46551906479816, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 7.712175193012884, "ì´ìë³´ìƒë°°ìˆ˜": -1.646978320109967, "ìë³¸ì ì‹ë¥ ": -224.3232276436561}, "L": {"code": "L", "name": "ë¶€ë™ì‚°ì—…", "ë¶€ì±„ë¹„ìœ¨": 474.49812858377845, "ì˜ì—…ì´ìµìœ¨": 7.60230485436568, "ìœ ë™ë¹„ìœ¨": 134.1422956947097, "ë‹¹ì¢Œë¹„ìœ¨": 55.213752583516815, "í˜„ê¸ˆë³´ìœ ìœ¨": 28.78973058425403, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 6.736546870565089, "ì´ìë³´ìƒë°°ìˆ˜": 0.7045223322760182, "ìë³¸ì ì‹ë¥ ": -44.04777788423148}, "M": {"code": "M", "name": "ì „ë¬¸, ê³¼í•™ ë° ê¸°ìˆ  ì„œë¹„ìŠ¤ì—…", "ë¶€ì±„ë¹„ìœ¨": 136.4660400475486, "ì˜ì—…ì´ìµìœ¨": 5.198264635710034, "ìœ ë™ë¹„ìœ¨": 134.92661393664528, "ë‹¹ì¢Œë¹„ìœ¨": 124.2474389516276, "í˜„ê¸ˆë³´ìœ ìœ¨": 20.79015810311088, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 8.631390793898861, "ì´ìë³´ìƒë°°ìˆ˜": 2.860274055831316, "ìë³¸ì ì‹ë¥ ": -253.6366187704565}, "N": {"code": "N", "name": "ì‚¬ì—…ì‹œì„¤ê´€ë¦¬ ë° ì‚¬ì—…ì§€ì› ë° ì„ëŒ€ì„œë¹„ìŠ¤ì—…", "ë¶€ì±„ë¹„ìœ¨": 216.3728020808092, "ì˜ì—…ì´ìµìœ¨": 1.771410508965197, "ìœ ë™ë¹„ìœ¨": 118.41612152698899, "ë‹¹ì¢Œë¹„ìœ¨": 109.76394794083899, "í˜„ê¸ˆë³´ìœ ìœ¨": 10.17139695324264, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 12.89135764106071, "ì´ìë³´ìƒë°°ìˆ˜": 1.312669760332937, "ìë³¸ì ì‹ë¥ ": -49.417793765090764}, "P": {"code": "P", "name": "êµìœ¡ ì„œë¹„ìŠ¤ì—…", "ë¶€ì±„ë¹„ìœ¨": 168.09429067160931, "ì˜ì—…ì´ìµìœ¨": 1.3968618735585672, "ìœ ë™ë¹„ìœ¨": 97.32966924974174, "ë‹¹ì¢Œë¹„ìœ¨": 92.54087338777526, "í˜„ê¸ˆë³´ìœ ìœ¨": 15.02433489788718, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 33.43762227589721, "ì´ìë³´ìƒë°°ìˆ˜": 1.099899248946693, "ìë³¸ì ì‹ë¥ ": -177.8798622699685}, "R": {"code": "R", "name": "ì˜ˆìˆ , ìŠ¤í¬ì¸  ë° ì—¬ê°€ê´€ë ¨ ì„œë¹„ìŠ¤ì—…", "ë¶€ì±„ë¹„ìœ¨": 197.5492944023949, "ì˜ì—…ì´ìµìœ¨": 14.19548554442338, "ìœ ë™ë¹„ìœ¨": 51.730785514296315, "ë‹¹ì¢Œë¹„ìœ¨": 48.0069572917087, "í˜„ê¸ˆë³´ìœ ìœ¨": 19.61395756098299, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 32.31736989130943, "ì´ìë³´ìƒë°°ìˆ˜": 2.480800251916856, "ìë³¸ì ì‹ë¥ ": -126.88847256003571}, "ë¹„ì œì¡°ì—…": {"code": "", "name": "ë¹„ì œì¡°ì—…", "ë¶€ì±„ë¹„ìœ¨": 203.63674473262222, "ì˜ì—…ì´ìµìœ¨": 3.1806387763623842, "ìœ ë™ë¹„ìœ¨": 145.7709510524622, "ë‹¹ì¢Œë¹„ìœ¨": 97.09353407971281, "í˜„ê¸ˆë³´ìœ ìœ¨": 11.65630386619346, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 8.257360242379491, "ì´ìë³´ìƒë°°ìˆ˜": 1.745267952582528, "ìë³¸ì ì‹ë¥ ": -166.7114566440411}, "ì „ì‚°ì—…": {"code": "", "name": "ì „ì‚°ì—…", "ë¶€ì±„ë¹„ìœ¨": 171.2716434858539, "ì˜ì—…ì´ìµìœ¨": 3.4911236449944947, "ìœ ë™ë¹„ìœ¨": 146.99875212755168, "ë‹¹ì¢Œë¹„ìœ¨": 101.063927844328, "í˜„ê¸ˆë³´ìœ ìœ¨": 10.85541864420818, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 7.484532848405358, "ì´ìë³´ìƒë°°ìˆ˜": 2.112696477993626, "ìë³¸ì ì‹ë¥ ": -235.0202411779938}, "ì „ì²´": {"code": "", "name": "ì „ì²´", "ë¶€ì±„ë¹„ìœ¨": 171.0905008634964, "ì˜ì—…ì´ìµìœ¨": 3.4911835839529464, "ìœ ë™ë¹„ìœ¨": 147.1026089055733, "ë‹¹ì¢Œë¹„ìœ¨": 101.0984516584234, "í˜„ê¸ˆë³´ìœ ìœ¨": 10.8505356691741, "ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨": 7.478235334570072, "ì´ìë³´ìƒë°°ìˆ˜": 2.114146753534157, "ìë³¸ì ì‹ë¥ ": -235.346766049986}};
        
        let companyInfo = null;
        let evaluationMode = 'bank'; // 'bank', 'industry', 'total'
        let currentFinancialData = null; // í˜„ì¬ ì¬ë¬´ ë°ì´í„° ì €ì¥

        // ì—…ì¢… ë“œë¡­ë‹¤ìš´ ì´ˆê¸°í™”
        function initializeIndustryDropdown() {
            const select = document.getElementById('industryCode');
            INDUSTRIES.forEach(industry => {
                const option = document.createElement('option');
                option.value = industry.code;
                option.textContent = `${industry.code} - ${industry.name}`;
                select.appendChild(option);
            });
        }

        // ê¸°ì—…ì •ë³´ ì œì¶œ
        function submitCompanyInfo() {
            const companyName = document.getElementById('companyName').value.trim();
            const industryCode = document.getElementById('industryCode').value;

            if (!companyName) {
                alert('ê¸°ì—…ëª…ì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            if (!industryCode) {
                alert('ì—…ì¢…ì„ ì„ íƒí•˜ì„¸ìš”.');
                return;
            }

            const industry = INDUSTRIES.find(i => i.code === industryCode);
            
            companyInfo = {
                name: companyName,
                industryCode: industry.code,
                industryName: industry.name
            };

            // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
            localStorage.setItem('currentCompanyInfo', JSON.stringify(companyInfo));

            // ê¸°ì—…ì •ë³´ í™”ë©´ ìˆ¨ê¸°ê³  ë©”ì¸ ì•± í‘œì‹œ
            document.getElementById('companyInfoContainer').style.display = 'none';
            showAppContainer();
        }

        // ê¸°ì—…ì •ë³´ í‘œì‹œ
        function displayCompanyInfo() {
            if (companyInfo) {
                document.getElementById('displayCompanyName').textContent = companyInfo.name;
                document.getElementById('displayIndustryCode').textContent = companyInfo.industryCode;
                document.getElementById('displayIndustry').textContent = companyInfo.industryName;
            }
        }

        // ê¸°ì¡´ showAppContainer í•¨ìˆ˜ ìˆ˜ì •
        function showAppContainerOriginal() {
            document.getElementById('appContainer').style.display = 'block';
            document.getElementById('currentUser').textContent = currentUser;
        }

        function showAppContainer() {
            // ë©”ì¸ ì•± í‘œì‹œ
            document.getElementById('appContainer').style.display = 'block';
            document.getElementById('currentUser').textContent = currentUser;
        }

        let accounts = initializeAccounts();

        // ë¡œê·¸ì¸ ì²˜ë¦¬
        function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value; // trim ì œê±° - ê³µë°±ë„ ë¹„ë°€ë²ˆí˜¸ì¼ ìˆ˜ ìˆìŒ
            const errorDiv = document.getElementById('loginError');

            console.log('=== ë¡œê·¸ì¸ ë””ë²„ê¹… ===');
            console.log('ì…ë ¥ ì•„ì´ë””:', username);
            console.log('ì…ë ¥ ë¹„ë°€ë²ˆí˜¸:', password);
            console.log('ì…ë ¥ ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´:', password.length);
            console.log('ì „ì²´ ê³„ì • ìˆ˜:', Object.keys(accounts).length);

            if (!username || !password) {
                errorDiv.textContent = 'ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.';
                errorDiv.style.display = 'block';
                return;
            }

            const account = accounts[username];
            
            if (!account) {
                console.log('âŒ ê³„ì • ì—†ìŒ:', username);
                console.log('ì¡´ì¬í•˜ëŠ” ê³„ì • ëª©ë¡:', Object.keys(accounts).join(', '));
                errorDiv.textContent = 'ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê³„ì •ì…ë‹ˆë‹¤.';
                errorDiv.style.display = 'block';
                return;
            }

            console.log('âœ“ ê³„ì • ì¡´ì¬:', username);
            console.log('ì €ì¥ëœ ë¹„ë°€ë²ˆí˜¸:', account.password);
            console.log('ì €ì¥ëœ ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´:', account.password.length);
            console.log('ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜:', account.password === password);
            
            // ë¬¸ì ë¹„êµ
            if (account.password !== password) {
                console.log('âŒ ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜');
                console.log('ì…ë ¥:', [...password].map(c => c.charCodeAt(0)));
                console.log('ì €ì¥:', [...account.password].map(c => c.charCodeAt(0)));
                errorDiv.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.';
                errorDiv.style.display = 'block';
                return;
            }

            // ë¡œê·¸ì¸ ì„±ê³µ
            console.log('âœ“ ë¡œê·¸ì¸ ì„±ê³µ:', username);
            currentUser = username;
            account.viewCount++;
            account.lastLogin = new Date().toISOString();
            localStorage.setItem('accounts', JSON.stringify(accounts));

            document.getElementById('loginContainer').style.display = 'none';
            errorDiv.style.display = 'none';

            if (account.isAdmin) {
                showAdminPanel();
            } else {
                // ê¸°ì—…ì •ë³´ ì…ë ¥ í™”ë©´ ì—†ì´ ë°”ë¡œ ì•± í™”ë©´ìœ¼ë¡œ
                showAppContainer();
            }
        }

        // ë¡œê·¸ì•„ì›ƒ
        function logout() {
            currentUser = null;
            companyInfo = null;
            localStorage.removeItem('currentCompanyInfo');
            document.getElementById('loginContainer').style.display = 'flex';
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('appContainer').style.display = 'none';
            document.getElementById('diagnosisInfoBox').style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('loginError').style.display = 'none';
        }

        // ê´€ë¦¬ì íŒ¨ë„ í‘œì‹œ
        function showAdminPanel() {
            document.getElementById('adminPanel').style.display = 'block';
            updateAccountsTable();
        }

        // ì•± ì»¨í…Œì´ë„ˆ í‘œì‹œ
        function showAppContainer() {
            document.getElementById('appContainer').style.display = 'block';
            document.getElementById('currentUser').textContent = currentUser;
        }

        // ê³„ì • í…Œì´ë¸” ì—…ë°ì´íŠ¸
        function updateAccountsTable() {
            const tbody = document.getElementById('accountsTableBody');
            const sortedAccounts = Object.entries(accounts)
                .filter(([username]) => username !== 'admin')
                .sort((a, b) => a[0].localeCompare(b[0]));

            let html = '';
            sortedAccounts.forEach(([username, data]) => {
                const lastLogin = data.lastLogin ? new Date(data.lastLogin).toLocaleString('ko-KR') : 'ì ‘ì† ê¸°ë¡ ì—†ìŒ';
                html += `
                    <tr>
                        <td style="font-weight: 600;">${username}</td>
                        <td>${data.viewCount}íšŒ</td>
                        <td style="font-size: 0.9rem;">${lastLogin}</td>
                        <td><button class="delete-button" onclick="deleteAccount('${username}')">ì‚­ì œ</button></td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        // ê³„ì • ì¶”ê°€
        function addAccount() {
            const username = document.getElementById('newUsername').value.trim();
            const password = document.getElementById('newPassword').value;

            if (!username || !password) {
                alert('ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            if (accounts[username]) {
                alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì•„ì´ë””ì…ë‹ˆë‹¤.');
                return;
            }

            accounts[username] = {
                password: password,
                isAdmin: false,
                viewCount: 0,
                lastLogin: null
            };

            localStorage.setItem('accounts', JSON.stringify(accounts));
            document.getElementById('newUsername').value = '';
            document.getElementById('newPassword').value = '';
            updateAccountsTable();
            alert('ê³„ì •ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        // ê³„ì • ì‚­ì œ
        function deleteAccount(username) {
            if (confirm(`ì •ë§ë¡œ '${username}' ê³„ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                delete accounts[username];
                localStorage.setItem('accounts', JSON.stringify(accounts));
                updateAccountsTable();
                alert('ê³„ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // Enter í‚¤ë¡œ ë¡œê·¸ì¸ ë° íŒŒì¼ ì—…ë¡œë“œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('password').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') login();
            });

            // íŒŒì¼ ì—…ë¡œë“œ ì´ë²¤íŠ¸
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');

            uploadArea.addEventListener('click', () => fileInput.click());
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = '#1e3a5f';
            });
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.style.borderColor = '#2874a6';
            });
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = '#2874a6';
                if (e.dataTransfer.files.length > 0) handleFile(e.dataTransfer.files[0]);
            });

            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) handleFile(e.target.files[0]);
            });
        });

        // ì´í•˜ ê¸°ì¡´ ì¬ë¬´ë¶„ì„ ê¸°ëŠ¥ ì½”ë“œ

        function handleFile(file) {
            if (!file.name.match(/\.(xlsx|xls)$/i)) {
                alert('ì—‘ì…€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                return;
            }

            document.getElementById('fileName').textContent = file.name;
            document.getElementById('fileSize').textContent = formatFileSize(file.size);
            document.getElementById('selectedFile').classList.add('show');

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    extractFinancialData(workbook);
                } catch (error) {
                    alert('íŒŒì¼ ì½ê¸° ì˜¤ë¥˜: ' + error.message);
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function extractFinancialData(workbook) {
            try {
                const sheet = workbook.Sheets['ì¬ë¬´ì§€í‘œ(ë¶„ì„)(ë³€í˜•)'];
                if (!sheet) {
                    alert('ì¬ë¬´ì§€í‘œ(ë¶„ì„)(ë³€í˜•) ì‹œíŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                console.log('ì—‘ì…€ ì‹œíŠ¸ ë¡œë“œ ì„±ê³µ');

                // ê¸°ì—…ëª… ì¶”ì¶œ (D3)
                const companyNameCell = sheet['D3'];
                const companyName = companyNameCell ? companyNameCell.v : '(ê¸°ì—…ëª… ì—†ìŒ)';
                
                // ì—…ì¢…ëª… ì¶”ì¶œ (K5 - ì—…ì¢…ëª…ì´ ì§ì ‘ ì…ë ¥ë˜ì–´ ìˆìŒ)
                const industryNameCell = sheet['K5'];
                const industryNameFromExcel = industryNameCell ? String(industryNameCell.v).trim() : null;
                
                console.log('ê¸°ì—…ëª…:', companyName);
                console.log('ì—…ì¢…ëª… (K5):', industryNameFromExcel);
                
                // ì—…ì¢…ëª…ìœ¼ë¡œ ì—…ì¢…ì½”ë“œ ì°¾ê¸°
                let industryName = 'ì „ì²´';
                let finalIndustryCode = 'ì „ì²´';
                
                if (industryNameFromExcel) {
                    // 1ì°¨: INDUSTRY_CODE_MAPì—ì„œ ì§ì ‘ ë§¤ì¹­ (ê°€ì¥ ì •í™•)
                    if (INDUSTRY_CODE_MAP[industryNameFromExcel]) {
                        finalIndustryCode = INDUSTRY_CODE_MAP[industryNameFromExcel];
                        // INDUSTRIES ë°°ì—´ì—ì„œ ì •í™•í•œ ì´ë¦„ ì°¾ê¸°
                        const industry = INDUSTRIES.find(ind => ind.code === finalIndustryCode);
                        if (industry) {
                            industryName = industry.name;
                        } else {
                            industryName = industryNameFromExcel;
                        }
                    } 
                    // 2ì°¨: INDUSTRIES ë°°ì—´ì—ì„œ ë¶€ë¶„ ë§¤ì¹­
                    else {
                        const industry = INDUSTRIES.find(ind => 
                            ind.name === industryNameFromExcel || 
                            ind.name.includes(industryNameFromExcel) || 
                            industryNameFromExcel.includes(ind.name)
                        );
                        if (industry) {
                            finalIndustryCode = industry.code;
                            industryName = industry.name;
                        } else {
                            // 3ì°¨: INDUSTRY_STANDARDSì—ì„œ ì°¾ê¸°
                            industryName = industryNameFromExcel;
                            for (const [code, data] of Object.entries(INDUSTRY_STANDARDS)) {
                                if (data.name === industryNameFromExcel || 
                                    data.name.includes(industryNameFromExcel) || 
                                    industryNameFromExcel.includes(data.name)) {
                                    finalIndustryCode = code;
                                    industryName = data.name;
                                    break;
                                }
                            }
                        }
                    }
                    
                    console.log('ìµœì¢… ì—…ì¢…ì½”ë“œ:', finalIndustryCode);
                    console.log('ìµœì¢… ì—…ì¢…ëª…:', industryName);
                }
                
                // companyInfo ì „ì—­ ë³€ìˆ˜ì— ì €ì¥
                companyInfo = {
                    name: companyName,
                    industryCode: finalIndustryCode,
                    industryName: industryName
                };
                
                // localStorageì— ì €ì¥
                localStorage.setItem('currentCompanyInfo', JSON.stringify(companyInfo));
                
                // ìš°ì¸¡ íŒ¨ë„ ì§„ë‹¨ ì •ë³´ ë°•ìŠ¤ í‘œì‹œ
                document.getElementById('diagCompanyName').textContent = companyName;
                document.getElementById('diagIndustry').textContent = `${finalIndustryCode} - ${industryName}`;
                document.getElementById('diagConsultant').textContent = currentUser || 'ë¯¸ì§€ì •';
                document.getElementById('diagnosisInfoBox').style.display = 'block';
                
                console.log('ê¸°ì—…ì •ë³´ ì„¤ì • ì™„ë£Œ:', companyInfo);

                // ì…€ ì°¸ì¡° í•¨ìˆ˜ (1-based í–‰/ì—´ ë²ˆí˜¸)
                function getCell(row, col) {
                    const colLetter = String.fromCharCode(64 + col); // 1->A, 2->B, ...
                    const cellRef = colLetter + row;
                    const cell = sheet[cellRef];
                    
                    if (!cell || cell.v === null || cell.v === undefined || cell.v === '') {
                        return 0;
                    }
                    
                    const value = parseFloat(cell.v);
                    return isNaN(value) ? 0 : value;
                }

                // ë°ì´í„° ë§¤í•‘
                const mapping = {
                    // ì¬ë¬´ìƒíƒœí‘œ
                    'asset': 8, 'current_asset': 9, 'quick_asset': 10, 'cash': 11,
                    'provisional_payment': 12, 'receivable': 13, 'short_loan': 14,
                    'accrued_income': 15, 'inventory': 16, 'long_loan': 17,
                    'tangible_asset': 18, 'intangible_asset': 19, 'noncurrent_asset': 20,
                    'liability': 21, 'current_liability': 22, 'payable': 23,
                    'provisional_receipt': 24, 'short_borrowing': 25, 'long_borrowing': 26,
                    'equity': 27, 'capital': 28, 'retained_earnings': 29, 'net_income_bs': 30,
                    // ì†ìµê³„ì‚°ì„œ
                    'revenue': 35, 'gross_profit': 36, 'operating_expense': 37,
                    'operating_income': 38, 'interest_expense': 39, 'pretax_income': 40,
                    'tax_expense': 41, 'net_income': 42
                };

                // ë…„ë„ë³„ ì—´ (E=5, F=6, G=7)
                const yearCols = {2022: 5, 2023: 6, 2024: 7};

                // ë°ì´í„° ì¶”ì¶œ ë° ì…ë ¥ í•„ë“œ ì±„ìš°ê¸°
                for (const [year, col] of Object.entries(yearCols)) {
                    for (const [field, row] of Object.entries(mapping)) {
                        const value = getCell(row, col);
                        const inputId = `${field}_${year}`;
                        const inputElement = document.getElementById(inputId);
                        
                        if (inputElement) {
                            inputElement.value = value || '';
                        }
                    }
                }

                console.log('ë°ì´í„° ì¶”ì¶œ ë° ì…ë ¥ ì™„ë£Œ');

                // ê³„ì‚° ì‹¤í–‰
                calculate();

                // íŒŒì¼ëª… í‘œì‹œ
                document.getElementById('selectedFile').classList.add('show');

            } catch (error) {
                console.error('extractFinancialData ì˜¤ë¥˜:', error);
                alert('ë°ì´í„° ì¶”ì¶œ ì˜¤ë¥˜: ' + error.message);
            }
        }



        function removeFile() {
            fileInput.value = '';
            document.getElementById('selectedFile').classList.remove('show');
            
            // ëª¨ë“  ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            const years = [2022, 2023, 2024];
            const allInputs = document.querySelectorAll('.year-input');
            allInputs.forEach(input => {
                input.value = '';
            });
            
            calculate();
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }

        function getValue(id) {
            const element = document.getElementById(id);
            if (!element) return 0;
            const val = element.value;
            if (!val || val === '' || val === null || val === undefined) return 0;
            const parsed = parseFloat(val);
            return isNaN(parsed) ? 0 : parsed;
        }

        function calculate() {
            const years = [2022, 2023, 2024];
            const results = {};

            years.forEach(year => {
                const currentAsset = getValue(`current_asset_${year}`);
                const quickAsset = getValue(`quick_asset_${year}`);
                const cash = getValue(`cash_${year}`);
                const receivable = getValue(`receivable_${year}`);
                const currentLiability = getValue(`current_liability_${year}`);
                const liability = getValue(`liability_${year}`);
                const equity = getValue(`equity_${year}`);
                const revenue = getValue(`revenue_${year}`);
                const operatingIncome = getValue(`operating_income_${year}`);
                const interestExpense = getValue(`interest_expense_${year}`);

                // ì•ˆì „í•œ ê³„ì‚° (0ìœ¼ë¡œ ë‚˜ëˆ„ê¸° ë°©ì§€)
                const safeDiv = (a, b) => (b !== 0 && !isNaN(b)) ? a / b : 0;
                
                results[year] = {
                    ìœ ë™ë¹„ìœ¨: safeDiv(currentAsset, currentLiability) * 100,
                    ë‹¹ì¢Œë¹„ìœ¨: safeDiv(quickAsset, currentLiability) * 100,
                    ë¶€ì±„ë¹„ìœ¨: safeDiv(liability, equity) * 100,
                    ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨: safeDiv(revenue, receivable),
                    ì˜ì—…ì´ìµìœ¨: safeDiv(operatingIncome, revenue) * 100,
                    ì´ìë³´ìƒë°°ìˆ˜: safeDiv(operatingIncome, (interestExpense || 1)),
                    í˜„ê¸ˆë³´ìœ ìœ¨: safeDiv(cash, revenue) * 100,
                    ìë³¸ì ì‹ë¥ : equity < 0 ? Math.abs(safeDiv(equity, (liability + equity)) * 100) : 0
                };
            });

            displayResults(results);
            generateConsultantComment(results);
        }

        function displayResults(results) {
            // í˜„ì¬ ì¬ë¬´ ë°ì´í„° ì €ì¥
            currentFinancialData = results;
            
            // í˜„ì¬ ì„ íƒëœ ì—…ì¢…
            const industryCode = companyInfo?.industryCode || 'ì „ì²´';
            
            const standards = {
                ìœ ë™ë¹„ìœ¨: { higher: true, unit: '%' },
                ë‹¹ì¢Œë¹„ìœ¨: { higher: true, unit: '%' },
                ë¶€ì±„ë¹„ìœ¨: { higher: false, unit: '%' },
                ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨: { higher: true, unit: 'íšŒ' },
                ì˜ì—…ì´ìµìœ¨: { higher: true, unit: '%' },
                ì´ìë³´ìƒë°°ìˆ˜: { higher: true, unit: 'ë°°' },
                í˜„ê¸ˆë³´ìœ ìœ¨: { higher: true, unit: '%' },
                ìë³¸ì ì‹ë¥ : { higher: false, unit: '%' }
            };

            let html = '';
            
            for (const [metric, standard] of Object.entries(standards)) {
                const val2022 = isNaN(results[2022][metric]) ? 0 : (results[2022][metric] || 0);
                const val2023 = isNaN(results[2023][metric]) ? 0 : (results[2023][metric] || 0);
                const val2024 = isNaN(results[2024][metric]) ? 0 : (results[2024][metric] || 0);

                // í˜„ì¬ í‰ê°€ ëª¨ë“œì— ë”°ë¥¸ ê¸°ì¤€ê°’
                const standardValue = getStandardValue(metric, industryCode, evaluationMode);
                
                const judgment2022 = getJudgmentText(val2022, standardValue, standard.higher);
                const judgment2023 = getJudgmentText(val2023, standardValue, standard.higher);
                const judgment2024 = getJudgmentText(val2024, standardValue, standard.higher);

                // ëª¨ë“œë³„ ë¼ë²¨
                const modeLabels = {
                    'bank': 'ğŸ¦ ì€í–‰ê¸°ì¤€',
                    'industry': 'ğŸ­ ì—…ì¢…ê¸°ì¤€',
                    'total': 'ğŸ“Š í†µí•©ê¸°ì¤€'
                };

                html += `
                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-title">${metric}</div>
                            <div class="metric-standards">
                                <div class="standard-item"><span class="standard-label">${modeLabels[evaluationMode]}:</span> ${standardValue.toFixed(1)}${standard.unit}</div>
                            </div>
                        </div>
                        <div class="metric-years">
                            <div class="year-column">
                                <div class="year-label">2022ë…„</div>
                                <div class="year-value-large">${val2022.toFixed(metric === 'ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨' ? 1 : 2)}${standard.unit}</div>
                                <div class="year-judgment judgment-${judgment2022.class}">${judgment2022.text}</div>
                            </div>
                            <div class="year-column">
                                <div class="year-label">2023ë…„</div>
                                <div class="year-value-large">${val2023.toFixed(metric === 'ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨' ? 1 : 2)}${standard.unit}</div>
                                <div class="year-judgment judgment-${judgment2023.class}">${judgment2023.text}</div>
                            </div>
                            <div class="year-column">
                                <div class="year-label">2024ë…„</div>
                                <div class="year-value-large">${val2024.toFixed(metric === 'ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨' ? 1 : 2)}${standard.unit}</div>
                                <div class="year-judgment judgment-${judgment2024.class}">${judgment2024.text}</div>
                            </div>
                        </div>
                    </div>
                `;
            }

            document.getElementById('metricsResults').innerHTML = html;

            [2022, 2023, 2024].forEach(year => {
                const score = calculateScore(results[year], standards);
                const grade = getGrade(score);
            });

        }

        function getJudgmentText(value, standard, higherIsBetter) {
            let judgment;
            if (higherIsBetter) {
                if (value >= standard * 1.2) judgment = { text: 'ìš°ìˆ˜', class: 'excellent' };
                else if (value >= standard * 0.8) judgment = { text: 'ì–‘í˜¸', class: 'good' };
                else judgment = { text: 'ë¯¸ë‹¬', class: 'poor' };
            } else {
                if (value <= standard * 0.8) judgment = { text: 'ìš°ìˆ˜', class: 'excellent' };
                else if (value <= standard * 1.2) judgment = { text: 'ì–‘í˜¸', class: 'good' };
                else judgment = { text: 'ë¯¸ë‹¬', class: 'poor' };
            }
            return judgment;
        }

        // í‰ê°€ ê¸°ì¤€ê°’ ê°€ì ¸ì˜¤ê¸°
        function getStandardValue(metric, industryCode, mode) {
            mode = mode || evaluationMode;
            
            if (mode === 'bank') {
                // ì€í–‰ê¸°ì¤€
                const bankCategory = INDUSTRY_TO_BANK_CATEGORY[industryCode] || 'ì œì¡°ì—…';
                const bankValue = BANK_STANDARDS[metric]?.[bankCategory];
                if (bankValue !== undefined) {
                    // ë¹„ìœ¨ì„ í¼ì„¼íŠ¸ë¡œ ë³€í™˜
                    if (metric === 'ìœ ë™ë¹„ìœ¨' || metric === 'ë‹¹ì¢Œë¹„ìœ¨' || metric === 'ë¶€ì±„ë¹„ìœ¨') {
                        return bankValue * 100;
                    } else if (metric === 'ì˜ì—…ì´ìµìœ¨') {
                        return bankValue * 100;
                    }
                    return bankValue;
                }
            } else if (mode === 'industry') {
                // ì—…ì¢…ê¸°ì¤€ (ì´ë¯¸ í¼ì„¼íŠ¸ë¡œ ì €ì¥ë˜ì–´ ìˆìŒ)
                const industryStd = INDUSTRY_STANDARDS[industryCode];
                if (industryStd) {
                    const value = industryStd[metric];
                    if (value !== undefined) {
                        // INDUSTRY_STANDARDSëŠ” ì´ë¯¸ í¼ì„¼íŠ¸ ë‹¨ìœ„ì´ë¯€ë¡œ ë³€í™˜ ë¶ˆí•„ìš”
                        return value;
                    }
                }
            } else if (mode === 'total') {
                // í†µí•©ê¸°ì¤€ (ì „ì²´ í‰ê·  - ì´ë¯¸ í¼ì„¼íŠ¸ë¡œ ì €ì¥ë˜ì–´ ìˆìŒ)
                const totalStd = INDUSTRY_STANDARDS['ì „ì²´'];
                if (totalStd) {
                    const value = totalStd[metric];
                    if (value !== undefined) {
                        // INDUSTRY_STANDARDSëŠ” ì´ë¯¸ í¼ì„¼íŠ¸ ë‹¨ìœ„ì´ë¯€ë¡œ ë³€í™˜ ë¶ˆí•„ìš”
                        return value;
                    }
                }
            }
            
            // ê¸°ë³¸ê°’
            return 100;
        }

        // í‰ê°€ ëª¨ë“œ ì „í™˜
        function switchEvaluationMode(mode) {
            evaluationMode = mode;
            
            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            const buttons = {
                'bank': document.getElementById('btnBankMode'),
                'industry': document.getElementById('btnIndustryMode'),
                'total': document.getElementById('btnTotalMode')
            };
            
            // ëª¨ë“œë³„ ì´ë¦„
            const modeNames = {
                'bank': 'ğŸ¦ ì€í–‰ê¸°ì¤€',
                'industry': 'ğŸ­ ì—…ì¢…ê¸°ì¤€',
                'total': 'ğŸ“Š í†µí•©ê¸°ì¤€'
            };
            
            // ëª¨ë“  ë²„íŠ¼ ë¹„í™œì„± ìŠ¤íƒ€ì¼
            Object.values(buttons).forEach(btn => {
                btn.style.background = 'rgba(255,255,255,0.25)';
                btn.style.color = 'white';
                btn.style.border = '2px solid rgba(255,255,255,0.4)';
                btn.style.boxShadow = 'none';
            });
            
            // ì„ íƒëœ ë²„íŠ¼ í™œì„± ìŠ¤íƒ€ì¼
            buttons[mode].style.background = 'white';
            buttons[mode].style.color = '#667eea';
            buttons[mode].style.border = 'none';
            buttons[mode].style.boxShadow = '0 3px 8px rgba(0,0,0,0.15)';
            
            // ì¸ì‡„ìš© í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            document.getElementById('currentModeName').textContent = modeNames[mode];
            
            // ì¬ë¬´ ë°ì´í„° ì¬ê³„ì‚°
            if (currentFinancialData) {
                displayResults(currentFinancialData);
                // ì»¨ì„¤í„´íŠ¸ ì œì•ˆë„ ì¬ìƒì„± (í‰ê°€ ëª¨ë“œì— ë”°ë¼ ë‹¤ë¥¸ ë‚´ìš©)
                generateConsultantComment(currentFinancialData);
            }
        }
        
        // ì¬ë¬´ì§€í‘œ ë‹¤ì‹œ í‘œì‹œ (í‰ê°€ ëª¨ë“œ ì „í™˜ ì‹œ ì‚¬ìš©)
        function displayFinancialMetrics(results) {
            displayResults(results);
        }

        function calculateScore(yearData, standards) {
            let total = 0;
            let count = 0;

            for (const [metric, standard] of Object.entries(standards)) {
                const value = isNaN(yearData[metric]) ? 0 : (yearData[metric] || 0);
                if (standard.higher) {
                    const diff = ((value - standard.value) / standard.value) * 100;
                    total += Math.max(0, Math.min(100, 50 + diff * 0.5));
                } else {
                    const diff = ((standard.value - value) / standard.value) * 100;
                    total += Math.max(0, Math.min(100, 50 + diff * 0.5));
                }
                count++;
            }

            return Math.round(total / count);
        }

        function getGrade(score) {
            if (score >= 80) return 'ìš°ìˆ˜';
            if (score >= 60) return 'ì–‘í˜¸';
            if (score >= 40) return 'ë³´í†µ';
            return 'ê°œì„ í•„ìš”';
        }

        function generateConsultantComment(results) {
            const latest = results[2024];
            const prev = results[2023];
            const prev2 = results[2022];
            const industryCode = companyInfo?.industryCode || 'ì „ì²´';
            const industryName = companyInfo?.industryName || 'ì „ì²´';

            const hasData = latest.ìœ ë™ë¹„ìœ¨ > 0 || latest.ë¶€ì±„ë¹„ìœ¨ > 0 || latest.ì˜ì—…ì´ìµìœ¨ !== 0;
            
            if (!hasData) {
                document.getElementById('consultantSection').style.display = 'none';
                return;
            }

            document.getElementById('consultantSection').style.display = 'block';

            // í‰ê°€ ëª¨ë“œë³„ ìš°ìˆ˜/ì–‘í˜¸ ì¹´ìš´íŠ¸
            const evaluationResults = {};
            ['bank', 'industry', 'total'].forEach(mode => {
                evaluationResults[mode] = {
                    excellent: 0,
                    good: 0,
                    poor: 0
                };
                
                const metrics = ['ìœ ë™ë¹„ìœ¨', 'ë‹¹ì¢Œë¹„ìœ¨', 'ë¶€ì±„ë¹„ìœ¨', 'ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨', 'ì˜ì—…ì´ìµìœ¨', 'ì´ìë³´ìƒë°°ìˆ˜', 'í˜„ê¸ˆë³´ìœ ìœ¨'];
                metrics.forEach(metric => {
                    const standardValue = getStandardValue(metric, industryCode, mode);
                    const higherIsBetter = metric !== 'ë¶€ì±„ë¹„ìœ¨' && metric !== 'ìë³¸ì ì‹ë¥ ';
                    const judgment = getJudgmentText(latest[metric], standardValue, higherIsBetter);
                    
                    if (judgment.class === 'excellent') evaluationResults[mode].excellent++;
                    else if (judgment.class === 'good') evaluationResults[mode].good++;
                    else evaluationResults[mode].poor++;
                });
            });

            // í˜„ì¬ í‰ê°€ ëª¨ë“œì˜ ê²°ê³¼
            const currentResults = evaluationResults[evaluationMode];
            
            // ===========================================
            // 1. ì¢…í•© ì§„ë‹¨ ì˜ê²¬
            // ===========================================
            let comprehensiveAnalysis = '<div class="comment-section" style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-left: 5px solid #0284c7; padding: 25px;">';
            comprehensiveAnalysis += '<h4 style="color: #0369a1; font-size: 18px; margin-bottom: 18px;">ğŸ“‹ ì¢…í•© ì§„ë‹¨ ì˜ê²¬</h4>';
            
            comprehensiveAnalysis += `<div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">`;
            comprehensiveAnalysis += `<p style="font-size: 15px; line-height: 1.8; color: #1e293b; margin-bottom: 15px;"><strong>${companyInfo.name}</strong>ì˜ 2024ë…„ ì¬ë¬´ìƒíƒœë¥¼ <strong style="color: #0284c7;">${industryName}</strong> ì—…ì¢… íŠ¹ì„±ì„ ê³ ë ¤í•˜ì—¬ ì¢…í•© ë¶„ì„í•œ ê²°ê³¼ì…ë‹ˆë‹¤.</p>`;
            
            // í‰ê°€ ëª¨ë“œë³„ ê²°ê³¼ ìš”ì•½
            const modeNames = { 'bank': 'ì€í–‰ê¸°ì¤€', 'industry': 'ì—…ì¢…ê¸°ì¤€', 'total': 'í†µí•©ê¸°ì¤€' };
            comprehensiveAnalysis += `<div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">`;
            comprehensiveAnalysis += `<p style="font-weight: 600; color: #334155; margin-bottom: 12px;">ğŸ“Š í˜„ì¬ ì ìš© ê¸°ì¤€: <span style="color: #0284c7;">${modeNames[evaluationMode]}</span></p>`;
            comprehensiveAnalysis += `<div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; text-align: center;">`;
            comprehensiveAnalysis += `<div style="background: white; padding: 12px; border-radius: 6px;"><div style="font-size: 13px; color: #64748b; margin-bottom: 4px;">ìš°ìˆ˜</div><div style="font-size: 22px; font-weight: 700; color: #16a34a;">${currentResults.excellent}ê°œ</div></div>`;
            comprehensiveAnalysis += `<div style="background: white; padding: 12px; border-radius: 6px;"><div style="font-size: 13px; color: #64748b; margin-bottom: 4px;">ì–‘í˜¸</div><div style="font-size: 22px; font-weight: 700; color: #eab308;">${currentResults.good}ê°œ</div></div>`;
            comprehensiveAnalysis += `<div style="background: white; padding: 12px; border-radius: 6px;"><div style="font-size: 13px; color: #64748b; margin-bottom: 4px;">ë¯¸ë‹¬</div><div style="font-size: 22px; font-weight: 700; color: #dc2626;">${currentResults.poor}ê°œ</div></div>`;
            comprehensiveAnalysis += `</div></div>`;
            
            // ì¢…í•© í‰ê°€
            let overallGrade = '';
            let overallComment = '';
            const totalScore = currentResults.excellent * 3 + currentResults.good * 2 + currentResults.poor * 0;
            
            // í‰ê°€ ëª¨ë“œë³„ ë§ì¶¤í˜• ì½”ë©˜íŠ¸
            let modeSpecificComment = '';
            if (evaluationMode === 'bank') {
                if (totalScore >= 18) {
                    modeSpecificComment = ' ì€í–‰ ëŒ€ì¶œ ì‹¬ì‚¬ ì‹œ ìµœìƒìœ„ ë“±ê¸‰ìœ¼ë¡œ í‰ê°€ë°›ì„ ìˆ˜ ìˆìœ¼ë©°, ì‹œì¤‘ì€í–‰ ìš°ëŒ€ê¸ˆë¦¬ ì ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.';
                } else if (totalScore >= 12) {
                    modeSpecificComment = ' ì€í–‰ ëŒ€ì¶œ ìŠ¹ì¸ ê°€ëŠ¥ì„±ì´ ë†’ìœ¼ë‚˜, ì¼ë¶€ ì§€í‘œ ê°œì„  ì‹œ ë” ìœ ë¦¬í•œ ì¡°ê±´ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
                } else if (totalScore >= 7) {
                    modeSpecificComment = ' ì€í–‰ ëŒ€ì¶œ ì‹œ ë‹´ë³´ë‚˜ ë³´ì¦ì´ í•„ìš”í•  ìˆ˜ ìˆìœ¼ë©°, ì •ì±…ìê¸ˆ ë³‘í–‰ì„ ê¶Œì¥í•©ë‹ˆë‹¤.';
                } else {
                    modeSpecificComment = ' ì€í–‰ ëŒ€ì¶œì´ ì–´ë ¤ìš¸ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì •ì±…ìê¸ˆ ë° ë³´ì¦ë¶€ ëŒ€ì¶œì„ ìš°ì„  ê²€í† í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.';
                }
            } else if (evaluationMode === 'industry') {
                if (totalScore >= 18) {
                    modeSpecificComment = ` ${industryName} ì—…ì¢… ë‚´ì—ì„œ ìƒìœ„ê¶Œ ì¬ë¬´êµ¬ì¡°ë¥¼ ë³´ìœ í•˜ê³  ìˆì–´ ì •ì±…ìê¸ˆ ìš°ëŒ€ ëŒ€ìƒì…ë‹ˆë‹¤.`;
                } else if (totalScore >= 12) {
                    modeSpecificComment = ` ${industryName} ì—…ì¢… í‰ê· ë³´ë‹¤ ì–‘í˜¸í•œ ìˆ˜ì¤€ì´ë©°, ì¤‘ì§„ê³µÂ·ì‹ ë³´ ë“± ì •ì±…ìê¸ˆ ì‹ ì²­ ì‹œ ìœ ë¦¬í•©ë‹ˆë‹¤.`;
                } else if (totalScore >= 7) {
                    modeSpecificComment = ` ${industryName} ì—…ì¢… í‰ê·  ìˆ˜ì¤€ì´ë‚˜, ì •ì±…ìê¸ˆ ì§€ì› ëŒ€ìƒìœ¼ë¡œ ì í•©í•©ë‹ˆë‹¤.`;
                } else {
                    modeSpecificComment = ` ${industryName} ì—…ì¢… í‰ê·  ëŒ€ë¹„ ë‚®ì€ ìˆ˜ì¤€ìœ¼ë¡œ, ì¬ë¬´ê°œì„  í›„ ì •ì±…ìê¸ˆ ì‹ ì²­ì„ ê¶Œì¥í•©ë‹ˆë‹¤.`;
                }
            } else { // total
                if (totalScore >= 18) {
                    modeSpecificComment = ' ì „ì‚°ì—… í‰ê·  ëŒ€ë¹„ ë§¤ìš° ìš°ìˆ˜í•œ ì¬ë¬´ìƒíƒœë¡œ, ê¸ˆìœµê¸°ê´€ ë° ì •ì±…ìê¸ˆ ëª¨ë‘ ìœ ë¦¬í•œ ì¡°ê±´ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
                } else if (totalScore >= 12) {
                    modeSpecificComment = ' ì „ì‚°ì—… í‰ê· ë³´ë‹¤ ì–‘í˜¸í•œ ìˆ˜ì¤€ìœ¼ë¡œ, ì•ˆì •ì ì¸ ìê¸ˆì¡°ë‹¬ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.';
                } else if (totalScore >= 7) {
                    modeSpecificComment = ' ì „ì‚°ì—… í‰ê·  ìˆ˜ì¤€ì´ë©°, ì²´ê³„ì ì¸ ì¬ë¬´ê´€ë¦¬ë¡œ ìƒìœ„ ë“±ê¸‰ ì§„ì…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.';
                } else {
                    modeSpecificComment = ' ì „ì‚°ì—… í‰ê·  ëŒ€ë¹„ ë‚®ì€ ìˆ˜ì¤€ìœ¼ë¡œ, ì¦‰ê°ì ì¸ ì¬ë¬´êµ¬ì¡° ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.';
                }
            }
            
            if (totalScore >= 18) {
                overallGrade = 'ë§¤ìš° ìš°ìˆ˜';
                overallComment = 'ëŒ€ë¶€ë¶„ì˜ ì¬ë¬´ì§€í‘œê°€ ìš°ìˆ˜í•œ ìˆ˜ì¤€ì„ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤. í˜„ì¬ì˜ ì•ˆì •ì ì¸ ì¬ë¬´êµ¬ì¡°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì„±ì¥ íˆ¬ìë¥¼ ì ê·¹ ê²€í† í•  ì‹œì ì…ë‹ˆë‹¤.' + modeSpecificComment;
            } else if (totalScore >= 12) {
                overallGrade = 'ì–‘í˜¸';
                overallComment = 'ì „ë°˜ì ì¸ ì¬ë¬´ìƒíƒœê°€ ì–‘í˜¸í•˜ë‚˜, ì¼ë¶€ ê°œì„ ì´ í•„ìš”í•œ ì§€í‘œê°€ ìˆìŠµë‹ˆë‹¤. ì·¨ì•½ ë¶€ë¬¸ì„ ì§‘ì¤‘ ê´€ë¦¬í•˜ë©´ ìš°ìˆ˜í•œ ë“±ê¸‰ìœ¼ë¡œ ë°œì „ ê°€ëŠ¥í•©ë‹ˆë‹¤.' + modeSpecificComment;
            } else if (totalScore >= 7) {
                overallGrade = 'ë³´í†µ';
                overallComment = 'ì¬ë¬´ì§€í‘œê°€ í‰ê·  ìˆ˜ì¤€ì´ë‚˜ ê°œì„  ì—¬ì§€ê°€ ë§ìŠµë‹ˆë‹¤. ì²´ê³„ì ì¸ ì¬ë¬´ê´€ë¦¬ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ê³  ë‹¨ê³„ì  ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.' + modeSpecificComment;
            } else {
                overallGrade = 'ì£¼ì˜ í•„ìš”';
                overallComment = 'ë‹¤ìˆ˜ì˜ ì¬ë¬´ì§€í‘œê°€ ê¸°ì¤€ì— ë¯¸ë‹¬í•˜ê³  ìˆì–´ ì¦‰ê°ì ì¸ ê°œì„  ì¡°ì¹˜ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì „ë¬¸ê°€ ì»¨ì„¤íŒ…ì„ í†µí•œ ì¬ë¬´êµ¬ì¡° ê°œì„ ì„ ê¶Œì¥í•©ë‹ˆë‹¤.' + modeSpecificComment;
            }
            
            comprehensiveAnalysis += `<div style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 18px; border-radius: 8px; border: 2px solid #f59e0b;">`;
            comprehensiveAnalysis += `<p style="font-size: 16px; font-weight: 700; color: #92400e; margin-bottom: 8px;">ğŸ’ ì¢…í•© ë“±ê¸‰: ${overallGrade}</p>`;
            comprehensiveAnalysis += `<p style="font-size: 14px; line-height: 1.7; color: #78350f;">${overallComment}</p>`;
            comprehensiveAnalysis += `</div>`;
            
            comprehensiveAnalysis += `</div></div>`;

            // ===========================================
            // 2. í‰ê°€ ëª¨ë“œë³„ ìê¸ˆ ì¶”ì²œ
            // ===========================================
            let fundingRecommendation = '<div class="comment-section" style="background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border-left: 5px solid #16a34a; padding: 25px;">';
            fundingRecommendation += '<h4 style="color: #15803d; font-size: 18px; margin-bottom: 18px;">ğŸ’° í‰ê°€ ê¸°ì¤€ë³„ ìê¸ˆì¡°ë‹¬ ì¶”ì²œ</h4>';
            
            // ì€í–‰ê¸°ì¤€ í‰ê°€
            const bankScore = evaluationResults.bank.excellent + evaluationResults.bank.good;
            fundingRecommendation += `<div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">`;
            fundingRecommendation += `<h5 style="color: #0891b2; font-size: 16px; margin-bottom: 12px;">ğŸ¦ ì€í–‰ê¸°ì¤€ í‰ê°€ (ìš°ìˆ˜ ${evaluationResults.bank.excellent}ê°œ + ì–‘í˜¸ ${evaluationResults.bank.good}ê°œ = ì´ ${bankScore}ê°œ)</h5>`;
            
            if (bankScore >= 5) {
                fundingRecommendation += `<p style="line-height: 1.8; color: #334155; margin-bottom: 12px;">âœ… <strong>ì‹œì¤‘ì€í–‰ ëŒ€ì¶œ ì ê·¹ ì¶”ì²œ</strong></p>`;
                fundingRecommendation += `<ul style="margin-left: 20px; line-height: 1.8; color: #475569;">`;
                fundingRecommendation += `<li><strong>ìš°ëŒ€ê¸ˆë¦¬ ëŒ€ìƒ:</strong> ì‹ í•œì€í–‰, í•˜ë‚˜ì€í–‰, KBêµ­ë¯¼ì€í–‰ ë“± ì‹œì¤‘ì€í–‰ì˜ ìš°ëŒ€ê¸ˆë¦¬ ì ìš© ê°€ëŠ¥</li>`;
                fundingRecommendation += `<li><strong>ì¶”ì²œ ìƒí’ˆ:</strong> ê¸°ì—…ì‹ ìš©ëŒ€ì¶œ(3~5ë…„), ìš´ì „ìê¸ˆëŒ€ì¶œ, ì‹œì„¤ìê¸ˆëŒ€ì¶œ</li>`;
                fundingRecommendation += `<li><strong>ê¸ˆë¦¬ ìˆ˜ì¤€:</strong> ì—° 4.5~6.0% (ìš°ëŒ€ê¸ˆë¦¬ ìµœëŒ€ 1.5%p í• ì¸ ê°€ëŠ¥)</li>`;
                fundingRecommendation += `<li><strong>í•œë„:</strong> ë§¤ì¶œì•¡ì˜ 50~100%, ìµœëŒ€ 30ì–µì›</li>`;
                fundingRecommendation += `<li><strong>ë‹´ë³´:</strong> ë¬´ë‹´ë³´ ë˜ëŠ” ë¶€ë™ì‚° ë‹´ë³´ ì„ íƒ ê°€ëŠ¥</li>`;
                fundingRecommendation += `</ul>`;
            } else if (bankScore >= 3) {
                fundingRecommendation += `<p style="line-height: 1.8; color: #334155; margin-bottom: 12px;">âš ï¸ <strong>ì‹œì¤‘ì€í–‰ ëŒ€ì¶œ ê°€ëŠ¥ (ì¼ë¶€ ë³´ì™„ í•„ìš”)</strong></p>`;
                fundingRecommendation += `<ul style="margin-left: 20px; line-height: 1.8; color: #475569;">`;
                fundingRecommendation += `<li><strong>ëŒ€ì¶œ ê°€ëŠ¥:</strong> ì¼ë¶€ ì¬ë¬´ì§€í‘œ ë³´ì™„ ì‹œ ì‹œì¤‘ì€í–‰ ëŒ€ì¶œ ìŠ¹ì¸ ê°€ëŠ¥ì„± ìˆìŒ</li>`;
                fundingRecommendation += `<li><strong>ì¶”ì²œ ìƒí’ˆ:</strong> IBKê¸°ì—…ì€í–‰, Shìˆ˜í˜‘ì€í–‰ ë“± ì¤‘ì†Œê¸°ì—… íŠ¹í™” ìƒí’ˆ</li>`;
                fundingRecommendation += `<li><strong>ê¸ˆë¦¬ ìˆ˜ì¤€:</strong> ì—° 5.5~7.5%</li>`;
                fundingRecommendation += `<li><strong>ë³´ì™„ ì‚¬í•­:</strong> ë¯¸ë‹¬ ì§€í‘œ ê°œì„  ê³„íšì„œ ì œì¶œ, ì‚¬ì—…ê³„íšì„œ ë³´ì™„</li>`;
                fundingRecommendation += `</ul>`;
            } else {
                fundingRecommendation += `<p style="line-height: 1.8; color: #334155; margin-bottom: 12px;">âŒ <strong>ì‹œì¤‘ì€í–‰ ëŒ€ì¶œ ì–´ë ¤ì›€ (ì •ì±…ìê¸ˆ ìš°ì„  ê²€í† )</strong></p>`;
                fundingRecommendation += `<ul style="margin-left: 20px; line-height: 1.8; color: #475569;">`;
                fundingRecommendation += `<li>ì€í–‰ê¸°ì¤€ ë¯¸ë‹¬ ì§€í‘œê°€ ë§ì•„ ì‹œì¤‘ì€í–‰ ëŒ€ì¶œ ìŠ¹ì¸ì´ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>`;
                fundingRecommendation += `<li>ì •ì±…ìê¸ˆ ë° ë³´ì¦ë¶€ ëŒ€ì¶œì„ ìš°ì„  ê²€í† í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤</li>`;
                fundingRecommendation += `</ul>`;
            }
            fundingRecommendation += `</div>`;
            
            // ì—…ì¢…ê¸°ì¤€ í‰ê°€
            const industryScore = evaluationResults.industry.excellent + evaluationResults.industry.good;
            fundingRecommendation += `<div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">`;
            fundingRecommendation += `<h5 style="color: #0891b2; font-size: 16px; margin-bottom: 12px;">ğŸ­ ì—…ì¢…ê¸°ì¤€ í‰ê°€ (ìš°ìˆ˜ ${evaluationResults.industry.excellent}ê°œ + ì–‘í˜¸ ${evaluationResults.industry.good}ê°œ = ì´ ${industryScore}ê°œ)</h5>`;
            
            if (industryScore >= 5) {
                fundingRecommendation += `<p style="line-height: 1.8; color: #334155; margin-bottom: 12px;">âœ… <strong>ì •ì±…ìê¸ˆ ìš°ëŒ€ ëŒ€ìƒ (ì¤‘ì§„ê³µ/ì‹ ë³´/ê¸°ë³´ ì ê·¹ ì¶”ì²œ)</strong></p>`;
                fundingRecommendation += `<ul style="margin-left: 20px; line-height: 1.8; color: #475569;">`;
                fundingRecommendation += `<li><strong>ì¤‘ì†Œë²¤ì²˜ê¸°ì—…ì§„í¥ê³µë‹¨ (ì¤‘ì§„ê³µ)</strong>`;
                fundingRecommendation += `<ul style="margin-left: 20px; margin-top: 8px;">`;
                fundingRecommendation += `<li>ì •ì±…ìê¸ˆ ì§ì ‘ëŒ€ì¶œ: ì—° 2.0~3.5% (ìµœì €ê¸ˆë¦¬)</li>`;
                fundingRecommendation += `<li>ì„±ì¥ê¸°ë°˜ìê¸ˆ, í˜ì‹ ì„±ì¥ì´‰ì§„ìê¸ˆ, ì¼ìë¦¬ì°½ì¶œì´‰ì§„ìê¸ˆ</li>`;
                fundingRecommendation += `<li>ëŒ€ì¶œí•œë„: ì—…ì²´ë‹¹ ìµœëŒ€ 50ì–µì› (ìš´ì „ 30ì–µ + ì‹œì„¤ 20ì–µ)</li>`;
                fundingRecommendation += `<li>ìƒí™˜ê¸°ê°„: ìµœëŒ€ 10ë…„ (ê±°ì¹˜ 3ë…„)</li>`;
                fundingRecommendation += `</ul></li>`;
                fundingRecommendation += `<li><strong>ì‹ ìš©ë³´ì¦ê¸°ê¸ˆ (ì‹ ë³´)</strong>`;
                fundingRecommendation += `<ul style="margin-left: 20px; margin-top: 8px;">`;
                fundingRecommendation += `<li>ì‹ ìš©ë³´ì¦ì„œ ë°œê¸‰: ë³´ì¦ë¹„ìœ¨ 85~100%</li>`;
                fundingRecommendation += `<li>ì¼ë°˜ë³´ì¦, íŠ¹ë³„ë³´ì¦ (ì—…ì¢…ë³„ ìš°ëŒ€)</li>`;
                fundingRecommendation += `<li>ë³´ì¦í•œë„: ìµœëŒ€ 30ì–µì›</li>`;
                fundingRecommendation += `<li>ë³´ì¦ë£Œìœ¨: 0.5~1.5% (ì—…ì¢… ìš°ìˆ˜ ì‹œ ìµœì € ìš”ìœ¨)</li>`;
                fundingRecommendation += `</ul></li>`;
                fundingRecommendation += `<li><strong>ê¸°ìˆ ë³´ì¦ê¸°ê¸ˆ (ê¸°ë³´)</strong>`;
                fundingRecommendation += `<ul style="margin-left: 20px; margin-top: 8px;">`;
                fundingRecommendation += `<li>ê¸°ìˆ í‰ê°€ë³´ì¦: ê¸°ìˆ ë ¥ ê¸°ë°˜ ë³´ì¦</li>`;
                fundingRecommendation += `<li>ë³´ì¦í•œë„: ìµœëŒ€ 30ì–µì›</li>`;
                fundingRecommendation += `<li>ë³´ì¦ë£Œìœ¨: 0.5~1.8% (ê¸°ìˆ ë“±ê¸‰ì— ë”°ë¼ ì°¨ë“±)</li>`;
                fundingRecommendation += `</ul></li>`;
                fundingRecommendation += `</ul>`;
            } else if (industryScore >= 3) {
                fundingRecommendation += `<p style="line-height: 1.8; color: #334155; margin-bottom: 12px;">âš ï¸ <strong>ì •ì±…ìê¸ˆ ì¼ë¶€ ê°€ëŠ¥ (ë³´ì¦ë¶€ ëŒ€ì¶œ ê¶Œì¥)</strong></p>`;
                fundingRecommendation += `<ul style="margin-left: 20px; line-height: 1.8; color: #475569;">`;
                fundingRecommendation += `<li><strong>ì‹ ìš©ë³´ì¦ì¬ë‹¨</strong>: ì§€ì—­ ì‹ ìš©ë³´ì¦ì¬ë‹¨ í†µí•œ ë³´ì¦ë¶€ ëŒ€ì¶œ (í•œë„ ìµœëŒ€ 5ì–µì›)</li>`;
                fundingRecommendation += `<li><strong>ì†Œìƒê³µì¸ì§„í¥ê³µë‹¨</strong>: ì†Œìƒê³µì¸ ì •ì±…ìê¸ˆ (ì—° 2.0~3.0%, ìµœëŒ€ 1ì–µì›)</li>`;
                fundingRecommendation += `<li><strong>ì§€ìì²´ íŠ¹ë³„ìê¸ˆ</strong>: ê° ì§€ì—­ë³„ ì¤‘ì†Œê¸°ì—… ì§€ì›ìê¸ˆ ì‹ ì²­</li>`;
                fundingRecommendation += `</ul>`;
            } else {
                fundingRecommendation += `<p style="line-height: 1.8; color: #334155; margin-bottom: 12px;">âŒ <strong>ì¬ë¬´ê°œì„  í›„ ì •ì±…ìê¸ˆ ì‹ ì²­ ê¶Œì¥</strong></p>`;
                fundingRecommendation += `<ul style="margin-left: 20px; line-height: 1.8; color: #475569;">`;
                fundingRecommendation += `<li>ì—…ì¢… í‰ê·  ëŒ€ë¹„ ì¬ë¬´ì§€í‘œê°€ ë‚®ì•„ ì •ì±…ìê¸ˆ ìŠ¹ì¸ì´ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>`;
                fundingRecommendation += `<li>3~6ê°œì›”ê°„ ì¬ë¬´êµ¬ì¡° ê°œì„  í›„ ì¬ì‹ ì²­ì„ ê¶Œì¥í•©ë‹ˆë‹¤</li>`;
                fundingRecommendation += `<li>ê¸´ê¸‰ ìê¸ˆì´ í•„ìš”í•œ ê²½ìš°: ì†Œìƒê³µì¸ì§„í¥ê³µë‹¨ ê¸´ê¸‰ê²½ì˜ì•ˆì •ìê¸ˆ ê²€í† </li>`;
                fundingRecommendation += `</ul>`;
            }
            fundingRecommendation += `</div>`;
            
            fundingRecommendation += `</div>`;

            // ===========================================
            // 3. ìƒì„¸ ì¬ë¬´ì§€í‘œ ë¶„ì„ (31ê°œ í•­ëª© ê¸°ë°˜)
            // ===========================================
            let detailedAnalysis = '<div class="comment-section" style="background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%); border-left: 5px solid #9333ea; padding: 25px;">';
            detailedAnalysis += '<h4 style="color: #7e22ce; font-size: 18px; margin-bottom: 18px;">ğŸ” ìƒì„¸ ì¬ë¬´ì§€í‘œ ë¶„ì„ (31ê°œ ê³„ì •ê³¼ëª© ê¸°ë°˜)</h4>';
            
            // ìœ ë™ì„± ë¶„ì„
            detailedAnalysis += generateDetailedLiquidityAnalysis(latest, prev, prev2, industryCode);
            
            // ì•ˆì •ì„± ë¶„ì„
            detailedAnalysis += generateDetailedStabilityAnalysis(latest, prev, prev2, industryCode);
            
            // ìˆ˜ìµì„± ë¶„ì„
            detailedAnalysis += generateDetailedProfitabilityAnalysis(latest, prev, prev2, industryCode);
            
            // í™œë™ì„± ë¶„ì„
            detailedAnalysis += generateDetailedActivityAnalysis(latest, prev, prev2, industryCode);
            
            detailedAnalysis += '</div>';

            // ===========================================
            // 4. 3ê°œë…„ ì¶”ì„¸ ë¶„ì„
            // ===========================================
            let trendAnalysis = generateTrendAnalysis(results, industryCode);

            // ===========================================
            // 5. ë§ì¶¤í˜• ê°œì„  ë¡œë“œë§µ
            // ===========================================
            let improvementRoadmap = generateImprovementRoadmap(latest, prev, industryCode, evaluationResults);

            // ===========================================
            // 6. ìš°ì„ ìˆœìœ„ ê³¼ì œ
            // ===========================================
            let priorityTasks = generatePriorityTasks(latest, currentResults);

            // HTML ì¡°í•©
            let html = '<h3 style="color: #1e293b; font-size: 22px; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 3px solid #e2e8f0;">ğŸ’¬ ì „ë¬¸ ì»¨ì„¤í„´íŠ¸ ì¢…í•© ë¶„ì„ ë¦¬í¬íŠ¸</h3>';
            html += comprehensiveAnalysis;
            html += fundingRecommendation;
            html += detailedAnalysis;
            html += trendAnalysis;
            html += improvementRoadmap;
            html += priorityTasks;

            document.getElementById('consultantSection').innerHTML = html;
        }

        // ìƒì„¸ ìœ ë™ì„± ë¶„ì„
        function generateDetailedLiquidityAnalysis(latest, prev, prev2, industryCode) {
            // í˜„ì¬ í‰ê°€ ëª¨ë“œì˜ ê¸°ì¤€ê°’ ê°€ì ¸ì˜¤ê¸°
            const ìœ ë™ë¹„ìœ¨ê¸°ì¤€ = getStandardValue('ìœ ë™ë¹„ìœ¨', industryCode, evaluationMode);
            const ë‹¹ì¢Œë¹„ìœ¨ê¸°ì¤€ = getStandardValue('ë‹¹ì¢Œë¹„ìœ¨', industryCode, evaluationMode);
            const modeNames = { 'bank': 'ì€í–‰ê¸°ì¤€', 'industry': 'ì—…ì¢…ê¸°ì¤€', 'total': 'í†µí•©ê¸°ì¤€' };
            
            let html = '<div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">';
            html += '<h5 style="color: #0891b2; font-size: 16px; margin-bottom: 15px;">ğŸ’§ ìœ ë™ì„± ë¶„ì„ (ë‹¨ê¸° ì§€ê¸‰ëŠ¥ë ¥)</h5>';
            
            html += '<p style="line-height: 1.8; color: #334155; margin-bottom: 8px;">';
            html += `<strong style="color: #0891b2;">[${modeNames[evaluationMode]}]</strong> `;
            html += `ìœ ë™ë¹„ìœ¨ ê¸°ì¤€ <strong>${ìœ ë™ë¹„ìœ¨ê¸°ì¤€.toFixed(1)}%</strong>, `;
            html += `ë‹¹ì¢Œë¹„ìœ¨ ê¸°ì¤€ <strong>${ë‹¹ì¢Œë¹„ìœ¨ê¸°ì¤€.toFixed(1)}%</strong>`;
            html += '</p>';
            
            html += '<p style="line-height: 1.8; color: #334155; margin-bottom: 15px;">';
            html += `<strong>ì‹¤ì œê°’:</strong> ìœ ë™ë¹„ìœ¨ <strong style="color: #0284c7;">${latest.ìœ ë™ë¹„ìœ¨.toFixed(2)}%</strong>, `;
            html += `ë‹¹ì¢Œë¹„ìœ¨ <strong style="color: #0284c7;">${latest.ë‹¹ì¢Œë¹„ìœ¨.toFixed(2)}%</strong>, `;
            html += `í˜„ê¸ˆë³´ìœ ìœ¨ <strong style="color: #0284c7;">${latest.í˜„ê¸ˆë³´ìœ ìœ¨.toFixed(2)}%</strong>`;
            html += '</p>';
            
            // ìœ ë™ë¹„ìœ¨ ì§„ë‹¨ - í˜„ì¬ ëª¨ë“œ ê¸°ì¤€ ëŒ€ë¹„ í‰ê°€
            html += '<div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 12px;">';
            html += '<p style="font-weight: 600; color: #475569; margin-bottom: 8px;">ğŸ“Š ìœ ë™ë¹„ìœ¨ ì§„ë‹¨</p>';
            
            const ìœ ë™ë¹„ìœ¨ë¹„êµ = (latest.ìœ ë™ë¹„ìœ¨ / ìœ ë™ë¹„ìœ¨ê¸°ì¤€) * 100;
            if (ìœ ë™ë¹„ìœ¨ë¹„êµ >= 120) {
                html += `<p style="line-height: 1.8; color: #059669;">âœ… <strong>ë§¤ìš° ìš°ìˆ˜:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${ìœ ë™ë¹„ìœ¨ë¹„êµ.toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ë‹¨ê¸°ì±„ë¬´ ìƒí™˜ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.</p>`;
            } else if (ìœ ë™ë¹„ìœ¨ë¹„êµ >= 100) {
                html += `<p style="line-height: 1.8; color: #059669;">âœ… <strong>ìš°ìˆ˜:</strong> ${modeNames[evaluationMode]}ì„ ì¶©ì¡±í•˜ì—¬ ë‹¨ê¸° ì§€ê¸‰ëŠ¥ë ¥ì´ ì•ˆì •ì ì…ë‹ˆë‹¤.</p>`;
            } else if (ìœ ë™ë¹„ìœ¨ë¹„êµ >= 80) {
                html += `<p style="line-height: 1.8; color: #d97706;">âš ï¸ <strong>ë³´í†µ:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${ìœ ë™ë¹„ìœ¨ë¹„êµ.toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>`;
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #78350f;"><li>ê°œì„ ë°©ì•ˆ: ì¬ê³ ìì‚° íšŒì „ìœ¨ í–¥ìƒ, ë‹¨ê¸°ì°¨ì…ê¸ˆ ì¥ê¸°í™” ì „í™˜</li></ul>';
            } else {
                html += `<p style="line-height: 1.8; color: #dc2626;">âŒ <strong>ì£¼ì˜:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${ìœ ë™ë¹„ìœ¨ë¹„êµ.toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ë‹¨ê¸° ì§€ê¸‰ëŠ¥ë ¥ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.</p>`;
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #991b1b;">';
                html += '<li>ê¸´ê¸‰ì¡°ì¹˜: ìš´ì „ìê¸ˆ í™•ë³´, ë§¤ì¶œì±„ê¶Œ ì¡°ê¸° íšŒìˆ˜</li>';
                html += '<li>ë‹¨ê¸°ë¶€ì±„ ë§Œê¸° ì—°ì¥ ë˜ëŠ” ì¥ê¸°í™” ì „í™˜ í˜‘ìƒ</li>';
                html += '</ul>';
            }
            html += '</div>';
            
            // ë‹¹ì¢Œë¹„ìœ¨ ì§„ë‹¨ - í˜„ì¬ ëª¨ë“œ ê¸°ì¤€ ëŒ€ë¹„ í‰ê°€
            html += '<div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 12px;">';
            html += '<p style="font-weight: 600; color: #475569; margin-bottom: 8px;">ğŸ“Š ë‹¹ì¢Œë¹„ìœ¨ ì§„ë‹¨</p>';
            
            const ë‹¹ì¢Œë¹„ìœ¨ë¹„êµ = (latest.ë‹¹ì¢Œë¹„ìœ¨ / ë‹¹ì¢Œë¹„ìœ¨ê¸°ì¤€) * 100;
            if (ë‹¹ì¢Œë¹„ìœ¨ë¹„êµ >= 120) {
                html += `<p style="line-height: 1.8; color: #059669;">âœ… <strong>ë§¤ìš° ìš°ìˆ˜:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${ë‹¹ì¢Œë¹„ìœ¨ë¹„êµ.toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ì¦‰ì‹œ í˜„ê¸ˆí™” ê°€ëŠ¥ ìì‚°ì´ ì¶©ë¶„í•©ë‹ˆë‹¤.</p>`;
            } else if (ë‹¹ì¢Œë¹„ìœ¨ë¹„êµ >= 100) {
                html += `<p style="line-height: 1.8; color: #059669;">âœ… <strong>ìš°ìˆ˜:</strong> ${modeNames[evaluationMode]}ì„ ì¶©ì¡±í•˜ì—¬ ë‹¹ì¢Œìì‚°ìœ¼ë¡œ ìœ ë™ë¶€ì±„ ìƒí™˜ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>`;
            } else if (ë‹¹ì¢Œë¹„ìœ¨ë¹„êµ >= 80) {
                html += `<p style="line-height: 1.8; color: #d97706;">âš ï¸ <strong>ë³´í†µ:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${ë‹¹ì¢Œë¹„ìœ¨ë¹„êµ.toFixed(0)}% ìˆ˜ì¤€ì…ë‹ˆë‹¤. ì¬ê³ ìì‚° ì˜ì¡´ë„ê°€ ë†’ìŠµë‹ˆë‹¤.</p>`;
            } else {
                html += `<p style="line-height: 1.8; color: #dc2626;">âŒ <strong>ì£¼ì˜:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${ë‹¹ì¢Œë¹„ìœ¨ë¹„êµ.toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ì¦‰ì‹œ í˜„ê¸ˆí™” ê°€ëŠ¥í•œ ìì‚°ì´ ë¶€ì¡±í•©ë‹ˆë‹¤.</p>`;
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #991b1b;">';
                html += '<li>ê°œì„ ë°©ì•ˆ: ë§¤ì¶œì±„ê¶Œ íŒ©í† ë§, ì¬ê³ ìì‚° ê°ì¶•, í˜„ê¸ˆì„± ìì‚° í™•ë³´</li>';
                html += '</ul>';
            }
            html += '</div>';
            
            // í˜„ê¸ˆë³´ìœ ìœ¨ ì§„ë‹¨
            html += '<div style="background: #f8fafc; padding: 15px; border-radius: 8px;">';
            html += '<p style="font-weight: 600; color: #475569; margin-bottom: 8px;">ğŸ“Š í˜„ê¸ˆë³´ìœ ìœ¨ ì§„ë‹¨</p>';
            if (latest.í˜„ê¸ˆë³´ìœ ìœ¨ >= 10) {
                html += '<p style="line-height: 1.8; color: #059669;">âœ… <strong>ìš°ìˆ˜:</strong> ë§¤ì¶œ ëŒ€ë¹„ í˜„ê¸ˆë³´ìœ  ë¹„ì¤‘ì´ ë†’ì•„ í˜„ê¸ˆíë¦„ì´ ì•ˆì •ì ì…ë‹ˆë‹¤.</p>';
            } else if (latest.í˜„ê¸ˆë³´ìœ ìœ¨ >= 5) {
                html += '<p style="line-height: 1.8; color: #d97706;">âš ï¸ <strong>ë³´í†µ:</strong> í˜„ê¸ˆë³´ìœ  ìˆ˜ì¤€ì´ ì ì •í•˜ë‚˜ ë” í™•ì¶©í•˜ëŠ” ê²ƒì´ ì•ˆì „í•©ë‹ˆë‹¤.</p>';
            } else {
                html += '<p style="line-height: 1.8; color: #dc2626;">âŒ <strong>ì£¼ì˜:</strong> í˜„ê¸ˆë³´ìœ ìœ¨ì´ ë§¤ìš° ë‚®ì•„ ê¸‰ê²©í•œ ìê¸ˆê²½ìƒ‰ ìœ„í—˜ì´ ìˆìŠµë‹ˆë‹¤.</p>';
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #991b1b;">';
                html += '<li>ê°œì„ ë°©ì•ˆ: ì›”ë³„ í˜„ê¸ˆíë¦„í‘œ ì‘ì„±, ì„ ìˆ˜ê¸ˆ í™•ëŒ€, ë§¤ì¶œ ëŒ€ê¸ˆ íšŒìˆ˜ ê°•í™”</li>';
                html += '</ul>';
            }
            html += '</div>';
            
            html += '</div>';
            return html;
        }

        // ìƒì„¸ ì•ˆì •ì„± ë¶„ì„
        function generateDetailedStabilityAnalysis(latest, prev, prev2, industryCode) {
            // í˜„ì¬ í‰ê°€ ëª¨ë“œì˜ ê¸°ì¤€ê°’ ê°€ì ¸ì˜¤ê¸°
            const ë¶€ì±„ë¹„ìœ¨ê¸°ì¤€ = getStandardValue('ë¶€ì±„ë¹„ìœ¨', industryCode, evaluationMode);
            const modeNames = { 'bank': 'ì€í–‰ê¸°ì¤€', 'industry': 'ì—…ì¢…ê¸°ì¤€', 'total': 'í†µí•©ê¸°ì¤€' };
            
            let html = '<div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">';
            html += '<h5 style="color: #0891b2; font-size: 16px; margin-bottom: 15px;">ğŸ›ï¸ ì¬ë¬´ì•ˆì •ì„± ë¶„ì„ (ì¥ê¸° ì¬ë¬´ê±´ì „ì„±)</h5>';
            
            html += '<p style="line-height: 1.8; color: #334155; margin-bottom: 8px;">';
            html += `<strong style="color: #0891b2;">[${modeNames[evaluationMode]}]</strong> `;
            html += `ë¶€ì±„ë¹„ìœ¨ ê¸°ì¤€ <strong>${ë¶€ì±„ë¹„ìœ¨ê¸°ì¤€.toFixed(1)}%</strong> ì´í•˜`;
            html += '</p>';
            
            html += '<p style="line-height: 1.8; color: #334155; margin-bottom: 15px;">';
            html += `<strong>ì‹¤ì œê°’:</strong> ë¶€ì±„ë¹„ìœ¨ <strong style="color: #0284c7;">${latest.ë¶€ì±„ë¹„ìœ¨.toFixed(2)}%</strong>, `;
            html += `ìë³¸ì ì‹ë¥  <strong style="color: ${latest.ìë³¸ì ì‹ë¥  > 0 ? '#dc2626' : '#059669'};">${latest.ìë³¸ì ì‹ë¥ .toFixed(2)}%</strong>`;
            html += '</p>';
            
            html += '<div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 12px;">';
            html += '<p style="font-weight: 600; color: #475569; margin-bottom: 8px;">ğŸ“Š ë¶€ì±„ë¹„ìœ¨ ì§„ë‹¨</p>';
            
            const ë¶€ì±„ë¹„ìœ¨ë¹„êµ = (latest.ë¶€ì±„ë¹„ìœ¨ / ë¶€ì±„ë¹„ìœ¨ê¸°ì¤€) * 100;
            if (latest.ë¶€ì±„ë¹„ìœ¨ <= ë¶€ì±„ë¹„ìœ¨ê¸°ì¤€ * 0.7) {
                html += `<p style="line-height: 1.8; color: #059669;">âœ… <strong>ë§¤ìš° ìš°ìˆ˜:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${ë¶€ì±„ë¹„ìœ¨ë¹„êµ.toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ì¬ë¬´êµ¬ì¡°ê°€ ë§¤ìš° ê±´ì „í•©ë‹ˆë‹¤. ì¶”ê°€ ì°¨ì… ì—¬ë ¥ì´ ì¶©ë¶„í•©ë‹ˆë‹¤.</p>`;
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #065f46;">';
                html += '<li>ì„±ì¥ íˆ¬ì: ì‹œì„¤í™•ì¶©, ì‹ ê·œì‚¬ì—… ì§„ì¶œ ë“± ê³µê²©ì  íˆ¬ì ê°€ëŠ¥</li>';
                html += '<li>ì¶”ê°€ ì°¨ì… ì‹œ: ì‹œì¤‘ì€í–‰ ìš°ëŒ€ê¸ˆë¦¬ ì ìš© ìœ ë¦¬</li>';
                html += '</ul>';
            } else if (latest.ë¶€ì±„ë¹„ìœ¨ <= ë¶€ì±„ë¹„ìœ¨ê¸°ì¤€) {
                html += `<p style="line-height: 1.8; color: #059669;">âœ… <strong>ìš°ìˆ˜:</strong> ${modeNames[evaluationMode]}ì„ ì¶©ì¡±í•˜ì—¬ ì•ˆì •ì ì¸ ì¬ë¬´êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>`;
            } else if (latest.ë¶€ì±„ë¹„ìœ¨ <= ë¶€ì±„ë¹„ìœ¨ê¸°ì¤€ * 1.3) {
                html += `<p style="line-height: 1.8; color: #d97706;">âš ï¸ <strong>ë³´í†µ:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${ë¶€ì±„ë¹„ìœ¨ë¹„êµ.toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ë‹¤ì†Œ ë†’ì€ í¸ì…ë‹ˆë‹¤. ì‹ ê·œ ì°¨ì… ì‹œ ì£¼ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>`;
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #78350f;">';
                html += '<li>ê°œì„ ë°©ì•ˆ: ì˜ì—…ì´ìµ ì¬íˆ¬ì, ë¶ˆí•„ìš”í•œ ìì‚° ë§¤ê° í›„ ë¶€ì±„ ìƒí™˜</li>';
                html += '<li>ì‹ ê·œ ì°¨ì…ë³´ë‹¤ëŠ” ë‚´ë¶€ìœ ë³´ê¸ˆ í™œìš© ê¶Œì¥</li>';
                html += '</ul>';
            } else {
                html += `<p style="line-height: 1.8; color: #dc2626;">âŒ <strong>ìœ„í—˜:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${ë¶€ì±„ë¹„ìœ¨ë¹„êµ.toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ë¶€ì±„ë¹„ìœ¨ì´ ê³¼ë„í•˜ê²Œ ë†’ì•„ ì¬ë¬´ìœ„í—˜ì´ í½ë‹ˆë‹¤.</p>`;
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #991b1b;">';
                html += '<li>ê¸´ê¸‰ì¡°ì¹˜: ìœ ìƒì¦ì, ì‚¬ëª¨íˆ¬ì ìœ ì¹˜, ì¥ê¸°ë¶€ì±„ ìƒí™˜ê³„íš ìˆ˜ë¦½</li>';
                html += '<li>ë‹¨ê¸°ì°¨ì…ê¸ˆ ì¥ê¸°í™” ì „í™˜ìœ¼ë¡œ ë§Œê¸° ë¶€ë‹´ ì™„í™”</li>';
                html += '<li>ì „ë¬¸ ì¬ë¬´ì»¨ì„¤íŒ… í†µí•œ êµ¬ì¡°ì¡°ì • ê²€í† </li>';
                html += '</ul>';
            }
            html += '</div>';
            
            if (latest.ìë³¸ì ì‹ë¥  > 0) {
                html += '<div style="background: #fef2f2; padding: 15px; border-radius: 8px; border: 2px solid #dc2626;">';
                html += '<p style="font-weight: 700; color: #991b1b; margin-bottom: 8px;">âš ï¸ ìë³¸ì ì‹ ê²½ê³ </p>';
                html += `<p style="line-height: 1.8; color: #7f1d1d;">í˜„ì¬ ìë³¸ì ì‹ë¥  ${latest.ìë³¸ì ì‹ë¥ .toFixed(2)}%ë¡œ ìë³¸ì´ ë§ˆì´ë„ˆìŠ¤ ìƒíƒœì…ë‹ˆë‹¤. ë²•ì  ì¡°ì¹˜ê°€ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>`;
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #7f1d1d;">';
                html += '<li><strong>ì¦‰ì‹œ ì¡°ì¹˜:</strong> ê°ì í›„ ì¦ì, ì¶œìì „í™˜, ì›Œí¬ì•„ì›ƒ ë“± ì „ë¬¸ê°€ ìƒë‹´ í•„ìˆ˜</li>';
                html += '<li><strong>ë²•ì  ëŒ€ì‘:</strong> ìƒë²•ìƒ ìë³¸ì ì‹ í•´ì†Œ ì˜ë¬´ (50% ì´ìƒ ì‹œ ì£¼ì£¼ì´íšŒ ì†Œì§‘)</li>';
                html += '<li><strong>íšŒê³„ë²•ì¸:</strong> ì™¸ë¶€íšŒê³„ê°ì‚¬ í†µí•œ ì •í™•í•œ ì¬ë¬´ìƒíƒœ íŒŒì•…</li>';
                html += '</ul>';
                html += '</div>';
            }
            
            html += '</div>';
            return html;
        }

        // ìƒì„¸ ìˆ˜ìµì„± ë¶„ì„
        function generateDetailedProfitabilityAnalysis(latest, prev, prev2, industryCode) {
            // í˜„ì¬ í‰ê°€ ëª¨ë“œì˜ ê¸°ì¤€ê°’ ê°€ì ¸ì˜¤ê¸°
            const ì˜ì—…ì´ìµìœ¨ê¸°ì¤€ = getStandardValue('ì˜ì—…ì´ìµìœ¨', industryCode, evaluationMode);
            const ì´ìë³´ìƒë°°ìˆ˜ê¸°ì¤€ = getStandardValue('ì´ìë³´ìƒë°°ìˆ˜', industryCode, evaluationMode);
            const modeNames = { 'bank': 'ì€í–‰ê¸°ì¤€', 'industry': 'ì—…ì¢…ê¸°ì¤€', 'total': 'í†µí•©ê¸°ì¤€' };
            
            let html = '<div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">';
            html += '<h5 style="color: #0891b2; font-size: 16px; margin-bottom: 15px;">ğŸ’° ìˆ˜ìµì„± ë¶„ì„</h5>';
            
            html += '<p style="line-height: 1.8; color: #334155; margin-bottom: 8px;">';
            html += `<strong style="color: #0891b2;">[${modeNames[evaluationMode]}]</strong> `;
            html += `ì˜ì—…ì´ìµë¥  ê¸°ì¤€ <strong>${ì˜ì—…ì´ìµìœ¨ê¸°ì¤€.toFixed(1)}%</strong>, `;
            html += `ì´ìë³´ìƒë°°ìˆ˜ ê¸°ì¤€ <strong>${ì´ìë³´ìƒë°°ìˆ˜ê¸°ì¤€.toFixed(1)}ë°°</strong>`;
            html += '</p>';
            
            html += '<p style="line-height: 1.8; color: #334155; margin-bottom: 15px;">';
            html += `<strong>ì‹¤ì œê°’:</strong> ì˜ì—…ì´ìµë¥  <strong style="color: ${latest.ì˜ì—…ì´ìµìœ¨ >= 0 ? '#0284c7' : '#dc2626'};">${latest.ì˜ì—…ì´ìµìœ¨.toFixed(2)}%</strong>, `;
            html += `ì´ìë³´ìƒë°°ìˆ˜ <strong style="color: #0284c7;">${latest.ì´ìë³´ìƒë°°ìˆ˜.toFixed(2)}ë°°</strong>`;
            html += '</p>';
            
            html += '<div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 12px;">';
            html += '<p style="font-weight: 600; color: #475569; margin-bottom: 8px;">ğŸ“Š ì˜ì—…ì´ìµë¥  ì§„ë‹¨</p>';
            
            if (latest.ì˜ì—…ì´ìµìœ¨ >= ì˜ì—…ì´ìµìœ¨ê¸°ì¤€ * 1.5) {
                html += `<p style="line-height: 1.8; color: #059669;">âœ… <strong>ë§¤ìš° ìš°ìˆ˜:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${(latest.ì˜ì—…ì´ìµìœ¨ / ì˜ì—…ì´ìµìœ¨ê¸°ì¤€ * 100).toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ì˜ì—…í™œë™ìœ¼ë¡œ ë†’ì€ ìˆ˜ìµì„ ì°½ì¶œí•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>`;
            } else if (latest.ì˜ì—…ì´ìµìœ¨ >= ì˜ì—…ì´ìµìœ¨ê¸°ì¤€) {
                html += `<p style="line-height: 1.8; color: #059669;">âœ… <strong>ìš°ìˆ˜:</strong> ${modeNames[evaluationMode]}ì„ ì¶©ì¡±í•˜ì—¬ ì•ˆì •ì ì¸ ì˜ì—…ì´ìµì„ í™•ë³´í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>`;
            } else if (latest.ì˜ì—…ì´ìµìœ¨ >= 0) {
                html += `<p style="line-height: 1.8; color: #d97706;">âš ï¸ <strong>ê°œì„  í•„ìš”:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${(latest.ì˜ì—…ì´ìµìœ¨ / ì˜ì—…ì´ìµìœ¨ê¸°ì¤€ * 100).toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ìˆ˜ìµì„± ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.</p>`;
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #78350f;">';
                html += '<li>ê°œì„ ë°©ì•ˆ: ì›ê°€ì ˆê°, íŒê´€ë¹„ íš¨ìœ¨í™”, ì œí’ˆ ê°€ê²© ì¬ì¡°ì •</li>';
                html += '<li>ê³ ë¶€ê°€ê°€ì¹˜ ì œí’ˆ ê°œë°œ, ë§ˆì¼€íŒ… ì „ëµ ì¬ì •ë¹„</li>';
                html += '</ul>';
            } else {
                html += '<p style="line-height: 1.8; color: #dc2626;">âŒ <strong>ìœ„í—˜:</strong> ì˜ì—…ì†ì‹¤ ë°œìƒ. ì‚¬ì—…êµ¬ì¡° ì „ë©´ ì¬ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>';
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #991b1b;">';
                html += '<li>ê¸´ê¸‰ì¡°ì¹˜: ì›ê°€êµ¬ì¡° ì¬ë¶„ì„, ë¶ˆí•„ìš”í•œ ê³ ì •ë¹„ ì‚­ê°</li>';
                html += '<li>ì €ìˆ˜ìµ ì œí’ˆ ë‹¨ì¢…, ê³ ìˆ˜ìµ ì œí’ˆ ì§‘ì¤‘</li>';
                html += '<li>ì‚¬ì—… ë‹¤ê°í™” ë˜ëŠ” êµ¬ì¡°ì¡°ì • ê²€í† </li>';
                html += '</ul>';
            }
            html += '</div>';
            
            html += '<div style="background: #f8fafc; padding: 15px; border-radius: 8px;">';
            html += '<p style="font-weight: 600; color: #475569; margin-bottom: 8px;">ğŸ“Š ì´ìë³´ìƒë°°ìˆ˜ ì§„ë‹¨</p>';
            
            if (latest.ì´ìë³´ìƒë°°ìˆ˜ >= ì´ìë³´ìƒë°°ìˆ˜ê¸°ì¤€ * 1.5) {
                html += `<p style="line-height: 1.8; color: #059669;">âœ… <strong>ìš°ìˆ˜:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${(latest.ì´ìë³´ìƒë°°ìˆ˜ / ì´ìë³´ìƒë°°ìˆ˜ê¸°ì¤€ * 100).toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ì˜ì—…ì´ìµìœ¼ë¡œ ì´ìë¹„ìš©ì„ ì¶©ë¶„íˆ ê°ë‹¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>`;
            } else if (latest.ì´ìë³´ìƒë°°ìˆ˜ >= ì´ìë³´ìƒë°°ìˆ˜ê¸°ì¤€) {
                html += `<p style="line-height: 1.8; color: #d97706;">âš ï¸ <strong>ë³´í†µ:</strong> ${modeNames[evaluationMode]}ì„ ì¶©ì¡±í•˜ë‚˜ ì´ìë¶€ë‹´ì´ ë‹¤ì†Œ ìˆìŠµë‹ˆë‹¤.</p>`;
            } else if (latest.ì´ìë³´ìƒë°°ìˆ˜ >= 1) {
                html += `<p style="line-height: 1.8; color: #dc2626;">âŒ <strong>ì£¼ì˜:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${(latest.ì´ìë³´ìƒë°°ìˆ˜ / ì´ìë³´ìƒë°°ìˆ˜ê¸°ì¤€ * 100).toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ì˜ì—…ì´ìµìœ¼ë¡œ ê²¨ìš° ì´ìë§Œ ê°šì„ ìˆ˜ ìˆëŠ” ìˆ˜ì¤€ì…ë‹ˆë‹¤.</p>`;
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #991b1b;">';
                html += '<li>ê°œì„ ë°©ì•ˆ: ê³ ê¸ˆë¦¬ ë¶€ì±„ ì €ê¸ˆë¦¬ ì „í™˜, ì •ì±…ìê¸ˆ í™œìš©</li>';
                html += '<li>ì°¨ì…ê¸ˆ ì¼ë¶€ ìƒí™˜ìœ¼ë¡œ ì´ìë¶€ë‹´ ê²½ê°</li>';
                html += '</ul>';
            } else {
                html += '<p style="line-height: 1.8; color: #dc2626;">âŒ <strong>ìœ„í—˜:</strong> ì˜ì—…ì´ìµìœ¼ë¡œ ì´ìë„ ê°ë‹¹í•˜ì§€ ëª»í•˜ëŠ” ìƒí™©ì…ë‹ˆë‹¤.</p>';
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #991b1b;">';
                html += '<li>ê¸´ê¸‰ì¡°ì¹˜: ì°¨ì…ê¸ˆ êµ¬ì¡°ì¡°ì •, ì¶œìì „í™˜, ì±„ë¬´ì¬ì¡°ì • í˜‘ìƒ</li>';
                html += '<li>ì˜ì—…ì´ìµ ê°œì„ ì´ ìµœìš°ì„  ê³¼ì œ</li>';
                html += '</ul>';
            }
            html += '</div>';
            
            html += '</div>';
            return html;
        }

        // ìƒì„¸ í™œë™ì„± ë¶„ì„
        function generateDetailedActivityAnalysis(latest, prev, prev2, industryCode) {
            // í˜„ì¬ í‰ê°€ ëª¨ë“œì˜ ê¸°ì¤€ê°’ ê°€ì ¸ì˜¤ê¸°
            const ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ê¸°ì¤€ = getStandardValue('ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨', industryCode, evaluationMode);
            const modeNames = { 'bank': 'ì€í–‰ê¸°ì¤€', 'industry': 'ì—…ì¢…ê¸°ì¤€', 'total': 'í†µí•©ê¸°ì¤€' };
            
            let html = '<div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">';
            html += '<h5 style="color: #0891b2; font-size: 16px; margin-bottom: 15px;">âš¡ ìš´ì˜íš¨ìœ¨ì„± ë¶„ì„</h5>';
            
            html += '<p style="line-height: 1.8; color: #334155; margin-bottom: 8px;">';
            html += `<strong style="color: #0891b2;">[${modeNames[evaluationMode]}]</strong> `;
            html += `ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ ê¸°ì¤€ <strong>${ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ê¸°ì¤€.toFixed(1)}íšŒ</strong>`;
            html += '</p>';
            
            html += '<p style="line-height: 1.8; color: #334155; margin-bottom: 15px;">';
            html += `<strong>ì‹¤ì œê°’:</strong> ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ <strong style="color: #0284c7;">${latest.ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨.toFixed(2)}íšŒ</strong> (ì—°í‰ê·  íšŒìˆ˜ê¸°ê°„: ì•½ ${(365 / latest.ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨).toFixed(0)}ì¼)`;
            html += '</p>';
            
            html += '<div style="background: #f8fafc; padding: 15px; border-radius: 8px;">';
            html += '<p style="font-weight: 600; color: #475569; margin-bottom: 8px;">ğŸ“Š ë§¤ì¶œì±„ê¶Œ íšŒìˆ˜ ì§„ë‹¨</p>';
            
            if (latest.ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ >= ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ê¸°ì¤€ * 1.2) {
                html += `<p style="line-height: 1.8; color: #059669;">âœ… <strong>ë§¤ìš° ìš°ìˆ˜:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${(latest.ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ / ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ê¸°ì¤€ * 100).toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ë§¤ì¶œì±„ê¶Œ íšŒìˆ˜ê°€ ë§¤ìš° ë¹ ë¦…ë‹ˆë‹¤. í˜„ê¸ˆíë¦„ì´ ì›í™œí•©ë‹ˆë‹¤.</p>`;
            } else if (latest.ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ >= ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ê¸°ì¤€) {
                html += `<p style="line-height: 1.8; color: #059669;">âœ… <strong>ìš°ìˆ˜:</strong> ${modeNames[evaluationMode]}ì„ ì¶©ì¡±í•˜ì—¬ ë§¤ì¶œì±„ê¶Œ íšŒìˆ˜ê°€ ì–‘í˜¸í•©ë‹ˆë‹¤.</p>`;
            } else if (latest.ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ >= ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ê¸°ì¤€ * 0.7) {
                html += `<p style="line-height: 1.8; color: #d97706;">âš ï¸ <strong>ë³´í†µ:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${(latest.ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ / ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ê¸°ì¤€ * 100).toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ë§¤ì¶œì±„ê¶Œ íšŒìˆ˜ê°€ ë‹¤ì†Œ ëŠë¦° í¸ì…ë‹ˆë‹¤.</p>`;
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #78350f;">';
                html += '<li>ê°œì„ ë°©ì•ˆ: ì™¸ìƒë§¤ì¶œê¸ˆ ê´€ë¦¬ ê°•í™”, ì¡°ê¸°ê²°ì œ í• ì¸ì œë„ ë„ì…</li>';
                html += '<li>ì‹ ìš©ê´€ë¦¬ ì²´ê³„ êµ¬ì¶•, íšŒìˆ˜ ë‹´ë‹¹ì ì§€ì •</li>';
                html += '</ul>';
            } else {
                html += `<p style="line-height: 1.8; color: #dc2626;">âŒ <strong>ì£¼ì˜:</strong> ${modeNames[evaluationMode]} ëŒ€ë¹„ ${(latest.ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ / ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ê¸°ì¤€ * 100).toFixed(0)}% ìˆ˜ì¤€ìœ¼ë¡œ ë§¤ì¶œì±„ê¶Œ íšŒìˆ˜ê°€ ë§¤ìš° ëŠë¦½ë‹ˆë‹¤. í˜„ê¸ˆíë¦„ ì•…í™” ìš”ì¸ì…ë‹ˆë‹¤.</p>`;
                html += '<ul style="margin-left: 20px; margin-top: 8px; line-height: 1.8; color: #991b1b;">';
                html += '<li>ê¸´ê¸‰ì¡°ì¹˜: ë§¤ì¶œì±„ê¶Œ íŒ©í† ë§, ëŒ€ì†ì¶©ë‹¹ê¸ˆ ì ë¦½</li>';
                html += '<li>ì¥ê¸° ì—°ì²´ì±„ê¶Œ ë²•ì  ì¡°ì¹˜, í˜„ê¸ˆ ì„ ìˆ˜ê¸ˆ í™•ëŒ€</li>';
                html += '<li>ê±°ë˜ì²˜ë³„ ì‹ ìš©ë“±ê¸‰ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬ì¶•</li>';
                html += '</ul>';
            }
            html += '</div>';
            
            html += '</div>';
            return html;
        }

        // ì¶”ì„¸ ë¶„ì„
        function generateTrendAnalysis(results, industryCode) {
            const latest = results[2024];
            const prev = results[2023];
            const prev2 = results[2022];
            
            let html = '<div class="comment-section" style="background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%); border-left: 5px solid #f59e0b; padding: 25px;">';
            html += '<h4 style="color: #92400e; font-size: 18px; margin-bottom: 18px;">ğŸ“ˆ 3ê°œë…„ ì¶”ì„¸ ë¶„ì„ ë° ì˜ˆì¸¡</h4>';
            
            // ê° ì§€í‘œë³„ ì¶”ì„¸
            const trends = [
                { name: 'ìœ ë™ë¹„ìœ¨', values: [prev2.ìœ ë™ë¹„ìœ¨, prev.ìœ ë™ë¹„ìœ¨, latest.ìœ ë™ë¹„ìœ¨], higher: true, unit: '%' },
                { name: 'ë¶€ì±„ë¹„ìœ¨', values: [prev2.ë¶€ì±„ë¹„ìœ¨, prev.ë¶€ì±„ë¹„ìœ¨, latest.ë¶€ì±„ë¹„ìœ¨], higher: false, unit: '%' },
                { name: 'ì˜ì—…ì´ìµìœ¨', values: [prev2.ì˜ì—…ì´ìµìœ¨, prev.ì˜ì—…ì´ìµìœ¨, latest.ì˜ì—…ì´ìµìœ¨], higher: true, unit: '%' },
                { name: 'ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨', values: [prev2.ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨, prev.ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨, latest.ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨], higher: true, unit: 'íšŒ' }
            ];
            
            trends.forEach(trend => {
                const trend1 = trend.values[1] - trend.values[0]; // 2023 vs 2022
                const trend2 = trend.values[2] - trend.values[1]; // 2024 vs 2023
                
                html += '<div style="background: white; padding: 18px; border-radius: 10px; margin-bottom: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.06);">';
                html += `<p style="font-weight: 600; color: #1e293b; margin-bottom: 10px;">${trend.name}</p>`;
                html += `<div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: #f8fafc; border-radius: 6px;">`;
                html += `<div><span style="color: #64748b;">2022ë…„:</span> <strong>${trend.values[0].toFixed(2)}${trend.unit}</strong></div>`;
                html += `<div><span style="color: #64748b;">2023ë…„:</span> <strong>${trend.values[1].toFixed(2)}${trend.unit}</strong></div>`;
                html += `<div><span style="color: #64748b;">2024ë…„:</span> <strong>${trend.values[2].toFixed(2)}${trend.unit}</strong></div>`;
                html += `</div>`;
                
                let trendText = '';
                let trendColor = '';
                if ((trend.higher && trend1 > 0 && trend2 > 0) || (!trend.higher && trend1 < 0 && trend2 < 0)) {
                    trendText = 'âœ… 3ë…„ ì—°ì† ê°œì„  ì¶”ì„¸';
                    trendColor = '#059669';
                } else if ((trend.higher && trend1 < 0 && trend2 < 0) || (!trend.higher && trend1 > 0 && trend2 > 0)) {
                    trendText = 'âš ï¸ 3ë…„ ì—°ì† ì•…í™” ì¶”ì„¸ - ì¦‰ì‹œ ê°œì„  í•„ìš”';
                    trendColor = '#dc2626';
                } else {
                    trendText = 'ğŸ“Š ë³€ë™ì„± ìˆìŒ - ì§€ì† ëª¨ë‹ˆí„°ë§ í•„ìš”';
                    trendColor = '#d97706';
                }
                
                html += `<p style="margin-top: 10px; color: ${trendColor}; font-weight: 600;">${trendText}</p>`;
                html += '</div>';
            });
            
            html += '</div>';
            return html;
        }

        // ê°œì„  ë¡œë“œë§µ
        function generateImprovementRoadmap(latest, prev, industryCode, evaluationResults) {
            let html = '<div class="comment-section" style="background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); border-left: 5px solid #10b981; padding: 25px;">';
            html += '<h4 style="color: #065f46; font-size: 18px; margin-bottom: 18px;">ğŸ—ºï¸ ë§ì¶¤í˜• ì¬ë¬´ê°œì„  ë¡œë“œë§µ (3ê°œì›” ë‹¨ìœ„)</h4>';
            
            html += '<div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">';
            html += '<h5 style="color: #047857; font-size: 16px; margin-bottom: 12px;">1ë‹¨ê³„: ì¦‰ì‹œ ì‹¤í–‰ (1ê°œì›” ë‚´)</h5>';
            html += '<ul style="margin-left: 20px; line-height: 1.9; color: #374151;">';
            
            if (latest.ìœ ë™ë¹„ìœ¨ < 100) {
                html += '<li><strong>ìœ ë™ì„± í™•ë³´:</strong> ë‹¨ê¸°ì°¨ì…ê¸ˆ 3ì–µì› í™•ë³´ (ì‹ ë³´/ê¸°ë³´ ë³´ì¦ í™œìš©)</li>';
                html += '<li><strong>ì±„ê¶Œê´€ë¦¬:</strong> 90ì¼ ì´ìƒ ì—°ì²´ì±„ê¶Œ ì§‘ì¤‘ íšŒìˆ˜ (ë²•ë¬´ë²•ì¸ í˜‘ì¡°)</li>';
            }
            if (latest.í˜„ê¸ˆë³´ìœ ìœ¨ < 5) {
                html += '<li><strong>í˜„ê¸ˆíë¦„ ê°œì„ :</strong> ì£¼ìš” ê±°ë˜ì²˜ ê²°ì œì¡°ê±´ ì¬í˜‘ìƒ (ì„ ìˆ˜ê¸ˆ 10% í™•ë³´)</li>';
            }
            if (latest.ì´ìë³´ìƒë°°ìˆ˜ < 2) {
                html += '<li><strong>ì´ìë¶€ë‹´ ê²½ê°:</strong> ê³ ê¸ˆë¦¬ ë‹¨ê¸°ì°¨ì…ê¸ˆ ì •ì±…ìê¸ˆ ì „í™˜ ì‹ ì²­</li>';
            }
            
            html += '</ul></div>';
            
            html += '<div style="background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">';
            html += '<h5 style="color: #047857; font-size: 16px; margin-bottom: 12px;">2ë‹¨ê³„: ë‹¨ê¸° ê°œì„  (2~3ê°œì›”)</h5>';
            html += '<ul style="margin-left: 20px; line-height: 1.9; color: #374151;">';
            
            html += '<li><strong>ì›ê°€ì ˆê°:</strong> ì£¼ìš” ì›ì¬ë£Œ ê³µë™êµ¬ë§¤ë¡œ 5% ì›ê°€ì ˆê° ëª©í‘œ</li>';
            html += '<li><strong>íŒê´€ë¹„ íš¨ìœ¨í™”:</strong> ê´€ë¦¬ë¹„ 10% ì ˆê° (í†µì‹ ë¹„, ì†Œëª¨í’ˆë¹„, ë³µë¦¬í›„ìƒë¹„ ì¬ê²€í† )</li>';
            html += '<li><strong>ì¬ê³ ê´€ë¦¬:</strong> ì ì • ì¬ê³ ìˆ˜ì¤€ ì„¤ì • ë° ì¬ê³ íšŒì „ìœ¨ 20% ê°œì„ </li>';
            
            html += '</ul></div>';
            
            html += '<div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">';
            html += '<h5 style="color: #047857; font-size: 16px; margin-bottom: 12px;">3ë‹¨ê³„: ì¤‘ì¥ê¸° ì „ëµ (4~6ê°œì›”)</h5>';
            html += '<ul style="margin-left: 20px; line-height: 1.9; color: #374151;">';
            
            if (evaluationResults[evaluationMode].excellent >= 5) {
                html += '<li><strong>ì„±ì¥íˆ¬ì:</strong> ì•ˆì •ì  ì¬ë¬´ìƒíƒœ ê¸°ë°˜ ì‹ ê·œì„¤ë¹„ íˆ¬ì ê²€í†  (ì¤‘ì§„ê³µ ì‹œì„¤ìê¸ˆ 5ì–µ)</li>';
                html += '<li><strong>ì‹œì¥í™•ëŒ€:</strong> ì˜¨ë¼ì¸ íŒë¡œ ê°œì²™, í•´ì™¸ì‹œì¥ ì§„ì¶œ ì¤€ë¹„</li>';
            } else {
                html += '<li><strong>ì¬ë¬´êµ¬ì¡° ê°œì„ :</strong> ì˜ì—…ì´ìµ ì¬íˆ¬ìë¡œ ìê¸°ìë³¸ 20% í™•ì¶©</li>';
                html += '<li><strong>ìˆ˜ìµì„± ê°•í™”:</strong> ê³ ë¶€ê°€ê°€ì¹˜ ì œí’ˆ ë¹„ì¤‘ 30% ì´ìƒ í™•ëŒ€</li>';
            }
            
            html += '<li><strong>ì •ê¸°ì ê²€:</strong> ì›”ë³„ ì¬ë¬´ì œí‘œ ëª¨ë‹ˆí„°ë§ ì²´ê³„ êµ¬ì¶•</li>';
            
            html += '</ul></div>';
            
            html += '</div>';
            return html;
        }

        // ìš°ì„ ìˆœìœ„ ê³¼ì œ
        function generatePriorityTasks(latest, currentResults) {
            let html = '<div class="comment-section" style="background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%); border-left: 5px solid #ef4444; padding: 25px;">';
            html += '<h4 style="color: #991b1b; font-size: 18px; margin-bottom: 18px;">ğŸ¯ ê¸´ê¸‰ ìš°ì„ ìˆœìœ„ ê°œì„ ê³¼ì œ</h4>';
            
            const tasks = [];
            
            // ìš°ì„ ìˆœìœ„ 1: ê¸´ê¸‰
            if (latest.ìë³¸ì ì‹ë¥  > 0) {
                tasks.push({ priority: 1, emoji: 'ğŸ”´', task: 'ìë³¸ì ì‹ í•´ì†Œ', detail: 'ê°ì í›„ ì¦ì, ì¶œìì „í™˜ ë“± ë²•ë¥ ì „ë¬¸ê°€ ìƒë‹´ í•„ìˆ˜' });
            }
            if (latest.ìœ ë™ë¹„ìœ¨ < 100) {
                tasks.push({ priority: 1, emoji: 'ğŸ”´', task: 'ë‹¨ê¸° ìœ ë™ì„± í™•ë³´', detail: 'ìš´ì „ìê¸ˆ 3ì–µì› ê¸´ê¸‰ í™•ë³´ (ì‹ ë³´/ê¸°ë³´ ë³´ì¦)' });
            }
            if (latest.ì´ìë³´ìƒë°°ìˆ˜ < 1) {
                tasks.push({ priority: 1, emoji: 'ğŸ”´', task: 'ì´ìë¶€ë‹´ ê¸´ê¸‰ ê²½ê°', detail: 'ê³ ê¸ˆë¦¬ ì°¨ì…ê¸ˆ ì •ì±…ìê¸ˆ ì „í™˜, ë§Œê¸°ì—°ì¥ í˜‘ìƒ' });
            }
            if (latest.ì˜ì—…ì´ìµìœ¨ < 0) {
                tasks.push({ priority: 1, emoji: 'ğŸ”´', task: 'ì˜ì—…ì†ì‹¤ ì „í™˜', detail: 'ì›ê°€êµ¬ì¡° ì „ë©´ ì¬ê²€í† , ë¶ˆí•„ìš” ê³ ì •ë¹„ 30% ì‚­ê°' });
            }
            
            // ìš°ì„ ìˆœìœ„ 2: ì¤‘ìš”
            if (latest.ë¶€ì±„ë¹„ìœ¨ > 200) {
                tasks.push({ priority: 2, emoji: 'ğŸŸ¡', task: 'ë¶€ì±„ë¹„ìœ¨ 200% ì´í•˜ ê°ì¶•', detail: '3ê°œì›” ë‚´ ë¶€ì±„ 10% ìƒí™˜ ê³„íš ìˆ˜ë¦½' });
            }
            if (latest.ë‹¹ì¢Œë¹„ìœ¨ < 100) {
                tasks.push({ priority: 2, emoji: 'ğŸŸ¡', task: 'ë‹¹ì¢Œìì‚° í™•ì¶©', detail: 'ë§¤ì¶œì±„ê¶Œ ì¡°ê¸°íšŒìˆ˜, ì¬ê³ ìì‚° 20% ê°ì¶•' });
            }
            if (latest.í˜„ê¸ˆë³´ìœ ìœ¨ < 5) {
                tasks.push({ priority: 2, emoji: 'ğŸŸ¡', task: 'í˜„ê¸ˆë³´ìœ  ë¹„ìœ¨ í™•ëŒ€', detail: 'ì›”ë³„ í˜„ê¸ˆíë¦„í‘œ ì‘ì„±, ì„ ìˆ˜ê¸ˆ ì œë„ ë„ì…' });
            }
            
            // ìš°ì„ ìˆœìœ„ 3: ì¼ë°˜
            if (latest.ë§¤ì¶œì±„ê¶ŒíšŒì „ìœ¨ < 6) {
                tasks.push({ priority: 3, emoji: 'ğŸŸ¢', task: 'ë§¤ì¶œì±„ê¶Œ íšŒìˆ˜ ê°œì„ ', detail: 'íšŒìˆ˜ê¸°ê°„ 30ì¼ ë‹¨ì¶•, ì¡°ê¸°ê²°ì œ í• ì¸ì œë„' });
            }
            if (currentResults.poor >= 4) {
                tasks.push({ priority: 3, emoji: 'ğŸŸ¢', task: 'ì „ë°˜ì  ì¬ë¬´ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬ì¶•', detail: 'ì›”ë³„ ì¬ë¬´ë¶„ì„, ì „ë¬¸ ì»¨ì„¤íŒ… ì˜ë¢°' });
            }
            
            tasks.sort((a, b) => a.priority - b.priority);
            
            if (tasks.length > 0) {
                html += '<div style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">';
                tasks.forEach((t, idx) => {
                    const bgColor = t.priority === 1 ? '#fee2e2' : t.priority === 2 ? '#fef3c7' : '#dbeafe';
                    const borderColor = t.priority === 1 ? '#dc2626' : t.priority === 2 ? '#f59e0b' : '#3b82f6';
                    
                    html += `<div style="background: ${bgColor}; padding: 18px; border-radius: 10px; border-left: 4px solid ${borderColor}; margin-bottom: 12px;">`;
                    html += `<p style="font-size: 16px; font-weight: 700; color: #1e293b; margin-bottom: 8px;">${t.emoji} ${idx + 1}. ${t.task}</p>`;
                    html += `<p style="font-size: 14px; line-height: 1.7; color: #475569;">â†’ ${t.detail}</p>`;
                    html += `</div>`;
                });
                html += '</div>';
            } else {
                html += '<div style="background: #ecfdf5; padding: 20px; border-radius: 12px; border: 2px solid #10b981;">';
                html += '<p style="font-size: 16px; font-weight: 600; color: #065f46;">âœ… í˜„ì¬ ì¬ë¬´ìƒíƒœê°€ ì „ë°˜ì ìœ¼ë¡œ ì–‘í˜¸í•©ë‹ˆë‹¤.</p>';
                html += '<p style="font-size: 14px; line-height: 1.8; color: #047857; margin-top: 8px;">ì§€ì†ì ì¸ ëª¨ë‹ˆí„°ë§ê³¼ ê´€ë¦¬ë¥¼ í†µí•´ í˜„ì¬ ìˆ˜ì¤€ì„ ìœ ì§€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.</p>';
                html += '</div>';
            }
            
            html += '</div>';
            return html;
        }
    </script>
</body>
</html>
